{
<<<<<<< HEAD
  "hash": "8be5fe1854c12b7cbcd260ae5cb8c196",
  "result": {
    "markdown": "---\ndate: 2022-12-12\nlesson: RaumAn5\nthema: Multi-Criteria Evaluation (MCE)\nindex: 1\nexecute: \n  echo: false\n---\n\n\n# Rauman 5: Übung\n\nIn der folgenden Übung möchten wir potentielle Standorte für Windkraftanlagen im Kanton Schwyz ermitteln. Zu diesem Zweck führen wir eine Multikriterien-Evaluation durch. Diese besteht im Wesentlichen aus zwei Teilen:\n\n- Ausschlussgebiete\n- Potenzialflächen\n\nAls Auschlussgebiete gelten Flächen, wo keine Windkraftanlagen gebaut werden können. Dazu gehören bewohnte Flächen, nationale Schutzgebiete, Waldgebiete und Seen. Um diese Gebiete zu ermitteln müssen die entsprechenden Datensätze zusammengeführt und vom Resultat der *Potentialflächen* ausgeschlossen werden. \n\nAls Potentialflächen gelten gebiete mit hoher Eigung. Eine Gebiet ist umsobesser geeignet:\n\n1. Je weiter weg es sich von bewohnte Flächen, Nationale Schutzgebieten und Waldgebieten befindet\n2. Je näher es sich zu einer Strasse befindet\n3. Je höher die Windgeschwindigkeit ist\n4. Je geringer die Vereisungshäufigkeit ist\n5. Je geringer die Hangneigung ist\n\n\nDie Eignungsbewertung aufgrund der Distanzen (Punkt 1 & 2 in der obigen Aufzähung) könnt ihr aus der folgenden Tabelle entnehmen:\n\n<div style=\"background-color: grey\">\n\n\n::: {#tbl-bewerungstabelle-dist .cell tbl-cap='Bewertungstabelle für die Distanz zu verschiedenen Gebieten.'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n<tr>\n<th style=\"padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #111111; margin-bottom: -1px; \">Schutzgebiete</div></th>\n<th style=\"padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #111111; margin-bottom: -1px; \">Waldgebiete</div></th>\n<th style=\"padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #111111; margin-bottom: -1px; \">Siedlungsgebiete</div></th>\n<th style=\"padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #111111; margin-bottom: -1px; \">Strassen</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Dist </th>\n   <th style=\"text-align:right;\"> Score </th>\n   <th style=\"text-align:left;\"> Dist </th>\n   <th style=\"text-align:right;\"> Score </th>\n   <th style=\"text-align:left;\"> Dist </th>\n   <th style=\"text-align:right;\"> Score </th>\n   <th style=\"text-align:left;\"> Dist </th>\n   <th style=\"text-align:right;\"> Score </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 0-50 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 0-10 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 0-80 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 2500-Inf </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 50-100 </td>\n   <td style=\"text-align:right;\"> 0.1 </td>\n   <td style=\"text-align:left;\"> 10-20 </td>\n   <td style=\"text-align:right;\"> 0.1 </td>\n   <td style=\"text-align:left;\"> 80-160 </td>\n   <td style=\"text-align:right;\"> 0.1 </td>\n   <td style=\"text-align:left;\"> 2250-2500 </td>\n   <td style=\"text-align:right;\"> 0.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 100-150 </td>\n   <td style=\"text-align:right;\"> 0.2 </td>\n   <td style=\"text-align:left;\"> 20-30 </td>\n   <td style=\"text-align:right;\"> 0.2 </td>\n   <td style=\"text-align:left;\"> 160-170 </td>\n   <td style=\"text-align:right;\"> 0.2 </td>\n   <td style=\"text-align:left;\"> 2000-2250 </td>\n   <td style=\"text-align:right;\"> 0.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 150-200 </td>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> 30-40 </td>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> 170-180 </td>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> 1750-2000 </td>\n   <td style=\"text-align:right;\"> 0.3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 200-250 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> 40-50 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> 180-190 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> 1500-1750 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 250-300 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> 50-60 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> 190-200 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> 1250-1500 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 300-350 </td>\n   <td style=\"text-align:right;\"> 0.6 </td>\n   <td style=\"text-align:left;\"> 60-70 </td>\n   <td style=\"text-align:right;\"> 0.6 </td>\n   <td style=\"text-align:left;\"> 200-210 </td>\n   <td style=\"text-align:right;\"> 0.6 </td>\n   <td style=\"text-align:left;\"> 1000-1250 </td>\n   <td style=\"text-align:right;\"> 0.6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 350-400 </td>\n   <td style=\"text-align:right;\"> 0.7 </td>\n   <td style=\"text-align:left;\"> 70-80 </td>\n   <td style=\"text-align:right;\"> 0.7 </td>\n   <td style=\"text-align:left;\"> 210-220 </td>\n   <td style=\"text-align:right;\"> 0.7 </td>\n   <td style=\"text-align:left;\"> 750-1000 </td>\n   <td style=\"text-align:right;\"> 0.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 400-450 </td>\n   <td style=\"text-align:right;\"> 0.8 </td>\n   <td style=\"text-align:left;\"> 80-90 </td>\n   <td style=\"text-align:right;\"> 0.8 </td>\n   <td style=\"text-align:left;\"> 220-230 </td>\n   <td style=\"text-align:right;\"> 0.8 </td>\n   <td style=\"text-align:left;\"> 500-750 </td>\n   <td style=\"text-align:right;\"> 0.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 450-500 </td>\n   <td style=\"text-align:right;\"> 0.9 </td>\n   <td style=\"text-align:left;\"> 90-100 </td>\n   <td style=\"text-align:right;\"> 0.9 </td>\n   <td style=\"text-align:left;\"> 230-240 </td>\n   <td style=\"text-align:right;\"> 0.9 </td>\n   <td style=\"text-align:left;\"> 250-500 </td>\n   <td style=\"text-align:right;\"> 0.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 500-Inf </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> 100-Inf </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> 240-Inf </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> 0-250 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n</div>\n\nDie Bewerungen für die Punkte 3, 4 und 5 (Windgeschwindigkeit, Vereisungshäufigkeit und Hangneigung) sind wie folgt:\n\n<div style=\"background-color: grey\">\n\n\n::: {#tbl-bewerungstabelle-other .cell tbl-cap='Bewertungstabelle die Windgeschwindigkeit (m/s), Vereisungshäufigkeit (Tage/Jahr) und Hangneigung (Grad)'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n<tr>\n<th style=\"padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #111111; margin-bottom: -1px; \">Windgeschwindigkeit</div></th>\n<th style=\"padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #111111; margin-bottom: -1px; \">Vereisungshaeufigkeit</div></th>\n<th style=\"padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #111111; margin-bottom: -1px; \">Hangneigung</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Speed </th>\n   <th style=\"text-align:right;\"> Score </th>\n   <th style=\"text-align:left;\"> Days </th>\n   <th style=\"text-align:right;\"> Score </th>\n   <th style=\"text-align:left;\"> Slope </th>\n   <th style=\"text-align:right;\"> Score </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 0-35 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 60-365 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 20-90 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 35-40 </td>\n   <td style=\"text-align:right;\"> 0.1 </td>\n   <td style=\"text-align:left;\"> 54-60 </td>\n   <td style=\"text-align:right;\"> 0.1 </td>\n   <td style=\"text-align:left;\"> 18-20 </td>\n   <td style=\"text-align:right;\"> 0.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 40-45 </td>\n   <td style=\"text-align:right;\"> 0.2 </td>\n   <td style=\"text-align:left;\"> 48-54 </td>\n   <td style=\"text-align:right;\"> 0.2 </td>\n   <td style=\"text-align:left;\"> 16-18 </td>\n   <td style=\"text-align:right;\"> 0.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 45-50 </td>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> 42-48 </td>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> 14-16 </td>\n   <td style=\"text-align:right;\"> 0.3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 50-55 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> 36-42 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> 12-14 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 55-60 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> 30-36 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> 10-12 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 60-65 </td>\n   <td style=\"text-align:right;\"> 0.6 </td>\n   <td style=\"text-align:left;\"> 24-30 </td>\n   <td style=\"text-align:right;\"> 0.6 </td>\n   <td style=\"text-align:left;\"> 8-10 </td>\n   <td style=\"text-align:right;\"> 0.6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 65-70 </td>\n   <td style=\"text-align:right;\"> 0.7 </td>\n   <td style=\"text-align:left;\"> 18-24 </td>\n   <td style=\"text-align:right;\"> 0.7 </td>\n   <td style=\"text-align:left;\"> 6-8 </td>\n   <td style=\"text-align:right;\"> 0.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 70-75 </td>\n   <td style=\"text-align:right;\"> 0.8 </td>\n   <td style=\"text-align:left;\"> 12-18 </td>\n   <td style=\"text-align:right;\"> 0.8 </td>\n   <td style=\"text-align:left;\"> 4-6 </td>\n   <td style=\"text-align:right;\"> 0.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 75-80 </td>\n   <td style=\"text-align:right;\"> 0.9 </td>\n   <td style=\"text-align:left;\"> 6-12 </td>\n   <td style=\"text-align:right;\"> 0.9 </td>\n   <td style=\"text-align:left;\"> 2-4 </td>\n   <td style=\"text-align:right;\"> 0.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 80-Inf </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> 0-6 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> 0-250 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n</div>\n<!--![](images/potentialflaechen-mermaid.png)-->\n\n\n\n\n## Übungen 1: Vektor Daten laden und anzeigen\n\nLaden Sie das File [windkraft_geodata.gpkg](https://moodle.zhaw.ch/mod/resource/view.php?id=663498) von Moodle herunter. Dieses beinhaltet alle Vektordaten, die für die Bearbeitung der Multikriterien-Evaluation benötigt wird (Bewohnte Flächen, Nationale Schutzgebiete, Seeflächen, Strassen, Waldgebiete sowie die Kantonsgrenze von Schwyz).\n\nExplorieren Sie die Daten visuell und versuchen Sie ein Verständnis für die Datensätze zu bekommen. Zur Visualisierung können Sie die Funktionen `plot` oder die Packages `tmap` oder `ggplot2` verwenden.\n\nWir werden die folgenden Pakete in dieser Übung verwenden:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sf)\nlibrary(terra)\nlibrary(dplyr)\nlibrary(tmap)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n\n\n## Übung 2: Entfernungen zu Kriterien berechnen\n\nBeginnen wir mit den Enfernungskriterien. Bei der Bewertung geeigneter Standorte für Windkraftanlagen ist die Entfernung zu Waldgebieten, nationalen Schutzgebieten,  bewohnten Gebieten und Strassen relevant. Mit Ausnahme von Strassen gilt: je weiter weg desto besser, das ist aber an dieser Stelle noch nicht relevant. \n\nStarten wir mit der Distanz zum Wald. Es geht nun darum für den Punkt im Raum zu wissen, wie weit weg der nächstgelegene Wald ist. Dazu müssen wir den Vektordatensatz zuerst in Raster konvertieren. Und dies geht folgendermassen:\n\n1. Erstelle eine Raster \"Template\" \n\n::: {.cell}\n\n```{.r .cell-code}\ntemplate <- rast(ext(kt_schwyz), resolution = c(250, 250), crs = \"EPSG:21781\")\n```\n:::\n\n\n2. Vektorisiere den Wald mit der Funktion `rasterize()` und `vect()`, basierend auf dem Template. Alle Wald Zellen sollen den Wert 1 erhalten (`field = 1`)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwald_r <- rasterize(vect(wald), template, field = 1) \n```\n:::\n\n\n3. Berechne die Distanz mit der Funktion `distance()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwald_dist <- distance(wald_r)\n\nplot(wald_dist)\n```\n\n::: {.cell-output-display}\n![](Rauman5_Uebung_mce_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\nVersuche die drei Schritte mit den anderen drei Datensätzen durchzuführen. Für Profis: Erstelle dazu eine Funktion.\n\n\n::: {.cell}\n\n:::\n\n\n## Übung 3: Distanzkriterien Bewerten\n\nJetzt wo wir die Distanzen berechnet haben können wir diese gemäss @tbl-bewerungstabelle-dist bewerten. Hierfür brauchen wir die Function `classify()`. Wie wir aus der Dokumentation der Funktion (mit `?classify`) entnehmen können, müssen wir die Distanzbewerungen in einer Matrix mit 3 Spalten festhalten. Die ersten beiden Spalten stellen die \"von\" und \"bis\" Werte dar, die 3 Spalte den neuen Wert.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwald_reclass_matrix <- matrix(c(\n    0,10,0,\n    10,20,0.1,\n    20,30,0.2,\n    30,40,0.3,\n    40,50,0.4,\n    50,60,0.5,\n    60,70,0.6,\n    70,80,0.7,\n    80,90,0.8,\n    90,100,0.9,\n    100,Inf,1.0), ncol = 3, byrow = TRUE)\n\n\nwald_reclass_matrix\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      [,1] [,2] [,3]\n [1,]    0   10  0.0\n [2,]   10   20  0.1\n [3,]   20   30  0.2\n [4,]   30   40  0.3\n [5,]   40   50  0.4\n [6,]   50   60  0.5\n [7,]   60   70  0.6\n [8,]   70   80  0.7\n [9,]   80   90  0.8\n[10,]   90  100  0.9\n[11,]  100  Inf  1.0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwald_classify <- classify(wald_dist, wald_reclass_matrix)\n\nplot(wald_classify)\n```\n\n::: {.cell-output-display}\n![](Rauman5_Uebung_mce_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n## Übung 4: Rasterdaten einlesen\n\nZur Bewertung der Standorte Hinsichtlich Windgeschwindigkeit und Vereisungshäufigkeit stehen uns Rasterdatensätze zur Verfügung. Lade die beiden nachfolgenden Datensätze herunter und mit der Funktion `rast()` in R ein.\n\n- [eis250m.tif](https://moodle.zhaw.ch/mod/resource/view.php?id=602288) (Vereisungshäufigkeit in Tage/Jahr)\n- [wind250m.tif](https://moodle.zhaw.ch/mod/resource/view.php?id=602297) (Durchschnittliche Windgeschwindigkeit)\n\nExplorieren Sie die Daten visuell und versuchen Sie ein verständnis für die Datensätze zu bekommen. Zur Visualisierung können Sie die Funktionen `plot` oder `tmap` verwenden.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Rauman5_Uebung_mce_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n## Übung 5: Windgeschwindigkeit und Vereisungshäufigkeit bewerten\n\nDie beiden Rasterdatensätze `eis250m.tif` und `wind250m.tif`. können wir direkt mit `classify()` gemäss @tbl-bewerungstabelle-other bewerten. Versuche dies analog der Bewertung der Distanzwerte.\n\n\n\n\n\n\n\n\n\n\n## Übung 6: Neigung berechnen und Bewerten\n\nFür die Berechnung und anschilessende Bewertung der Hangneigung brauchen wir ein Höhenmodell. Lade folgendes Höhenmodell herunter und in R ein, und berechne Anschliessend die Hangneigung mit der Funktion `terrain()` (beachten Sie die Einheit des Output!). Bewerten Sie die Hangneigung danach gemäss Tabelle @tbl-bewerungstabelle-other. \n\n- [dhm250m.tif](https://moodle.zhaw.ch/mod/resource/view.php?id=694260) (Höhenmodell)\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\n## Übung 7: Gewichtetes Overlay\n\nNun können wir sämtliche Bewertungen zusammenfliessen lassen. Dazu gibt es eine Vielzahl von Möglichkeiten. Wir können alle Kriterien addieren und dann durch die Anzahl Kriterien dividieren, um so einen Mittelwert zu erhalten. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# TODO: KÖNNEN WIR DIESEN HACK VERMEIDEN?\ncrs(siedlungsgebiet_reclass) <- crs(neigung_relass)\ncrs(schutzgebiete_reclass) <- crs(neigung_relass)\ncrs(strassen_reclass) <- crs(neigung_relass)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\noverlay1 <- (neigung_relass+ice_reclass+wind_reclass+siedlungsgebiet_reclass+schutzgebiete_reclass+strassen_reclass)/6\n\noverlay1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nclass       : SpatRaster \ndimensions  : 150, 186, 1  (nrow, ncol, nlyr)\nresolution  : 250, 250  (x, y)\nextent      : 672175, 718675, 193658, 231158  (xmin, xmax, ymin, ymax)\ncoord. ref. : CH1903 / LV03 \nsource      : memory \nname        :     slope \nmin value   : 0.2666667 \nmax value   : 0.9333333 \n```\n:::\n\n```{.r .cell-code}\nplot(overlay1)\n```\n\n::: {.cell-output-display}\n![](Rauman5_Uebung_mce_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\noverlay2 <- (neigung_relass*10+ice_reclass*5+wind_reclass*7+siedlungsgebiet_reclass*5+schutzgebiete_reclass*2+strassen_reclass*30)/(10+5+7+5+2+30)\n\noverlay2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nclass       : SpatRaster \ndimensions  : 150, 186, 1  (nrow, ncol, nlyr)\nresolution  : 250, 250  (x, y)\nextent      : 672175, 718675, 193658, 231158  (xmin, xmax, ymin, ymax)\ncoord. ref. : CH1903 / LV03 \nsource      : memory \nname        :     slope \nmin value   : 0.1661017 \nmax value   : 0.9542373 \n```\n:::\n\n```{.r .cell-code}\nplot(overlay2)\n```\n\n::: {.cell-output-display}\n![](Rauman5_Uebung_mce_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n## Übung 8: Ausschlusskriterien zusammenführen (optional)\n\nFühren Sie die Ausschlusskriterien Siedlungsgebiete, nationale Schutzgebiete, Seeflächen und Waldgebiete zusammen. Diese Vektordatensätze sind als Data Frames strukturiert und können daher durch einfaches Kombinieren zusammengeführt werden. Beachten Sie dabei, dass die Data Frames unterschiedliche Grössen haben. Zusätzlich müssen wir aus dem neu erstellten Vektordatensatz (Ausschlussgebiet) ein Raster erstellen. Dazu können Sie die Funktion `rasterize` verwenden. Die Ausgabe soll ein Raster mit 0 und 1 sein, wobei die Felder des Ausschlussbereichs den Wert 0 und die restlichen Felder den Wert 1 haben.\n  \n* **Tipp**: Um ein Raster mit nur 0 und 1 zu erhalten, verwenden Sie die Optionen \"rasterize\" field = 0 und background = 1.\n* **Tipp**: Um Vektordaten zu rastern, müssen Sie vorher ein leeres Raster erstellen. Dieses Raster sollte die gleichen Grenzen (extent), die gleiche Auflösung und das gleiche Koordinatensystem (crs) haben wie die anderen Rastersätze. Verwenden Sie dazu den folgenden Code.*\n  \n\n\n\n\n\n\n## Übung 9: Potenzielle Gebiete mit Ausschlusskriterien überschneiden (optional)\n\nDurch einfache Multiplikation des Ausschluss-Layers (Ergebnis aus Übung 2) mit dem gewichteten Overlay-Layer (Ergebnis aus Übung 7) schliessen wir alle Flächen mit dem Wert 0 (Ausschlussflächen) aus und behalten alle anderen Flächen mit dem Wert 1 (z.B. 0x3=0, 1x3=3). Erstellen Sie als Abschluss der Studie eine endgültige Darstellung der Potenzialflächen für Windkraftanlagen im Kanton Schwyz. Diskutieren Sie die Ergebnisse und bestimmen Sie drei mögliche Standorte, an denen eine konkrete Planung von Windkraftanlagen möglich wäre.\n\n\n\n\n",
=======
  "hash": "2c148591d6c138953d63d4e8e6adeacb",
  "result": {
    "markdown": "---\ndate: 2022-12-12\nlesson: RaumAn5\nthema: Multi-Criteria Evaluation (MCE)\nindex: 1\n---\n\n\n# Rauman 5: Übung\n\nDie folgende Übung mag einigen von Ihnen bekannt vorkommen, wenn Sie unseren Bachelorstudiengang besucht haben. Dieses MCE wurde bereits im Bachelormodul \"GIS\" unter Verwendung von ArcGIS Pro und dessen ModelBuilder durchgeführt (siehe @fig-mce-process).\n\n![MCE Prozess](images/mce_process.png){#fig-mce-process}\n\nDas Ziel dieser Übung ist es, das gleiche MCE nur mit R durchzuführen. Wir werden hauptsächlich Funktionen aus den R-Paketen [sf](https://cran.r-project.org/web/packages/sf/sf.pdf) und [raster](https://cran.r-project.org/web/packages/raster/raster.pdf) verwenden. Bitte schauen Sie sich das Prozessmodell (siehe @fig-mce-process) an, das in ArcGIS Pro erstellt wurde, und versuchen Sie herauszufinden, welche Funktionen in den beiden R-Paketen denen im Modell entsprechen. Sie werden sehen, dass es einige ähnliche Funktionen gibt, aber für einige Berechnungen ist ein anderer Ansatz erforderlich.\n\n## Übungen 1: Daten laden und anzeigen\n\nLaden Sie die nachfolgenden Rasterdatensätze herunter:\n\nLaden Sie das File [windkraft_geodata.gpkg](https://moodle.zhaw.ch/mod/resource/view.php?id=663498) von Moodle herunter. Dieses beinhaltet die folgenden Layers:\n\n| Layer | Koord. System | Beschreibung | Typ | Ausschlussgebiet |\n|:---|:---|:---|:---|:---|\n| Bewohnte_Flaeche| CH1903/LV03 | Siedlungen (inkl. Puffer 200m) | Polygon | (Ja)/Distanz |\n| Nationale_Schutzgebiete | CH1903/LV03 | Nationale Schutzgebiete| Polygon | (Ja)/Distanz |\n| Seeflaechen | CH1903/LV03 | Seegebiete | Polygon | Ja |\n| Strassen | CH1903/LV03 | Strassen | Linie | Nein/Distanz |\n| Untersuchungsgebiet_Schwyz | CH1903/LV03 | Untersuchungsgebiet, Kanton Schwyz | Polygon | Nein |\n| Waldgebiete | CH1903/LV03 | Waldgebiete | Polygon | (Ja)/Distanz |\n| dhm250m | CH1903/LV03 | Geländemodell (m) | Raster (250m) | Nein |\n| eis250m | CH1903/LV03 | Häufigkeit der Vereisung (Tage/Jahr) | Raster (250m) | Nein |\n| wind250m | CH1903/LV03 | Durchschnittliche Windgeschwindigkeit (dm/s) | Raster (250m) | Nein |\n\nDie Rasterdaten können mit der Funktion `terra::rast` und die Vektorebenen mit `sf::read_sf` geladen werden. Zeigen Sie die verfügbaren Layers an und plotten Sie sie auf ansprechende Weise. Zur Visualisierung können Sie die Funktionen `plot` für Rasterdaten und `ggplot` für Vektordaten verwenden.\n\n<!-- Einige Datensätze überschreiten die Grenzen des Untersuchungsgebiets. Verwenden Sie die Funktion `crop` für Rasterdatensätze und `st_intersection` für sf/Vektor-Daten, um die relevanten Bereiche zu extrahieren. -->\n\nWir werden die folgenden Pakete in dieser Übung verwenden:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sf)\nlibrary(terra)\nlibrary(dplyr)\nlibrary(tmap)\n```\n:::\n\n\n\n\n\n\n\n\n## Übung 2: Ausschlusskriterien zusammenführen\n\nFühren Sie die Ausschlusskriterien Siedlungsgebiete, nationale Schutzgebiete, Seeflächen und Waldgebiete zusammen. Diese Vektordatensätze sind als Data Frames strukturiert und können daher durch einfaches Kombinieren zusammengeführt werden. Beachten Sie dabei, dass die Data Frames unterschiedliche Grössen haben. Zusätzlich müssen wir aus dem neu erstellten Vektordatensatz (Ausschlussgebiet) ein Raster erstellen. Dazu können Sie die Funktion `rasterize` verwenden. Die Ausgabe soll ein Raster mit 0 und 1 sein, wobei die Felder des Ausschlussbereichs den Wert 0 und die restlichen Felder den Wert 1 haben (siehe @fig-exclusion-areas).\n  \n* **Tipp**: Um ein Raster mit nur 0 und 1 zu erhalten, verwenden Sie die Optionen \"rasterize\" field = 0 und background = 1.\n* **Tipp**: Um Vektordaten zu rastern, müssen Sie vorher ein leeres Raster erstellen. Dieses Raster sollte die gleichen Grenzen (extent), die gleiche Auflösung und das gleiche Koordinatensystem (crs) haben wie die anderen Rastersätze. Verwenden Sie dazu den folgenden Code.*\n  \n\n::: {.cell}\n\n```{.r .cell-code}\nr <- terra::rast(ext(kt_schwyz), \n          resolution = c(250, 250), \n          crs = \"EPSG:21781\")\n```\n:::\n\n  \n![Ausschlussgebiete](images/exclusion_areas.png){#fig-exclusion-areas width=50%}\n\n\n\n\n\n## Übung 3: Neigung berechnen\n\nAls nächstes berechnen Sie die Neigung in Grad auf der Grundlage des Geländemodells (dhm250m). Das terra-Paket bietet Ihnen eine sehr hilfreiche Funktion namens `terrain`. \n\n* **Tipp**: Wenn Sie die Terrain-Funktion verwenden, benutzen Sie die folgenden Optionen: v=\"slope\", unit=\"degrees\", neighbors=8.*\n\n![](images/slope.png){width=50%}\n\n\n\n\n\n## Übung 4: Entfernungen zu Kriterien berechnen\n\nBei der Bewertung geeigneter Standorte für Windkraftanlagen ist die Entfernung zu Strassen, Waldgebieten, nationalen Schutzgebieten und bewohnten Gebieten relevant. Je nach Kriterium hat eine geringe oder grosse Entfernung einen positiven Einfluss auf die Bewertung der potenziellen Standorte. Führen Sie zu diesem Zweck eine Abstandsanalyse mit den ausgewählten Kriterien-Rasterlayern durch. Verwenden Sie für diese Berechnung die Rasterfunktion `distance`. \n\n* **Tipp**: Um die Funktion `distance` durchführen zu können, müssen Sie die Kriterien ebenfalls \"rastern\". Sie können den gleichen Befehl wie in Übung 2 verwenden, aber nur mit der Option field = 1.\n* **Tipp**: Verwenden Sie erneut die Funktion \"Zuschneiden\", um nur relevante Daten aus dem Untersuchungsgebiet zu erhalten.\n\n![](images/d_to_settlements.png){width=50%}\n\n\n\n\n\n## Übung 5: Kriterien standardisieren und bewerten (grading)\n\nDie Datenebenen Neigung, Windgeschwindigkeit, Vereisungshäufigkeit und die in Übung 4 berechneten Entfernungsebenen haben unterschiedliche Einheiten (dm/s, Grad, d/yr und m). Diese Einheiten können nicht direkt miteinander verrechnet werden. Daher müssen die verschiedenen Ebenen durch eine lineare Abstufung operationalisiert werden. Die lineare Abstufung wird mit der Funktion `reclassify` durchgeführt. Verwenden Sie die Standards für die Neuklassifizierung aus @fig-mce-reclassify-1 und @fig-mce-reclassify-2).\n\n* **Tipp**: Beachten Sie die Minimal- und Maximalwerte der einzelnen Rasterebenen.\n* **Tipp**: Hier ist ein Beispielcode zur Neuklassifizierung der Entfernungen zu Siedlungen.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsettlements_max <- minmax(settlements_ed)[2]\n\nreclass_settlements <- c(0,80,0,\n                        80,160,0.1,\n                        160,240,0.2,\n                        240,320,0.3,\n                        320,400,0.4,\n                        400,480,0.5,\n                        480,560,0.6,\n                        560,640,0.7,\n                        640,720,0.8,\n                        720,800,0.9,\n                        800,settlements_max,1.0) |> matrix(ncol = 3, byrow = TRUE)\nreclass_settlements_ed <- terra::classify(settlements_ed, reclass_settlements)\n```\n:::\n\n\n::: {#fig-mce-reclassify layout-ncol=2}\n![](images/mce_reclassify_1.png){#fig-mce-reclassify-1}\n\n![](images/mce_reclassify_2.png){#fig-mce-reclassify-2}\n\nMCE Reclassify\n:::\n\n![](images/d_to_settlements_reclassified.png){width=50%}\n\n\n\n\n\n## Übung 6: Gewichtung der Kriterien mit AHP\n\nFühren Sie einen AHP durch, um die Kriterien zu gewichten, die dem MCE zugrunde liegen. Vergleichen Sie zunächst die Kriterien paarweise und berechnen Sie dann die Gewichte - wie Sie es in der letzten Woche gelernt haben. Am Ende sollten Sie eine Liste mit 7 Gewichten erhalten, wie unten dargestellt.\n\n* **Tipp**: Sehen Sie sich die Übungen 2 und 3 aus der letzten Woche an. Verwenden Sie den vorbereiteten R-Code, um Ihre ahp-Matrix zu erstellen.\n\n| Wind | Streets | Ice | Settlements | Forest | Slope | Protected areas |\n|:---|:---|:---|:---|:---|:---|:---|\n| 0.33862692 | 0.09816760 | 0.06166626 | 0.24969460 | 0.03515759 | 0.18043000 | 0.03625702 |\n  \n\n::: {.cell}\n\n```{.r .cell-code}\nahp_matrix <- c(\n  1, 0, 0, 0, 0, 0, 0, #Wind\n  0, 1, 0, 0, 0, 0, 0, #Distance to streets\n  0, 0, 1, 0, 0, 0, 0, #Ice\n  0, 0, 0, 1, 0, 0, 0, #Distance to settlements\n  0, 0, 0, 0, 1, 0, 0, #Distance to forests\n  0, 0, 0, 0, 0, 1, 0, #Slope\n  0, 0, 0, 0, 0, 0, 1  #Distance to protected areas\n) |> matrix(ncol = 7, byrow = TRUE)\n```\n:::\n\n\n\n\n## Übung 7: Gewichtetes Overlay\n\nDie linear gewichteten Kriterien (Übung 5) sollen nun unter Berücksichtigung der mit dem AHP ermittelten Gewichtung (Übung 6) miteinander kombiniert werden. Diese gewichtete Überlagerung kann mit Hilfe von Rasterberechnungen durchgeführt werden, indem einfach jedes Kriterium mit seinem Gewicht multipliziert und addiert wird (siehe @fig-weighted-overlay).\n\n* **Tipp**: Da die Rastersätze leicht unterschiedliche Ursprünge haben, erhöhen Sie die Toleranz, indem Sie rasterOptions(tolerance = 0.5) verwenden.\n* **Tipp**: Achten Sie bei der Multiplikation auch auf die Reihenfolge der Gewichte in Ihrer Liste.\n\n![Gewichteter Overlay](images/weighted_overlay.png){#fig-weighted-overlay width=50%}\n\n\n\n\n\n## Übung 8: Potenzielle Gebiete mit Ausschlusskriterien überschneiden\n\nDurch einfache Multiplikation des Ausschluss-Layers (Ergebnis aus Übung 2) mit dem gewichteten Overlay-Layer (Ergebnis aus Übung 7) schliessen wir alle Flächen mit dem Wert 0 (Ausschlussflächen) aus und behalten alle anderen Flächen mit dem Wert 1 (z.B. 0x3=0, 1x3=3). Erstellen Sie als Abschluss der Studie eine endgültige Darstellung der Potenzialflächen für Windkraftanlagen im Kanton Schwyz (wie @fig-potential-sites). Diskutieren Sie die Ergebnisse und bestimmen Sie drei mögliche Standorte, an denen eine konkrete Planung von Windkraftanlagen möglich wäre.\n\n![Potenzielle Standorte](images/potential_sites.png){#fig-potential-sites}\n\n\n\n",
>>>>>>> e3b97b99bd0fdda02325fd03f8dd76bf0fb17baa
    "supporting": [
      "Rauman5_Uebung_mce_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}