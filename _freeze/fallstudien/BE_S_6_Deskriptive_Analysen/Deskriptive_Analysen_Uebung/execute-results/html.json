{
  "hash": "a701981472ed8639cc8a47910e8d47c9",
  "result": {
    "markdown": "---\ntitle: \"KW44 - Deskriptive Analysen - Übung\"\nauthor:\n  - name: Adrian Hochreutener\ndescription: \" \"  \ncategories: Biodiversity_Ecosystems_S\ndraft: false\n---\n\n\n\n\n\n\n# Aufgabe 1: Verlauf der Besuchszahlen / m\n\nNachdem wir die Projektstruktur aufgebaut haben und die Daten vorbereitet sind, machen wir uns an die deskriptive Analyse. Dies macht eigentlich immer Sinn. Bevor mach sich an die schliessende Statistik macht, muss man ein \"Gefühl\" für die Daten bekommen. Dies funktioniert am einfachsten mit deskriptiven, explorativen Analysen.\n\nWir interessieren uns in den Analysen grundsätzlich für 4 Zeitabschnitte:\n\n1) Normal (vom Start der Erhebungen bis vor dem ersten Lockdown)\n2) Lockdown 1\n3) Lockdown 2\n4) Seit Covid, aber nicht während eines Lockdowns\n\nWir haben relativ lange Zeitreihen. Zur Visualisierung des generellen Trends greifen wir darum auf die aggregierten Daten zurück - das macht den Plot übersichtlicher und damit aussagekräftiger.\n\n- Plottet den Verlauf der monatlichen Besuchszahlen an eurer Zählstelle. Auf der x-Achse steht dabei dabei Jahr und Monat (gespeichert im df _depo_m_), auf der y-Achse die monatlichen Besuchszahlen. Zeichnet auch die beiden Lockdown ein (Hinweis: rundet das Start- und Enddatum des Lockdowns auf den Monat, da im Plot die monatlichen Zahlen gezeigt werden).\n\nHaltet euch dabei an untenstehenden Plot:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Deskriptive_Analysen_Uebung_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n__Hinweis:__ \n- Nutzt zum plotten __ggplot()__\n- folgende Codeschnipsel helfen euch:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = depo_m, mapping = aes(Ym, Total, group = 1))+ # group 1 braucht R, dass aus den Einzelpunkten ein Zusammenhang hergestellt wird\n  # zeichne Lockdown 1; ein einfaches Rechteck. bestimme mit min und max die Dimensionen\n  geom_rect(mapping = aes(xmin=\"2020 3\", xmax=\"2020 5\",\n                          ymin =0, ymax=max(Total+(Total/100*10))), # das Rechteck soll 10 % grösser als die maximale Besuchszahl sein \n            fill = \"lightskyblue\", alpha = 0.4, colour = NA)+\n  # zeichne Lockdown 2\n    ...+\n  # zeichne die Linie\n  geom_line(...)+\n  # bestimme manuell, wo auf der x-Achse die breaks sind und wie diese angeschrieben werden sollen\n  scale_x_discrete(breaks = c(\"...\", \"...\", ...),\n                   labels = c(\"...\", \"...\", ...))+\n  theme_linedraw(base_size = 15)+\n  ...\n```\n:::\n\n\n- Exportiert euren Plot mit __ggsave()__ nach __results__. Breite = 20, Höhe = 10, Einheiten = cm, dpi = 1000\n\n# Aufgabe 2: Wochengang\n\nNachdem wir nun wissen, wie sich die Besuchszahlen während der Untersuchungsdauer monatlich entwickelt haben, möchten wir genauer untersuchen, wie sich die Zahlen je nach Phase (Normal, Lockdown 1. Lockdown 2 und Covid) auf die Wochentage verteilen. \n\n## 2a)\n\n- Berechnet zuerst die Totale Anzahl pro Wochentag pro Phase.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean_phase_wd <- depo_d %>% \n  group_by(...) %>% \n  ...\n```\n:::\n\n\n- Speichert das als .csv\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite.csv(mean_phase_wd, \"results/mean_phase_wd.csv\")\n```\n:::\n\n\n## 2b)\n\n- Erstellt einen Boxplot nach untenstehender Vorgabe:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Deskriptive_Analysen_Uebung_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n__Hinweis:__ \n- Nutzt zum plotten __ggplot()__\n- folgende Codeschnipsel helfen euch:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = depo_d)+\n  geom_boxplot(mapping = aes(x= Wochentag, y = Total, fill = Phase))+\n  ...\n```\n:::\n\n\n- Exportiert auch diesen Plot mit __ggsave()__. Welche Breite und Höhe passt hier?\n\n## 2c)\n\nSind die Unterschiede zwischen Werktag und Wochenende wirklich signifikant? Falls ja, in allen Phasen oder nur während bestimmter?\n\n- Prüft das pro Phase mit einem einfachen t.test.\n\n# Aufgabe 3: Tagesgang\n\nVom Grossen zum Kleinen, von der Übersicht ins Detail. Jetzt widmen wir uns dem Tagesgang, das heisst der Verteilung der Besuchenden auf die 24 Tagesstunden je nach Phase.\n\n## 3a)\n\n- Berechnet zuerst den Mittelwert der Totalen Besuchszahlen pro Wochentag pro Stunde pro Phase. (ganz ähnlich wie unter 2a) und speichert das df unter __Mean_h__.\n\nggplots haben Daten lieber im Format long als wide. \n\n## 3b)\n\n- Plottet den Tagesgang, unterteilt nach den 7 Wochentagen nun für unsere 4 Phasen.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Deskriptive_Analysen_Uebung_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nFür die Phase \"Normal\" benutze ich folgenden Codeschnipsel. Speichert den Plot ab (hier: __tag_norm__).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntag_norm <- ggplot(subset(Mean_h, Phase %in% c(\"Normal\")), \n                     mapping=aes(x = Stunde, y = Total, colour = Wochentag, linetype = Wochentag))+\n  ...\n```\n:::\n\n\n__Hinweis:__ Achtet darauf, dass die Skalierung der y-Achse bei allen 4 Plots dieselbe ist (z.B. immer vom 0 bis 25). \n\n## 3c)\n\n- Arrangiert die vier erstellten Plots und speichert das Resultat. Das ist etwas tricky, darum hier der vollständige Code.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Arrange und Export Tagesgang\nggarrange(tag_lock_1+            # plot 1 aufrufen\n            rremove(\"x.text\")+   # plot 1 braucht es nicht alle Achsenbeschriftungen\n            rremove(\"x.title\"),            \n          tag_lock_2+            # plot 2 aufrufen\n            rremove(\"y.text\")+   # bei plot 2 brauchen wir keine Achsenbeschriftung\n            rremove(\"y.title\")+\n            rremove(\"x.text\")+\n            rremove(\"x.title\"),\n          tag_norm,\n          tag_covid+\n            rremove(\"y.text\")+   \n            rremove(\"y.title\"),\n          ncol = 2, nrow = 2,    # definieren, wie die plots angeordnet werden\n          heights = c(0.9, 1),  # beide plots sind wegen der fehlenden Beschriftung nicht gleich hoch\n          widths = c(1,0.9),    \n          labels = c(\"a) Lockdown 1\", \"b) Lockdown 2\", \"c) Normal\", \"d) Covid\"),\n          label.x = 0.1,        # wo stehen die Plottitel\n          label.y = 0.99,\n          common.legend = TRUE, legend = \"bottom\") # wir brauchen nur eine Legende, unten\n\nggsave(\"Tagesgang.png\", width=25, height=25, units=\"cm\", dpi=1000,\n       path = \"results/\")\n```\n:::\n\n\n# Aufgabe 4: Kennzahlen\n\nSchliesslich berechnen wir noch einige Kennzahlen (Anzahl Passagen, Richtungsverteilung, ...).\n\n## 4a)\n\n- Gruppiert nach Phase und berechnet dieses mal die Summe (nicht den Durchschnitt) Total, IN und OUT (ähnlich wie in 2a und 3a).\n\n- Speichert das Ergebnis als .csv\n\n## 4b) \n\nDie Zeitreihen der 4 Phasen unterscheiden sich deutlich voneinander. Totale Summen sind da kaum miteinander vergleichbar, besser eignet sich der Durchschnitt oder der Median.\n\n- Gruppiert nach Phase und berechnet den Durchschnitt Total, IN und OUT und speichert das df unter __mean_phase_d__.\n\n- Ergänzt das mit der prozentualen Richtungsverteilung\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean_phase_d <- mean_phase_d %>% \n  mutate(Proz_IN = round(100/Total*IN, 1)) %>% # berechnen und auf eine Nachkommastelle runden\n  ...\n```\n:::\n\n\n- Speichert das Ergebnis als .csv\n\n- Selektiert nun die absoluten Zahlen im df __mean_phase_d__ sowie die relativen und speichert das jeweils in einem df __mean_phase_d_abs__ und __mean_phase_d_proz__.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean_phase_d_abs <- mean_phase_d %>% dplyr::select(-c(Total, Proz_IN, Proz_OUT))\n```\n:::\n\n\n- transformiert beide df mittels __pivot_longer()__ von wide zu long:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean_phase_d_abs <- pivot_longer(mean_phase_d_abs, cols = c(\"IN\",\"OUT\"), \n             names_to = \"Gruppe\", values_to = \"Durchschnitt\")\n```\n:::\n\n\n## 4c)\n\nNun visualisieren wie die Verteilung der absoluten und der relativen Zahlen nach Phasen in einem Barplot.\n\n- Erstellt je einen Plot zu den absoluten und den relativen Zahlen nach den unterstehenden Vorgaben und speichert beide Plots im Environment:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Deskriptive_Analysen_Uebung_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Deskriptive_Analysen_Uebung_files/figure-html/unnamed-chunk-14-2.png){width=672}\n:::\n:::\n\n\n- Arrangiert beide Plots nebeneinander und exportiert das Ergebnis (Arrangieren siehe 3c). ",
    "supporting": [
      "Deskriptive_Analysen_Uebung_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}