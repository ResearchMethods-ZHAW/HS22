{
  "hash": "f5f0688f246b0dd6dc1e0f1a9134946a",
  "result": {
    "markdown": "---\ndate: 2022-10-31\nlesson: Stat1\nthema: Grundlagen der Statistik\nindex: 4\n---\n\n\n# Stat1: Lösung\n\n\n::: {.cell}\n\n:::\n\n\n##  Musterlösung Übung 1.1\n\n> Download [R-Skript](../purl/Statistik1_Loesung.R)\n\n### Kommentierter Weg\n\n\n\n\nLade Daten von der Gästebefragung 2017 herunter (für Informationen zu den einzelnen Variablen, siehe [diesen Link](https://zenodo.org/record/3554884/files/2020_ZHAW_vonRickenbach_Variablen_cleaned_recoded_survey_dataset_anonym_NOVANIMAL.pdf?download=1)):\n\n- [2017_ZHAW_aggregated_menu_sales_NOVANIMAL.csv](https://zenodo.org/record/3890931/files/2017_ZHAW_aggregated_menu_sales_NOVANIMAL.csv?download=1)\n- [2019_ZHAW_vonRickenbach_cleaned_recorded_survey_dataset_NOVANIMAL_anonym.csv](https://zenodo.org/record/3554884/files/2019_ZHAW_vonRickenbach_cleaned_recorded_survey_dataset_NOVANIMAL_anonym.csv?download=1)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnova <- read_delim(file = \"data/2017_ZHAW_aggregated_menu_sales_NOVANIMAL.csv\", delim = \";\")\nnova_survey <- read_delim(file = \"data/2019_ZHAW_vonRickenbach_cleaned_recorded_survey_dataset_NOVANIMAL_anonym.csv\", delim = \";\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#überprüfe die Datenstruktur\nglimpse(nova_survey)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,175\nColumns: 71\n$ Pseudonym           <chr> \"2017_HS_F_0001\", \"2017_HS_F_0007\", \"2017_HS_F_000…\n$ meal                <chr> NA, \"Favorite\", \"Favorite\", \"Favorite\", \"Favorite\"…\n$ choice_1            <dbl> 4, 4, 3, 4, 3, 3, 4, 4, 3, 3, 3, 3, 4, 4, 4, 2, 3,…\n$ choice_2            <dbl> NA, 4, 1, 1, 3, 2, 1, 2, 2, 3, 4, 3, 4, 4, 4, 2, 1…\n$ choice_3            <dbl> NA, 4, 4, 4, 4, 4, 3, 4, 3, 3, 4, 3, 4, 4, 4, 2, 4…\n$ choice_4            <dbl> NA, 4, 2, 4, 3, 3, 4, 4, 3, 3, 4, 3, 4, 4, 2, 4, 4…\n$ choice_5            <dbl> NA, 2, 2, 4, 2, 2, 3, 3, 2, 2, 4, 2, 2, 4, 3, 2, 2…\n$ choice_6            <dbl> NA, 4, 4, 4, 3, 4, 2, 3, 2, 4, 1, 2, 4, 4, 3, 2, 4…\n$ choice_7            <dbl> NA, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1…\n$ choice_8            <dbl> NA, NA, 2, 4, 2, 1, 1, 1, 1, 3, 1, 1, 1, 4, 2, 2, …\n$ choice_9            <dbl> NA, NA, 1, 1, 1, 1, 1, 1, 1, 1, 4, 1, 1, 4, 1, 4, …\n$ choice_10           <dbl> 4, NA, 3, 3, 3, 3, 2, 4, 4, 3, 4, 3, 4, 4, 4, 2, 2…\n$ satis_1             <dbl> NA, 3, 3, 3, 4, 3, 3, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4…\n$ satis_2             <dbl> 3, 3, 3, 3, 4, 3, 3, 4, 4, 3, 4, 3, 4, 4, 4, 3, 3,…\n$ satis_3             <dbl> NA, 2, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 3…\n$ ing_1               <dbl> 4, 4, 1, 1, 3, 2, 1, 3, 1, 3, 2, 3, 1, 4, 1, 2, 2,…\n$ ing_2               <dbl> 3, 2, 1, 1, 4, 2, 1, 2, 1, 2, 1, 2, 1, 4, 4, 1, 1,…\n$ ing_3               <dbl> 3, 2, 1, 1, -99, -99, 1, 2, -99, 2, -99, -99, 1, 2…\n$ ing_4               <dbl> 4, 3, 4, 3, 3, -99, 4, 4, -99, 3, NA, -99, 3, 4, 1…\n$ att_1               <dbl> 4, 3, 3, 2, 2, 1, 2, 3, 4, 2, 1, 1, 2, 4, 2, 3, 3,…\n$ att_2               <dbl> 4, 4, 4, 3, 3, 2, 3, 4, 4, 4, 4, 3, 4, 4, 4, 3, 3,…\n$ att_3               <dbl> 2, 3, 3, 2, 2, 2, 2, 2, 3, 2, 1, 1, 2, 4, 2, 2, 3,…\n$ att_4               <dbl> 4, 3, 4, 3, 3, 2, 3, 2, 4, 2, NA, 2, 2, 4, 1, 3, 4…\n$ att_5               <dbl> 4, 4, 4, 3, 3, 2, 3, 3, 4, 2, NA, 2, 3, 4, 1, 3, 3…\n$ att_6               <dbl> 1, 2, 4, 2, 1, 1, 2, 1, 3, 2, 1, 1, 1, 1, 1, NA, 4…\n$ att_7               <dbl> 1, 2, 1, 2, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, NA, 4…\n$ att_8               <dbl> 4, 4, 4, 3, 3, 3, 3, 4, 3, 3, 3, 2, 4, 4, 1, 3, 4,…\n$ att_9               <dbl> 3, 4, -99, 3, 4, 2, 4, 4, 4, 4, 4, -99, 3, 4, 1, 4…\n$ att_10              <dbl> 4, 2, -99, 3, 3, -99, 4, 4, 4, 2, -99, -99, 3, 4, …\n$ att_11              <dbl> 4, 3, NA, 2, 4, 3, 2, 4, 3, 4, 4, 3, 4, 2, 4, 3, 4…\n$ diet                <dbl> 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ allerg              <dbl> 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,…\n$ relig               <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0,…\n$ meds                <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ tho_1               <dbl> 4, 4, 3, 4, 3, 3, 3, 4, 3, 4, 3, 2, 3, 4, 2, 3, 3,…\n$ tho_2               <dbl> 4, 3, 4, 4, 4, 3, 4, 4, 4, 4, 4, 3, 3, 4, 1, 4, 4,…\n$ tho_3               <dbl> 4, 3, 4, 4, 4, 2, 4, 3, 4, 4, 4, 3, 2, 4, 1, 4, 4,…\n$ tho_4               <dbl> 3, 3, 4, 4, 3, 3, 4, 3, 4, 4, 3, 3, 3, 4, 1, 4, 4,…\n$ tho_5               <dbl> 3, 3, 2, 2, 4, 2, 2, 4, 3, 3, 3, 2, 4, 4, 4, 2, 3,…\n$ tra_1               <dbl> 4, 4, 3, 4, 3, 3, 4, 4, 4, 4, 3, 3, 4, 4, 3, 3, 3,…\n$ tra_2               <dbl> 3, 3, 4, 4, 3, 3, 4, 4, 4, 4, 4, 3, 3, 4, 1, 4, 4,…\n$ tra_3               <dbl> 3, 3, 3, 4, NA, 2, 4, 3, 4, 4, 3, 3, 3, 4, 1, 4, 4…\n$ tra_4               <dbl> 4, NA, 4, 4, 4, 2, 4, 3, 4, 4, 3, 3, 3, 4, 1, 4, 4…\n$ tra_5               <dbl> 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 3, 3, 4, 2, 4, 4,…\n$ meat                <dbl> 6, 6, 4, 4, 4, 4, 5, 5, 5, 3, 3, 3, 5, 5, 4, 3, 1,…\n$ milk                <dbl> 5, 6, 6, 5, 3, 3, 6, 5, 6, 5, 6, 6, 6, 5, 6, 4, 3,…\n$ veget               <dbl> 2, 3, 4, 4, 2, 3, 3, 3, 4, 5, 1, 4, 2, 1, 1, 5, 6,…\n$ veg                 <dbl> 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 1, 1, 2, 1, 1, 3, 4,…\n$ pensum              <dbl> 5, NA, 4, 2, 5, 5, 3, 5, 2, 4, 5, 4, 4, 4, 5, 3, 1…\n$ cant                <dbl> 3, 1, 4, 3, 5, 4, 3, 4, 5, 2, 3, 3, 3, 4, 3, 5, 2,…\n$ home                <dbl> 4, 1, 2, 3, 2, 1, 1, 3, 1, 4, 3, 4, 3, 1, 4, 1, 3,…\n$ other               <dbl> 1, 1, 1, 2, 1, 3, 1, 1, 1, 1, 3, 1, 3, 1, 1, 2, 1,…\n$ gender              <chr> \"Mann\", \"Mann\", \"Mann\", \"Mann\", \"Frau\", \"Mann\", \"M…\n$ member              <chr> \"Student/in\", \"Andere\", \"Mitarbeiter/in\", \"Student…\n$ fill                <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ age_groups          <chr> \"17- bis 25-jaehrig\", \"26- bis 34-jaehrig\", \"26- b…\n$ mensa               <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ sumNA               <dbl> 11, 8, 1, 0, 1, 0, 0, 0, 0, 0, 3, 1, 0, 0, 0, 2, 1…\n$ perNA               <dbl> 2.115385e+14, 1.538462e+14, 1.923077e+14, 0.000000…\n$ Verpflegungstyp     <chr> \"Selbstverpfleger\", NA, \"Mensagaenger\", \"Abwechsle…\n$ date                <date> 2017-10-17, 2017-10-17, 2017-10-17, 2017-10-17, 2…\n$ place               <chr> \"Gr\\xfcental\", \"Gr\\xfcental\", \"Gr\\xfcental\", \"Gr\\x…\n$ intervention        <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ label_content       <chr> NA, \"Fleisch/Fisch\", \"Fleisch/Fisch\", \"Fleisch/Fis…\n$ meal_name           <chr> NA, \"Kalbsbratwurst\", \"Kalbsbratwurst\", \"Kalbsbrat…\n$ choice_add_d        <dbl> 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,…\n$ choice_add_v        <chr> NA, NA, \"Vegi-Men\\xfc\\x81 \\x81berzeugte nicht\", NA…\n$ code_choice         <chr> NA, NA, \"Unzufrieden mit Auswahl\", NA, NA, NA, NA,…\n$ Bemerkungen_d       <dbl> 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,…\n$ Bemerkungen_v       <chr> NA, NA, NA, NA, \"Sch\\xf6n w\\xe4ren mehr regionale …\n$ code_zu_Bemerkungen <chr> NA, NA, NA, NA, \"regional\", NA, NA, NA, NA, NA, \"A…\n```\n:::\n\n```{.r .cell-code}\n## definiert mytheme für ggplot2 (verwendet dabei theme_classic())\n\nmytheme <- \n  theme_classic() + \n  theme(\n    axis.line = element_line(color = \"black\"), \n    axis.text = element_text(size = 12, color = \"black\"), \n    axis.title = element_text(size = 12, color = \"black\"), \n    axis.ticks = element_line(size = .75, color = \"black\"), \n    axis.ticks.length = unit(.5, \"cm\")\n    )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Als eine Möglichkeit, die Aufgabe 1.1 zu bearbeiten, nehmen wir hier den \n# Datensatz  der Gästebefragung NOVANIMAL und gehen der folgenden Frage nach: \n# Gibt es einen Zusammenhang zwischen Geschlecht und dem wahrgenommenen \n# Milchkonsum (viel vs. wenig Milch/-produkte)\n\n# die Variable wahrgenommener Milchkonsum muss \n# noch in 2 Kategorien zusammengefasst werden: geringer vs. hoher Milchkonsum\n\n# Variable  milk == wahrgenommener Milchkonsum \n# alles kleiner als 4 (3 inklusive) == geringer wahrgenommener Milchkonsum, \n#alles grösser als 3 (4 inklusive) == hoher wahrgenommener Milchkonsum\nnova2 <- nova_survey %>% \n  filter(gender != \"x\") %>% # x aus der Variable Geschlecht entfernen \n  mutate(milkcon = if_else(milk <= 3, \"wenig\", \"viel\")) %>% \n  select(gender, milkcon) %>% \n  drop_na() # alle Missings können gestrichen werden\n \n# mal anschauen\ntable(nova2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      milkcon\ngender viel wenig\n  Frau  428    64\n  Mann  580    68\n```\n:::\n\n```{.r .cell-code}\n#achtung chi_squre erwartet matrix\nnova_mtx <- xtabs(~ gender + milkcon ,data = nova2) \n# da es in diesem fall keine kriteriumsvariable gibt, fehlt das y sozusagen\n\n#Chi-squared Test\nchi_sq <- chisq.test(nova_mtx)\nchi_sq\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  nova_mtx\nX-squared = 1.49, df = 1, p-value = 0.2222\n```\n:::\n\n```{.r .cell-code}\n#visualisierung\nOP <- par(mfrow=c(1,2), \"mar\"=c(1,1,3,1))\nmosaicplot(chi_sq$observed, cex.axis =1 , main = \"Observed counts\")\nmosaicplot(chi_sq$expected, cex.axis =1 , main = \"Expected counts\\n(wenn geschlecht keinen einfluss hat)\")\n```\n\n::: {.cell-output-display}\n![](Statistik1_Loesung_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(OP)\n\n#Fisher's Test nur mit 2X2 Kontingenztabelle möglich\nfisher.test(nova_mtx)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tFisher's Exact Test for Count Data\n\ndata:  nova_mtx\np-value = 0.1922\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 0.536215 1.147939\nsample estimates:\nodds ratio \n 0.7842283 \n```\n:::\n:::\n\n\n### Ergebnisse\n\nDer $\\chi^2$-Test sagt uns, dass das Geschlecht und der wahrgenommene Milchkonsum nicht zusammenhängen. Es gibt keine signifikante Unterscheide zwischen dem Geschlecht und dem wahrgenommenen Milchkonsum ($\\chi^2$(1) = 1.49, *p* = 0.222. Es sieht so aus, dass Männer leicht mehr angeben weniger Milch zu konsumieren (Tabelle 1). Die Ergebnisse müssen jedoch mit Vorsicht interpretiert werden, denn der $\\chi^2$-Test gibt uns nur an, dass ein signifikanter Unterschied zwischen Geschlecht und wahrgenommener Milchkonsum vorliegt. Um die Unterschiede innerhalb einer Gruppen (z.B. Geschlecht nach Alter) festzustellen bedarf es weiterer Analysen z. B. mit einer mehrfaktorieller ANOVA mit anschliessenden Post-hoc Tests (siehe Statistik 3).\n\n\n::: {.cell}\n::: {.cell-output-display}\nTable: Wahrgenommener Milchkonsum nach Geschlecht\n\n|Geschlecht |wahr. Milchkonsum | absolute Werte| wahr. Milchkonsum (%)|\n|:----------|:-----------------|--------------:|---------------------:|\n|Frau       |viel              |            428|                  87.0|\n|Frau       |wenig             |             64|                  13.0|\n|Mann       |viel              |            580|                  89.5|\n|Mann       |wenig             |             68|                  10.5|\n:::\n:::\n\n\n##  Musterlösung Übung 1.2: t-Test\n\n> Leseempfehlung Kapitel 2 von [Manny Gimond](https://mgimond.github.io/Stats-in-R/z_t_tests.html) \n\n### Null- und Alternativhypothese\n\n$H_0$: Es gibt keine Unterschiede in den Verkaufszahlen zwischen Basis- und Interventionswochen. \n\n$H_1$: Es gibt Unterschiede in den Verkaufszahlen zwischen Basis- und Interventionswochen.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Gemäss Aufgabenstellung müsset die Daten zuerst nach Kalenderwochen \"week\" \n# und Bedingungen \"condition\" zusammengefasst werden\n\ndf <- nova %>%\n    group_by(week, condit) %>%  \n    summarise(tot_sold = n()) \n\n# überprüft die Voraussetzungen für einen t-Test\nggplot2::ggplot(df, aes(x = condit, y= tot_sold)) + # achtung 0 Punkt fehlt\n    geom_boxplot(fill = \"white\", color = \"black\", size = 1) + \n    labs(x=\"\\nBedingungen\", y=\"Durchschnittlich verkaufte Gerichte pro Woche\\n\") + \n    mytheme\n```\n\n::: {.cell-output-display}\n![](Statistik1_Loesung_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Auf den ersten Blick scheint es keine starken Abweichungen zu einer \n#Normalverteilung zu geben resp. es sind keine extremen schiefen Verteilungen\n# ersichtlich (vgl. Skript Statistik 2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# führt einen t-Tests durch; \n# es wird angenommen, dass die Verkaufszahlen zwischen den Bedingungen \n# unabhängig sind\n\nt_test <- t.test(tot_sold ~ condit, data=df, var.equl = T)\n\n#alternative Formulierung\nt.test(df[df$condit == \"Basis\", ]$tot_sold, \n                 df[df$condit == \"Intervention\", ]$tot_sold) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  df[df$condit == \"Basis\", ]$tot_sold and df[df$condit == \"Intervention\", ]$tot_sold\nt = 0.27168, df = 9.9707, p-value = 0.7914\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -115.2743  147.2743\nsample estimates:\nmean of x mean of y \n     2203      2187 \n```\n:::\n:::\n\n\n### Methoden\n\nZiel war es die aggregierten Verkaufszahlen zwischen den Interventions- und Basiswochen zu vergleichen. Die Annahme ist, dass die wöchentlichen Verkaufszahlen unabhängig sind.  Daher können die Unterschiede zwischen den Verkaufszahlen pro Woche zwischen den beiden Bedingungen mittels t-Test geprüft werden. Obwohl die visuelle Inspektion keine schwerwiegenden Verletzungen der Modelvoraussetzung zeigte, wurde einen Welch t-Test gerechnet. Zudem muss gesagt werden, dass die Gruppengrösse hier jeweils mit n = 6 (Anzahl Wochen) eher klein ist. T-test liefern dennoch relativ reliable Resultate. Für mehr Infos dazu hier eine [Studie](https://scholarworks.umass.edu/cgi/viewcontent.cgi?article=1307&context=pare).\n\n### Ergebnisse\n\nIn den Basiswochen werden mehr Gerichte pro Woche verkauft als in den Interventionsowochen (siehe Abbildung 1). Die wöchentlichen Verkaufszahlen zwischen den Bedigungen (Basis oder Intervention) unterscheiden sich gemäss Welch t-Test jedoch nicht signifikant (*t*(10) = 0.272 , *p* = 0.791). Die Ergebnisse könnten mit einem $\\chi^2$-Test nochmals validiert werden, da die Gruppengrösse mit n = 6 doch eher klein ist.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Die wöchentlichen Verkaufszahlen für die Interventions- und Basiswochen unterscheiden sich nicht signifikant.](Statistik1_Loesung_files/figure-html/unnamed-chunk-9-1.png){width=80%}\n:::\n:::\n",
    "supporting": [
      "Statistik1_Loesung_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}