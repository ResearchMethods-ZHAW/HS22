{
  "hash": "71a0b379c9f199e1f93a568b1c9774ef",
  "result": {
    "markdown": "---\ndate: 2022-11-01\nlesson: Stat2\nthema: Einführung in lineare Modelle\nindex: 4\n---\n\n\n# Stat2: Lösung  2.1\n\n\n::: {.cell}\n\n:::\n\n\n- [RCode als Download](purl/Statistik2_Loesung_1.R)\n- [Lösungstext als Download](Statistik_Loesung_2.1.pdf)\n\n## Lösungsweg\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSAR <- read.delim(\"data/SAR.csv\", sep = \";\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nSAR\n```\n:::\n\n\n### Explorative Datenanalyse\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(SAR)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      area             richness    \n Min.   :  0.0001   Min.   : 1.00  \n 1st Qu.:  0.0010   1st Qu.: 4.00  \n Median :  0.1000   Median : 9.00  \n Mean   :  9.4017   Mean   :16.37  \n 3rd Qu.:  1.0000   3rd Qu.:24.00  \n Max.   :100.0000   Max.   :85.00  \n```\n:::\n\n```{.r .cell-code}\nboxplot(SAR$area) # extrem rechtsschief\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nboxplot(SAR$richness) # extrem rechtsschief\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(richness~area, data = SAR) # sieht nicht linear aus\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n:::\n\n\n### Einfaches lineares Modell\n\n::: {.cell}\n\n```{.r .cell-code}\nlm.1 <- lm(richness~area, data = SAR)\nsummary(lm.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = richness ~ area, data = SAR)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-29.567  -8.474  -3.503   6.112  35.317 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  11.4742     0.9582   11.97   <2e-16 ***\narea          0.5209     0.0342   15.23   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.27 on 154 degrees of freedom\nMultiple R-squared:  0.601,\tAdjusted R-squared:  0.5984 \nF-statistic: 231.9 on 1 and 154 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n### Modelldiagnostik\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nplot(lm.1)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Ergebnisplot\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\nplot(SAR$area, SAR$richness, xlab = \"Area [m²]\", ylab = \"Species richness\")\nabline(lm(richness~area, data = SAR), col = \"red\") #Alternative 1\nabline(lm.1, col = \"red\") #Alternative 2\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## Lösung A: log-Transformation der abhängigen Variablen\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(1,2))\nboxplot(SAR$richness)\nboxplot(log10(SAR$richness))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(SAR$richness)\nhist(log10(SAR$richness))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n\n```{.r .cell-code}\nSAR$log_richness <- log10(SAR$richness)\nlm.2 <- lm(log_richness~area, data = SAR)\nsummary(lm.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = log_richness ~ area, data = SAR)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.85613 -0.34114 -0.01204  0.36365  0.75729 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 0.856116   0.036657   23.36  < 2e-16 ***\narea        0.010259   0.001309    7.84 6.94e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4313 on 154 degrees of freedom\nMultiple R-squared:  0.2853,\tAdjusted R-squared:  0.2806 \nF-statistic: 61.47 on 1 and 154 DF,  p-value: 6.939e-13\n```\n:::\n:::\n\n\n### Modelldiagnostik\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nplot(lm.2)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n#sieht noch schlechter aus\n\n## Lösung B: log-Transformation beider Variablen\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(1,2))\nboxplot(SAR$area)\nboxplot(log10(SAR$area))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(SAR$area)\nhist(log10(SAR$area))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n```{.r .cell-code}\nSAR$log_area <- log10(SAR$area)\nlm.3 <- lm(log_richness~log_area, data = SAR)\nsummary(lm.3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = log_richness ~ log_area, data = SAR)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.50241 -0.09353  0.02130  0.09965  0.40068 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 1.265730   0.015607   81.10   <2e-16 ***\nlog_area    0.254440   0.006926   36.73   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1633 on 154 degrees of freedom\nMultiple R-squared:  0.8976,\tAdjusted R-squared:  0.8969 \nF-statistic:  1349 on 1 and 154 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n### Modelldiagnostik\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nplot(lm.3)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\ndas sieht jetzt sehr gut aus, bis auf zwei Ausreisser im QQ-Plot\n\n**Ergebnisplots C **\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\nxv <- seq(0, 100, 0.1)\n```\n:::\n\n\n## Ergebnisplots\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1,1))\nxv <- seq(0,100,0.1)\n```\n:::\n\n\n### A. lineares Modell mit log-transformierter Abhängiger\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(SAR$area, SAR$richness)\nyv1a <- 10^predict(lm.2, list(area = xv))\nlines(xv, yv1a, col = \"blue\")\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n### B. lineares Modell mit log-Transformation beider Variablen\n\n::: {.cell}\n\n```{.r .cell-code}\nxvlog <- seq(-4,2,0.1)\nplot(SAR$log_area, SAR$log_richness, xlab = \"log10 (Fläche [m²])\", ylab = \"log10 (Artenreichtum)\")\nyv1b <- predict(lm.3, list(log_area = xvlog))\nlines(xvlog, yv1b, col = \"green\")\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n### C. lineares Modell mit log-Transformation beider Variablen (zurücktransformiert)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(SAR$area, SAR$richness, xlab = \"Fläche [m²]\", ylab = \"Artenreichtum\")\nyv1b <- predict(lm.3, list(log_area = xv))\nlines(10^xv, 10^yv1b, col = \"green\")\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n## Modelle im Vergleich\n\n::: {.cell}\n\n```{.r .cell-code}\n#Modelle im Vergleich\nplot(SAR$area, SAR$richness)\nabline(lm.1, col=\"red\")\nlines(xv, yv1a, col=\"blue\")\nlines(10^xv, 10^yv1b, col=\"green\")\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Statistik2_Loesung_1_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}