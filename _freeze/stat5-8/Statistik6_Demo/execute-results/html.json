{
  "hash": "7445caa64d811ccfd05821b66b0033bd",
  "result": {
    "markdown": "---\ndate: 2022-11-15\nlesson: Stat6\nthema: Einführung in \"multivariate\" Methoden\nindex: 1\n---\n\n\n# Stat6: Demo\n\n\n::: {.cell}\n\n:::\n\n\n## Ordinationen I\n\n[Demoscript als Download](../purl/Statistik6_Demo.R)\n\n### PCA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!require(labdsv)){install.packages(\"labdsv\")}\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in contrib.url(repos, \"source\"): versuche CRAN ohne einen Spiegelserver zu nutzen\n```\n:::\n\n```{.r .cell-code}\nlibrary(labdsv)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in library(labdsv): es gibt kein Paket namens 'labdsv'\n```\n:::\n\n```{.r .cell-code}\n# Für Ordinationen benötigen wir Matrizen, nicht Data.frames\n# Generieren von Daten\nraw <- matrix(c(1, 2, 2.5, 2.5, 1, 0.5, 0, 1, 2, 4, 3, 1), nrow = 6)\ncolnames(raw) <- c(\"spec.1\", \"spec.2\")\nrownames(raw) <- c(\"r1\", \"r2\", \"r3\", \"r4\", \"r5\", \"r6\")\nraw\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   spec.1 spec.2\nr1    1.0      0\nr2    2.0      1\nr3    2.5      2\nr4    2.5      4\nr5    1.0      3\nr6    0.5      1\n```\n:::\n\n```{.r .cell-code}\n# Originale Daten im zweidimensionalen Raum\nx1 <- raw[,1]\ny1 <- raw[,2]\nz <- c(rep(1:6))\n\n# Plot Abhängigkeit der Arten vom Umweltgradienten\nplot(c(x1, y1)~c(z, z), type = \"n\", axes = T, bty = \"l\", \n     las = 1, xlim = c(1,6), ylim = c(0,5),\n     xlab = \"Umweltgradient\", ylab = \"Deckung der Arten\")\npoints(x1~z, pch = 21, type = \"b\")\npoints(y1~z, pch = 16, type = \"b\")\n\n# zentrierte Daten\ncent <- scale(raw, scale = F)\nx2 <- cent[,1]\ny2 <- cent[,2]\n\n# rotierte Daten\no.pca <- pca(raw)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in pca(raw): konnte Funktion \"pca\" nicht finden\n```\n:::\n\n```{.r .cell-code}\nx3 <- o.pca$scores[,1]\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'o.pca' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\ny3 <- o.pca$scores[,2]\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'o.pca' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n# Visualisierung der Schritte im Ordinationsraum\nplot(c(y1, y2, y3)~c(x1, x2, x3), type = \"n\", axes = T, bty = \"l\", las = 1,\n     xlim = c(-4, 4), ylim = c(-4, 4), xlab = \"Art 1\", ylab=  \"Art 2\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(predvars, data, env): Objekt 'y3' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\npoints(y1~x1, pch = 21, type = \"b\", col = \"green\", lwd = 2)\npoints(y2~x2, pch = 16, type = \"b\",col = \"red\", lwd = 2)\npoints(y3~x3, pch = 17, type = \"b\", col = \"blue\", lwd = 2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(predvars, data, env): Objekt 'y3' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n# Durchführung der PCA\no.pca <- pca(raw)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in pca(raw): konnte Funktion \"pca\" nicht finden\n```\n:::\n\n```{.r .cell-code}\n# Koordinaten im Ordinationsraum\no.pca$scores\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'o.pca' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n# Korrelationen der Variablen mit den Ordinationsachsen\no.pca$loadings\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'o.pca' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n#Erklärte Varianz der Achsen\nE <- o.pca$sdev^2 / o.pca$totdev * 100\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'o.pca' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\nE\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'E' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n# mit prcomp\npca.2 <- prcomp(raw, scale = F)\nsummary(pca.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nImportance of components:\n                         PC1    PC2\nStandard deviation     1.548 0.7154\nProportion of Variance 0.824 0.1760\nCumulative Proportion  0.824 1.0000\n```\n:::\n\n```{.r .cell-code}\nplot(pca.2)\nbiplot(pca.2)\n\n# mit vegan\nif(!require(vegan)){install.packages(\"vegan\")}\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in contrib.url(repos, \"source\"): versuche CRAN ohne einen Spiegelserver zu nutzen\n```\n:::\n\n```{.r .cell-code}\nlibrary(\"vegan\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in library(\"vegan\"): es gibt kein Paket namens 'vegan'\n```\n:::\n\n```{.r .cell-code}\n# Die Funktion rda führt ein PCA aus an wenn nicht Artdaten UND Umweltdaten definiert werden\npca.3 <- rda(raw, scale = FALSE)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in rda(raw, scale = FALSE): konnte Funktion \"rda\" nicht finden\n```\n:::\n\n```{.r .cell-code}\n#scores(pca.3, display = c(\"sites\"))\n#scores(pca.3, display = c(\"species\"))\nsummary(pca.3, axes = 0)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(pca.3, axes = 0): Objekt 'pca.3' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\nbiplot(pca.3)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in biplot(pca.3): Objekt 'pca.3' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n# Mit Beispieldaten aus Wildi\nif(!require(dave)){install.packages(\"dave\")}\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in contrib.url(repos, \"source\"): versuche CRAN ohne einen Spiegelserver zu nutzen\n```\n:::\n\n```{.r .cell-code}\nlibrary(dave)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in library(dave): es gibt kein Paket namens 'dave'\n```\n:::\n\n```{.r .cell-code}\ndata(sveg)\n```\n\n::: {.cell-output-display}\n![Generierter Plot](Statistik6_Demo_files/figure-html/fig-baseplot-pca1-1.png){#fig-baseplot-pca1-1 width=672}\n:::\n\n::: {.cell-output-display}\n![Generierter Plot](Statistik6_Demo_files/figure-html/fig-baseplot-pca1-2.png){#fig-baseplot-pca1-2 width=672}\n:::\n\n::: {.cell-output-display}\n![Generierter Plot](Statistik6_Demo_files/figure-html/fig-baseplot-pca1-3.png){#fig-baseplot-pca1-3 width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(sveg)\nsummary(sveg)\nnames(sveg)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# PCA: Deckungen Wurzeltransformiert, cor=T erzwingt Nutzung der Korrelationsmatrix\npca.5 <- pca(sveg^0.25, cor = T)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in pca(sveg^0.25, cor = T): konnte Funktion \"pca\" nicht finden\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Koordinaten im Ordinationsraum\npca.5$scores\n\n# Korrelationen der Variablen mit den Ordinationsachsen\npca.5$loadings\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Erklärte Varianz der Achsen in Prozent (sdev ist die Wurzel daraus)\nE <- pca.5$sdev^2 / pca.5$totdev * 100\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'pca.5' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\nE\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'E' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\nE[1:5]\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'E' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n# PCA-Plot der Lage der Beobachtungen im Ordinationsraum\nplot(pca.5$scores[,1], pca.5$scores[,2], type = \"n\", asp = 1, xlab = \"PC1\", ylab = \"PC2\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in plot(pca.5$scores[, 1], pca.5$scores[, 2], type = \"n\", asp = 1, : Objekt 'pca.5' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\npoints(pca.5$scores[,1], pca.5$scores[,2], pch = 18)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in points(pca.5$scores[, 1], pca.5$scores[, 2], pch = 18): Objekt 'pca.5' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n# Subjektive Auswahl von Arten zur Darstellung\nsel.sp <- c(3, 11, 23, 39, 46, 72, 77, 96)\nsnames <- names(sveg[,sel.sp])\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'sveg' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\nsnames\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'snames' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n# PCA-Plot der Korrelationen der Variablen (hier Arten) mit den Achsen (h)\nx <- pca.5$loadings[,1]\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'pca.5' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\ny <- pca.5$loadings[,2]\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'pca.5' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\nplot(x, y, type = \"n\", asp = 1)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in plot(x, y, type = \"n\", asp = 1): Objekt 'x' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\narrows(0,0, x[sel.sp], y[sel.sp], length = 0.08)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in arrows(0, 0, x[sel.sp], y[sel.sp], length = 0.08): Objekt 'x' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\ntext(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in text(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6): Objekt 'x' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n# Mit vegan\npca.6 <- rda(sveg^0.25, scale = TRUE)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in rda(sveg^0.25, scale = TRUE): konnte Funktion \"rda\" nicht finden\n```\n:::\n\n```{.r .cell-code}\n# Erklärte Varianz der Achsen\nsummary(pca.6, axes = 0)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(pca.6, axes = 0): Objekt 'pca.6' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n# PCA-Plot der Lage der Beobachtungen im Ordinationsraum\nbiplot(pca.6, display = \"sites\", type = \"points\", scaling = 1)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in biplot(pca.6, display = \"sites\", type = \"points\", scaling = 1): Objekt 'pca.6' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n# Subjektive Auswahl von Arten zur Darstellung\nsel.sp <- c(3, 11, 23, 39, 46, 72, 77, 96)\nsnames <- names(sveg[,sel.sp])\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'sveg' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\nsnames\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'snames' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n# PCA-Plot der Korrelationen der Variablen (hier Arten) mit den Achsen (h)\nscores <- scores(pca.6, display = \"species\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in scores(pca.6, display = \"species\"): konnte Funktion \"scores\" nicht finden\n```\n:::\n\n```{.r .cell-code}\nx <- scores[,1]\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'scores' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\ny <- scores[,2]\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'scores' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\nplot(x, y, type = \"n\", asp = 1)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in plot(x, y, type = \"n\", asp = 1): Objekt 'x' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\narrows(0,0, x[sel.sp], y[sel.sp], length = 0.08)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in arrows(0, 0, x[sel.sp], y[sel.sp], length = 0.08): Objekt 'x' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\ntext(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in text(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6): Objekt 'x' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n# Mit angepassten Achsen\nplot(x, y, type = \"n\", asp = 1, xlim = c(-1, 1), ylim = c(-0.6, 0.6))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in plot(x, y, type = \"n\", asp = 1, xlim = c(-1, 1), ylim = c(-0.6, : Objekt 'x' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\narrows(0,0, x[sel.sp], y[sel.sp], length = 0.08)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in arrows(0, 0, x[sel.sp], y[sel.sp], length = 0.08): Objekt 'x' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\ntext(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in text(x[sel.sp], y[sel.sp], snames, pos = 1, cex = 0.6): Objekt 'x' nicht gefunden\n```\n:::\n:::\n\n\n### CA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca.1 <- cca(sveg^0.5)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in cca(sveg^0.5): konnte Funktion \"cca\" nicht finden\n```\n:::\n\n```{.r .cell-code}\n# Arten (o) und Communities (+) plotten\nplot(ca.1)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in plot(ca.1): Objekt 'ca.1' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n# Nur Arten plotten\nplot(ca.1, display = \"species\", type = \"points\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in plot(ca.1, display = \"species\", type = \"points\"): Objekt 'ca.1' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n# Anteilige Varianz, die durch die ersten beiden Achsen erklärt wird\nca.1$CA$eig[1:2] / sum(ca.1$CA$eig)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): Objekt 'ca.1' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\nsummary(eigenvals(ca.1))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eigenvals(ca.1): konnte Funktion \"eigenvals\" nicht finden\n```\n:::\n:::\n\n\n### DCA\n \n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(vegan)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in library(vegan): es gibt kein Paket namens 'vegan'\n```\n:::\n\n```{.r .cell-code}\ndca.1 <- decorana(sveg, mk = 10)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in decorana(sveg, mk = 10): konnte Funktion \"decorana\" nicht finden\n```\n:::\n\n```{.r .cell-code}\nplot(dca.1, display = \"sites\", type = \"point\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in plot(dca.1, display = \"sites\", type = \"point\"): Objekt 'dca.1' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\ndca.2 <- decorana(sveg, mk = 100)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in decorana(sveg, mk = 100): konnte Funktion \"decorana\" nicht finden\n```\n:::\n\n```{.r .cell-code}\nplot(dca.2, display = \"sites\", type = \"point\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in plot(dca.2, display = \"sites\", type = \"point\"): Objekt 'dca.2' nicht gefunden\n```\n:::\n:::\n\n\n### NMDS\n \n\n::: {.cell}\n\n```{.r .cell-code}\n# Distanzmatrix als Start erzeugen\nmde <- vegdist(sveg, method = \"euclidean\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in vegdist(sveg, method = \"euclidean\"): konnte Funktion \"vegdist\" nicht finden\n```\n:::\n\n```{.r .cell-code}\n# Alternative mit einem für Vegetationsdaten häufig verwendeten Dissimilarity-index\nmde <- vegdist(sveg, method = \"bray\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in vegdist(sveg, method = \"bray\"): konnte Funktion \"vegdist\" nicht finden\n```\n:::\n\n```{.r .cell-code}\n#Z wei verschiedene NMDS-Methoden\nif(!require(MASS)){install.packages(\"MASS\")}\nlibrary(MASS)\nset.seed(1) # macht man, wenn man bei einer Wiederholung exakt die gleichen Ergebnisse will\nimds <- isoMDS(mde, k = 2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in isoMDS(mde, k = 2): Objekt 'mde' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\nset.seed(1)\nmmds <- metaMDS(mde, k = 2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in metaMDS(mde, k = 2): konnte Funktion \"metaMDS\" nicht finden\n```\n:::\n\n```{.r .cell-code}\nplot(imds$points)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in plot(imds$points): Objekt 'imds' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\nplot(mmds$points)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in plot(mmds$points): Objekt 'mmds' nicht gefunden\n```\n:::\n\n```{.r .cell-code}\n#Stress = S² = Abweichung der zweidimensionalen NMDS-Lösung von der originalen Distanzmatrix\nstressplot(imds, mde)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in stressplot(imds, mde): konnte Funktion \"stressplot\" nicht finden\n```\n:::\n\n```{.r .cell-code}\nstressplot(mmds, mde)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in stressplot(mmds, mde): konnte Funktion \"stressplot\" nicht finden\n```\n:::\n:::\n",
    "supporting": [
      "Statistik6_Demo_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}