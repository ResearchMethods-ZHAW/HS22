<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Research Methods - 69&nbsp; 7. Lösung</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../fallstudie_s/7_Multivariate_Statistik_Uebung.html" rel="next">
<link href="../fallstudie_s/6_Desktiptive_Analysen_Loesung.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">7. Lösung</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Research Methods</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ResearchMethods-ZHAW/HS22/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Willkommen</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">Prepro</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prepro/Prepro1_Demo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Prepro 1: Demo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prepro/Prepro1_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">PrePro 1: Übung</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prepro/Prepro2_Demo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Prepro 2: Demo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prepro/Prepro2_Uebung_A.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Prepro 2: Übung A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prepro/Prepro2_Uebung_B.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Prepro 2: Übung B</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prepro/Prepro3_Demo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Prepro 3: Demo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prepro/Prepro3_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Prepro 3: Übung</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">InfoVis</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../infovis/Infovis1_Demo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Infovis 1: Demo A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../infovis/Infovis1_Script_eda.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Infovis 1: Demo B</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../infovis/Infovis1_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Infovis 1: Übung</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../infovis/Infovis2_cairo_wheel.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Infovis 2: Cairo Wheel</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../infovis/Infovis2_Uebung_A.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Infovis 2: Übung A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../infovis/Infovis2_Uebung_B.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Infovis 2: Übung B</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Stat1-4</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik1_Demo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat1: Demo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik1_Loesung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat1: Loesung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik1_Novanimal.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat1: NOVANIMAL</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik1_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat1: Übung</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik2_Demo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat2: Demo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik2_Loesung_1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat2: Loesung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik2_Loesung_2223s.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat2: Lösung 2223s</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik2_Loesung_23n.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat2: Lösung 23n</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik2_Loesung_Beispiel.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat2: Lösung Beispiel</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik2_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat2: Übung</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik3_Demo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat3: Demo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik3_Loesung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat3: Lösung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik3_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat3: Übung</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik4_Demo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat4: Demo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik4_Loesung_1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat4: Lösung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik4_Loesung_2n.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat4: Lösung 2n</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik4_Loesung_2s.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat4: Lösung 2s</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat1-4/Statistik4_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat4: Übung</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Stat5-8</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat5-8/Statistik5_Demo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat5: Demo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat5-8/Statistik5_Loesung_1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat5: Lösung 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat5-8/Statistik5_Loesung_2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat5: Lösung 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat5-8/Statistik5_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat5: Übung</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat5-8/Statistik6_Demo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat6: Demo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat5-8/Statistik6_Loesung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat6: Lösung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat5-8/Statistik6_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat6: Übung</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat5-8/Statistik7_Demo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat7: Demo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat5-8/Statistik7_Loesung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat7: Lösung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat5-8/Statistik7_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat7: Übung</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat5-8/Statistik8_Demo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat8: Demo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat5-8/Statistik8_Loesung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat8: Lösung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stat5-8/Statistik8_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Stat8: Übung</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">StatKons</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statKons/StatKons1_Demo_assoziationen.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">StatKons1: Demo 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statKons/StatKons1_Demo_open_datasets.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">StatKons1: Datensätze</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statKons/StatKons1_Demo_suggest_datasets.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">StatKons1: Datensätze</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statKons/StatKons2_Demo_PCA.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">StatKons2: Demo</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statKons/StatKons3_Demo_LM.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">StatKons3: Demo</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../statKons/StatKons4_Demo_GLM.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">StatKons4: Demo</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">Rauman</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rauman/Rauman1_Uebung_A.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Rauman 1: Übung A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rauman/Rauman1_Uebung_B.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Rauman 1: Übung B</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rauman/Rauman2_Uebung_A.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Rauman 2: Übung A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rauman/Rauman2_Uebung_B.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Rauman 2: Übung B</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rauman/Rauman2_Uebung_C.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Rauman 2: Übung C</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rauman/Rauman3_Uebung_A.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Rauman 3: Übung A</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rauman/Rauman4_Uebung_A_ahp.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Rauman 4: Übung A</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rauman/Rauman4_Uebung_B_raster.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Rauman 4: Übung B</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../rauman/Rauman5_Uebung_mce.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Rauman 5: Übung</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Fallstudie S</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_s/1_Einleitung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Einleitung</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_s/2_Felderhebung_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2: Felderhebung Übung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_s/2_Felderhebung_Loesung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2: Felderhebung Lösung</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_s/3_Aufgabenstellung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. Aufgabenstellung</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_s/4_Projektierung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4. Anleitung</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_s/5_Import_Vorverarbeitung_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">5. Übung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_s/5_Import_Vorverarbeitung_Loesung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">5. Lösung</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_s/6_Deskriptive_Analysen_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6. Übung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_s/6_Desktiptive_Analysen_Loesung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6. Lösung</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_s/7_Multivariate_Statistik_Loesung.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">7. Lösung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_s/7_Multivariate_Statistik_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">7. Übung</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">Fallstudie N</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_n/1_Vorbemerkung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1. Vorbemerkung</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_n/2_Datenverarbeitung_Loesung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Lösung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_n/2_Datenverarbeitung_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2. Übung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_n/3_Berechnung_Homeranges_Loesung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. Lösung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_n/3_Berechnung_Homeranges_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3. Aufgabe</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_n/4_Multivariate_Modelle_Loesung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4. Lösung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_n/4_Multivariate_Modelle_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4. Übung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_n/5_Variablenselektion_Loesung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">5. Lösung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_n/5_Variablenselektion_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">5. Aufgabe</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_n/6_Guete_und_Diagnostics_Loesung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6. Lösung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_n/6_Guete_und_Diagnostics_Uebung.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6. Übung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fallstudie_n/7_Modelle_mit_Nutzungsintensitaet.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">7. Nutzungsintensität</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#aufgabe-1-verbinden-von-daten-join" id="toc-aufgabe-1-verbinden-von-daten-join" class="nav-link active" data-scroll-target="#aufgabe-1-verbinden-von-daten-join">Aufgabe 1: Verbinden von Daten (Join)</a></li>
  <li><a href="#aufgabe-2-convinience-variablen-faktoren-skalieren" id="toc-aufgabe-2-convinience-variablen-faktoren-skalieren" class="nav-link" data-scroll-target="#aufgabe-2-convinience-variablen-faktoren-skalieren">Aufgabe 2: Convinience Variablen, Faktoren, Skalieren</a></li>
  <li><a href="#aufgabe-3-korrelationen-und-variablenselektion" id="toc-aufgabe-3-korrelationen-und-variablenselektion" class="nav-link" data-scroll-target="#aufgabe-3-korrelationen-und-variablenselektion">Aufgabe 3: Korrelationen und Variablenselektion</a></li>
  <li><a href="#aufgabe-4-optional-automatische-variablenselektion" id="toc-aufgabe-4-optional-automatische-variablenselektion" class="nav-link" data-scroll-target="#aufgabe-4-optional-automatische-variablenselektion">Aufgabe 4 (OPTIONAL): Automatische Variablenselektion</a></li>
  <li><a href="#aufgabe-5-verteilung-der-abhängigen-variabel-pruefen" id="toc-aufgabe-5-verteilung-der-abhängigen-variabel-pruefen" class="nav-link" data-scroll-target="#aufgabe-5-verteilung-der-abhängigen-variabel-pruefen">Aufgabe 5: Verteilung der abhängigen Variabel pruefen</a></li>
  <li><a href="#aufgabe-6-multivariates-modell-berechnen" id="toc-aufgabe-6-multivariates-modell-berechnen" class="nav-link" data-scroll-target="#aufgabe-6-multivariates-modell-berechnen">Aufgabe 6: Multivariates Modell berechnen</a></li>
  <li><a href="#aufgabe-7-modellvisualisierung" id="toc-aufgabe-7-modellvisualisierung" class="nav-link" data-scroll-target="#aufgabe-7-modellvisualisierung">Aufgabe 7: Modellvisualisierung</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block"><span class="chapter-title">7. Lösung</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="cell">

</div>
<section id="aufgabe-1-verbinden-von-daten-join" class="level1">
<h1>Aufgabe 1: Verbinden von Daten (Join)</h1>
<div class="cell" data-layout-align="left">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.1 Einflussfaktoren Besucherzahl ####</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstelle ein df indem die taeglichen Zaehldaten und Meteodaten vereint sind</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>umwelt <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(depo_d, meteo, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Datum"</span> <span class="ot">=</span> <span class="st">"time"</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Das zusammenfuehren folgt evtl. in NA-Werten bei gewissen Tagen</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(umwelt))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="aufgabe-2-convinience-variablen-faktoren-skalieren" class="level1">
<h1>Aufgabe 2: Convinience Variablen, Faktoren, Skalieren</h1>
<div class="cell" data-layout-align="left">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nochmals einige Convinience Variablen</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>umwelt <span class="ot">&lt;-</span> umwelt<span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ferien =</span> <span class="fu">if_else</span>(  </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    Datum <span class="sc">&gt;=</span> Fruehlingsferien_2019_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Fruehlingsferien_2019_ende <span class="sc">|</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Sommerferien_2019_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Sommerferien_2019_ende <span class="sc">|</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Herbstferien_2019_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Herbstferien_2019_ende <span class="sc">|</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Winterferien_2019_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Winterferien_2019_ende <span class="sc">|</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Fruehlingsferien_2020_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Fruehlingsferien_2020_ende <span class="sc">|</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Sommerferien_2020_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Sommerferien_2020_ende <span class="sc">|</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Herbstferien_2020_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Herbstferien_2020_ende <span class="sc">|</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Winterferien_2020_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Winterferien_2020_ende <span class="sc">|</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Fruehlingsferien_2021_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Fruehlingsferien_2021_ende <span class="sc">|</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Sommerferien_2021_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> <span class="fu">max</span>(depo<span class="sc">$</span>Datum),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1"</span>, <span class="st">"0"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ferien =</span> <span class="fu">factor</span>(Ferien))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Faktor und integer</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Im GLMM wird die Kalenderwoche und das Jahr als random factor definiert. Dazu muss sie als</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Faktor vorliegen.</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>umwelt <span class="ot">&lt;-</span> umwelt <span class="sc">%&gt;%</span> </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Jahr =</span> <span class="fu">as.factor</span>(Jahr)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">KW =</span> <span class="fu">as.factor</span>(KW))</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Unser Modell kann nur mit ganzen Zahlen umgehen. Zum Glueck habe wir die Zaehldaten</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># bereits gerundet.</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="co"># pruefe str des df</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(umwelt)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(umwelt)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(umwelt))</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co"># unser Datensatz muss ein df sein, damit scale funktioniert</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>umwelt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(umwelt)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co">#  Variablen skalieren</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Skalieren der Variablen, damit ihr Einfluss vergleichbar wird </span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="co"># (Problem verschiedene Skalen der Variablen (bspw. Temperatur in Grad Celsius, </span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Niederschlag in Millimeter und Sonnenscheindauer in Minuten)</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>umwelt <span class="ot">&lt;-</span> umwelt <span class="sc">%&gt;%</span> </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tre200jx_scaled =</span> <span class="fu">scale</span>(tre200jx), </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">rre150j0_scaled =</span> <span class="fu">scale</span>(rre150j0), </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">sremaxdv_scaled =</span> <span class="fu">scale</span>(sremaxdv))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="aufgabe-3-korrelationen-und-variablenselektion" class="level1">
<h1>Aufgabe 3: Korrelationen und Variablenselektion</h1>
<div class="cell" data-layout-align="left">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.2 Variablenselektion ####</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Korrelierende Variablen koennen das Modelergebnis verfaelschen. Daher muss vor der</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelldefinition auf Korrelation getestet werden.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Erklaerende Variablen definieren</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Hier wird die Korrelation zwischen den (nummerischen) erklaerenden Variablen berechnet</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span>  <span class="fu">cor</span>(umwelt[,<span class="dv">16</span><span class="sc">:</span>(<span class="fu">ncol</span>(umwelt))]) <span class="co"># in den [] waehle ich die skalierten Spalten.</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Mit dem folgenden Code kann eine simple Korrelationsmatrix aufgebaut werden</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># hier kann auch die Schwelle für die Korrelation gesetzt werden, </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.7 ist liberal / 0.5 konservativ</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># https://researchbasics.education.uconn.edu/r_critical_value_table/</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>cor[<span class="fu">abs</span>(cor)<span class="sc">&lt;</span><span class="fl">0.7</span>] <span class="ot">&lt;-</span>  <span class="dv">0</span> <span class="co">#Setzt alle Werte kleiner 0.7 auf 0 (diese sind dann ok, alles groesser ist problematisch!)</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>cor</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Korrelationsmatrix erstellen</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Zur Visualisierung kann ein einfacher Plot erstellt werden:</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">chart.Correlation</span>(umwelt[,<span class="dv">16</span><span class="sc">:</span>(<span class="fu">ncol</span>(umwelt))], <span class="at">histogram=</span><span class="cn">TRUE</span>, <span class="at">pch=</span><span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="7_Multivariate_Statistik_Loesung_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="aufgabe-4-optional-automatische-variablenselektion" class="level1">
<h1>Aufgabe 4 (OPTIONAL): Automatische Variablenselektion</h1>
<div class="cell" data-layout-align="left">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Automatisierte Variablenselektion </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # fuehre die dredge-Funktion und ein Modelaveraging durch</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # Hier wird die Formel für die dredge-Funktion vorbereitet</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># f &lt;- Total ~ Wochentag + Ferien + Phase +</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   tre200jx_scaled + rre150j0_scaled + sremaxdv_scaled</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # Jetzt kommt der Random-Factor hinzu und es wird eine Formel daraus gemacht</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># f_dredge &lt;- paste(c(f, "+ (1|KW)", "+ (1|Jahr)"), collapse = " ") %&gt;% </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   as.formula()</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # Das Modell mit dieser Formel ausführen</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># m &lt;- glmer(f_dredge, data = umwelt, family = poisson, na.action = "na.fail")</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # Das Modell in die dredge-Funktion einfügen (siehe auch ?dredge)</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># all_m &lt;- dredge(m)</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # suche das beste Modell</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># print(all_m)</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # Importance values der Variablen </span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># # hier wird die wichtigkeit der Variablen in den verschiedenen Modellen abgelesen</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co"># MuMIn::importance(all_m) </span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># # Schliesslich wird ein Modelaverage durchgeführt </span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># # Schwellenwert für das delta-AIC = 2</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co"># avgmodel &lt;- model.avg(all_m, rank = "AICc", subset = delta &lt; 500) </span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(avgmodel)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="aufgabe-5-verteilung-der-abhängigen-variabel-pruefen" class="level1">
<h1>Aufgabe 5: Verteilung der abhängigen Variabel pruefen</h1>
<div class="cell" data-layout-align="left">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.3 Pruefe Verteilung ####</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pruefe zuerst nochmals, ob wir NA im df haben:</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(umwelt<span class="sc">$</span>Total))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="fu">fitdist</span>(umwelt<span class="sc">$</span>Total,<span class="st">"norm"</span>)  <span class="co"># Normalverteilung</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># f1_1&lt;-fitdist((umwelt$Total + 1),"lnorm")  # log-Normalvert (beachte, dass ich +1 rechne. </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># log muss positiv sein; allerdings kann man die</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Verteilungen dann nicht mehr miteinander vergleichen). </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="fu">fitdist</span>(umwelt<span class="sc">$</span>Total,<span class="st">"pois"</span>)  <span class="co"># Poisson</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>f3<span class="ot">&lt;-</span><span class="fu">fitdist</span>(umwelt<span class="sc">$</span>Total,<span class="st">"nbinom"</span>)  <span class="co"># negativ binomial</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>f4<span class="ot">&lt;-</span><span class="fu">fitdist</span>(umwelt<span class="sc">$</span>Total,<span class="st">"exp"</span>)  <span class="co"># exponentiell</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># f5&lt;-fitdist(umwelt$Total,"gamma")  # gamma (berechnung mit meinen Daten nicht möglich)</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>f6<span class="ot">&lt;-</span><span class="fu">fitdist</span>(umwelt<span class="sc">$</span>Total,<span class="st">"logis"</span>)  <span class="co"># logistisch</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>f7<span class="ot">&lt;-</span><span class="fu">fitdist</span>(umwelt<span class="sc">$</span>Total,<span class="st">"geom"</span>)  <span class="co"># geometrisch</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># f8&lt;-fitdist(umwelt$Total,"weibull")  # Weibull (berechnung mit meinen Daten nicht möglich)</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fu">gofstat</span>(<span class="fu">list</span>(f1,f2,f3,f4,f6,f7), </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">fitnames =</span> <span class="fu">c</span>(<span class="st">"Normalverteilung"</span>, <span class="st">"Poisson"</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"negativ binomial"</span>,<span class="st">"exponentiell"</span>, <span class="st">"logistisch"</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"geometrisch"</span>))</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co"># die 2 besten (gemaess Akaike's Information Criterion) als Plot + normalverteilt, </span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>plot.legend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Normalverteilung"</span>, <span class="st">"exponentiell"</span>, <span class="st">"negativ binomial"</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co"># vergleicht mehrere theoretische Verteilungen mit den empirischen Daten</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cdfcomp</span>(<span class="fu">list</span>(f1, f4, f3), <span class="at">legendtext =</span> plot.legend)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="7_Multivariate_Statistik_Loesung_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --&gt; Verteilung ist gemäss AICc negativ binomial. --&gt; ich entscheide </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mich für letztere.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="aufgabe-6-multivariates-modell-berechnen" class="level1">
<h1>Aufgabe 6: Multivariates Modell berechnen</h1>
<div class="cell" data-layout-align="left">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.4 Berechne verschiedene Modelle ####</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Hinweise zu GLMM: https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ich verwende hier die Funktion glmer aus der Bibliothek lme4. glmer sei neuer, </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># schneller und zuverlaessiger als vergleichbare Funktionen.</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Die Totale Besucheranzahl soll durch verschiedene Parameter erklaert werden. </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Die saisonalitaet (KW, Jahr) soll hierbei nicht beachtet werden, </span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># sie wird als random Faktor bestimmt --&gt; Saisonbereinigung.</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Einfacher Start</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Auch wenn wir gerade herausgefunden haben, dass die Verteilung negativ binomial ist,</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># berechne ich für den Vergleich zuerst ein einfaches Modell der Familie poisson.</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>Tages_Model <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Total <span class="sc">~</span> Wochentag <span class="sc">+</span> Ferien <span class="sc">+</span> Phase <span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                       tre200jx_scaled <span class="sc">+</span> rre150j0_scaled <span class="sc">+</span> sremaxdv_scaled <span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">|</span>KW) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Jahr), <span class="at">family =</span> poisson, <span class="at">data =</span> umwelt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: Invalid grouping factor specification, KW</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Tages_Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'summary': object 'Tages_Model' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspektionsplots</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Tages_Model, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"smooth"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in plot(Tages_Model, type = c("p", "smooth")): object 'Tages_Model' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqmath</span>(Tages_Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in qqmath(Tages_Model): object 'Tages_Model' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pruefe auf Overdispersion</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersion_glmer</span>(Tages_Model) <span class="co">#it shouldn't be over 1.4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in resid(modelglmer): object 'Tages_Model' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wir gut erklaert das Modell?</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(Tages_Model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in r.squaredGLMM(Tages_Model): object 'Tages_Model' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Berechne ein negativ binomiales Modell</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># gemäss AICc die beste Verteilung</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Tages_Model_nb <span class="ot">&lt;-</span> <span class="fu">glmer.nb</span>(Total <span class="sc">~</span> Wochentag <span class="sc">+</span> Ferien <span class="sc">+</span> Phase <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                             tre200jx_scaled <span class="sc">+</span> rre150j0_scaled <span class="sc">+</span> sremaxdv_scaled <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                             (<span class="dv">1</span><span class="sc">|</span>KW) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Jahr), <span class="at">data =</span> umwelt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: Invalid grouping factor specification, KW</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Tages_Model_nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'summary': object 'Tages_Model_nb' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Tages_Model_nb, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"smooth"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in plot(Tages_Model_nb, type = c("p", "smooth")): object 'Tages_Model_nb' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqmath</span>(Tages_Model_nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in qqmath(Tages_Model_nb): object 'Tages_Model_nb' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersion_glmer</span>(Tages_Model_nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in resid(modelglmer): object 'Tages_Model_nb' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(Tages_Model_nb) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in r.squaredGLMM(Tages_Model_nb): object 'Tages_Model_nb' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># auf quadratischen Term testen ("es gehen weniger Leute in den Wald, wenn es zu heiss ist")</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>Tages_Model_nb_quad <span class="ot">&lt;-</span> <span class="fu">glmer.nb</span>(Total <span class="sc">~</span> Wochentag <span class="sc">+</span> Ferien <span class="sc">+</span> Phase <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                                  tre200jx_scaled <span class="sc">+</span> <span class="fu">I</span>(tre200jx_scaled<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                                  rre150j0_scaled <span class="sc">+</span> sremaxdv_scaled <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                                  (<span class="dv">1</span><span class="sc">|</span>KW) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Jahr), <span class="at">data =</span> umwelt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: Invalid grouping factor specification, KW</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Tages_Model_nb_quad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'summary': object 'Tages_Model_nb_quad' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Tages_Model_nb_quad, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"smooth"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in plot(Tages_Model_nb_quad, type = c("p", "smooth")): object 'Tages_Model_nb_quad' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqmath</span>(Tages_Model_nb_quad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in qqmath(Tages_Model_nb_quad): object 'Tages_Model_nb_quad' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersion_glmer</span>(Tages_Model_nb_quad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in resid(modelglmer): object 'Tages_Model_nb_quad' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(Tages_Model_nb_quad) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in r.squaredGLMM(Tages_Model_nb_quad): object 'Tages_Model_nb_quad' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interaktion testen, da Ferien und / oder Wochentage einen Einfluss auf</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># die Besuchszahlen waehrend des Lockown haben koennen!</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (Achtung: Rechenintensiv!)</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tages_Model_nb_int &lt;- glmer.nb(Anzahl_Total ~  Wochentag  * Ferien + Phase +</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  tre200jx_scaled + I(tre200jx_scaled^2) * </span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  rre150j0_scaled + sremaxdv_scaled +</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  (1|KW) + (1|Jahr), data = umwelt)</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(Tages_Model_nb_int)</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(Tages_Model_nb_int, type = c("p", "smooth"))</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="co"># qqmath(Tages_Model_nb_int)</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="co"># dispersion_glmer(Tages_Model_nb_int)</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co"># r.squaredGLMM(Tages_Model_nb_int) </span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Vergleich der Modellguete mittels AICc</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>cand.models<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>cand.models[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> Tages_Model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'Tages_Model' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>cand.models[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> Tages_Model_nb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'Tages_Model_nb' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>cand.models[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> Tages_Model_nb_quad</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'Tages_Model_nb_quad' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>Modnames<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Tages_Model"</span>,<span class="st">"Tages_Model_nb"</span>, </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Tages_Model_nb_quad"</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(<span class="at">cand.set=</span>cand.models,<span class="at">modnames=</span>Modnames)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `$&lt;-.data.frame`(`*tmp*`, "Delta_AICc", value = numeric(0)): replacement has 0 rows, data has 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#K = Anzahl geschaetzter Parameter (2 Funktionsparameter und die Varianz)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Delta_AICc &lt;2 = Statistisch gleichwertig</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">#AICcWt =  Akaike weight in %</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># --&gt; Ich entscheide mich bei diesen drei Modellen für das Tages_Model_nb_quad</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Warum: statistisch gleichwertig und ich denke die Quadratur macht Sinn!</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Berechne ein Modell mit exponentieller Verteilung:</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># gemäss AICc der Verteilung die zweitbeste</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.stackexchange.com/questions/240455/fitting-exponential-regression-model-by-mle</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>Tages_Model_exp <span class="ot">&lt;-</span> <span class="fu">glmer</span>((Total<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span> Wochentag <span class="sc">+</span> Ferien <span class="sc">+</span> Phase <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>                           tre200jx_scaled <span class="sc">+</span> rre150j0_scaled <span class="sc">+</span> sremaxdv_scaled <span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>                           (<span class="dv">1</span><span class="sc">|</span>KW) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Jahr), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span><span class="st">"log"</span>), <span class="at">data =</span> umwelt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: Invalid grouping factor specification, KW</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Tages_Model_exp, <span class="at">dispersion=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'summary': object 'Tages_Model_exp' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspektionsplots</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Tages_Model_exp, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"smooth"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in plot(Tages_Model_exp, type = c("p", "smooth")): object 'Tages_Model_exp' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqmath</span>(Tages_Model_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in qqmath(Tages_Model_exp): object 'Tages_Model_exp' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pruefe auf Overdispersion</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersion_glmer</span>(Tages_Model_exp) <span class="co">#it shouldn't be over 1.4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in resid(modelglmer): object 'Tages_Model_exp' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wir gut erklaert das Modell?</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(Tages_Model_exp) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in r.squaredGLMM(Tages_Model_exp): object 'Tages_Model_exp' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --&gt; Die zweitbeste Verteilung (exp) führt auch nicht dazu, dass die Modellvoraussetzungen besser</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># erfüllt werden</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.5 Transformationen ####</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Die Modellvoraussetzungen waren überall mehr oder weniger verletzt.</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Das ist ein Problem, allerdings auch nicht ein so grosses.</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># (man sollte es aber trotzdem ernst nehmen)</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Schielzeth et al. Robustness of linear mixed‐effects models to violations of distributional assumptions</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co"># https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.13434</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Lo and Andrews, To transform or not to transform: using generalized linear mixed models to analyse reaction time data</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.frontiersin.org/articles/10.3389/fpsyg.2015.01171/full</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="co"># die Lösung ist nun, die Daten zu transformieren:</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="co"># mehr unter: https://www.datanovia.com/en/lessons/transform-data-to-normal-distribution-in-r/</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="co"># berechne skewness coefficient </span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(umwelt<span class="sc">$</span>Total)</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="co"># A positive value means the distribution is positively skewed (rechtsschief).</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a><span class="co"># The most frequent values are low; tail is toward the high values (on the right-hand side)</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a><span class="co"># log 10, da stark rechtsschief</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>Tages_Model_quad_Jahr_log10 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log10</span>(Total<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span> Wochentag <span class="sc">+</span> Ferien <span class="sc">+</span> Phase <span class="sc">+</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>                                             tre200jx_scaled <span class="sc">+</span> <span class="fu">I</span>(tre200jx_scaled<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>                                             rre150j0_scaled <span class="sc">+</span> sremaxdv_scaled <span class="sc">+</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>                                             (<span class="dv">1</span><span class="sc">|</span>KW) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Jahr), <span class="at">data =</span> umwelt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in lme4::lFormula(formula = log10(Total + 1) ~ Wochentag + Ferien + : 0 (non-NA) cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Tages_Model_quad_Jahr_log10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'summary': object 'Tages_Model_quad_Jahr_log10' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Tages_Model_quad_Jahr_log10, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"smooth"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in plot(Tages_Model_quad_Jahr_log10, type = c("p", "smooth")): object 'Tages_Model_quad_Jahr_log10' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqmath</span>(Tages_Model_quad_Jahr_log10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in qqmath(Tages_Model_quad_Jahr_log10): object 'Tages_Model_quad_Jahr_log10' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersion_glmer</span>(Tages_Model_quad_Jahr_log10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in resid(modelglmer): object 'Tages_Model_quad_Jahr_log10' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(Tages_Model_quad_Jahr_log10) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in r.squaredGLMM(Tages_Model_quad_Jahr_log10): object 'Tages_Model_quad_Jahr_log10' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lmer zeigt keine p-Werte, da diese schwer zu berechnen sind. Alternative Packages berechnen diese</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co"># anhand der Teststatistik. Achtung: die Werte sind wahrscheinlich nicht präzise!</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stat.ethz.ch/pipermail/r-sig-mixed-models/2008q2/000904.html</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">transform =</span> <span class="cn">NULL</span>, <span class="at">show.se =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in tab_model(Tages_Model_quad_Jahr_log10, transform = NULL, show.se = TRUE): object 'Tages_Model_quad_Jahr_log10' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># natural log, da stark rechtsschief</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>Tages_Model_quad_Jahr_ln <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(Total<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span> Wochentag <span class="sc">+</span> Ferien <span class="sc">+</span> Phase <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                                          tre200jx_scaled <span class="sc">+</span> <span class="fu">I</span>(tre200jx_scaled<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>                                          rre150j0_scaled <span class="sc">+</span> sremaxdv_scaled <span class="sc">+</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                                          (<span class="dv">1</span><span class="sc">|</span>KW) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Jahr), <span class="at">data =</span> umwelt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in lme4::lFormula(formula = log(Total + 1) ~ Wochentag + Ferien + : 0 (non-NA) cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Tages_Model_quad_Jahr_ln)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in h(simpleError(msg, call)): error in evaluating the argument 'object' in selecting a method for function 'summary': object 'Tages_Model_quad_Jahr_ln' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Tages_Model_quad_Jahr_ln, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"smooth"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in plot(Tages_Model_quad_Jahr_ln, type = c("p", "smooth")): object 'Tages_Model_quad_Jahr_ln' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqmath</span>(Tages_Model_quad_Jahr_ln)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in qqmath(Tages_Model_quad_Jahr_ln): object 'Tages_Model_quad_Jahr_ln' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersion_glmer</span>(Tages_Model_quad_Jahr_ln)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in resid(modelglmer): object 'Tages_Model_quad_Jahr_ln' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(Tages_Model_quad_Jahr_ln) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in r.squaredGLMM(Tages_Model_quad_Jahr_ln): object 'Tages_Model_quad_Jahr_ln' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --&gt; Die Modellvoraussetzungen sind deutlich besser erfüllt jetzt wo wir Transformationen </span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># benutzt haben. log10 und ln performen beide gleich gut. Da log10 in meinem Bsp</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co"># aber deutlich mehr der Varianz erklärt, entscheide ich mich schliesslich für dieses Modell.</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Zusatz: ACHTUNG - Ruecktransformierte Regressionskoeffizienten zu erlangen (fuer die Interpretation, das Plotten), </span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ist zudem nicht moeglich (Regressionskoeffizienten sind nur im transformierten Raum linear). </span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ein ruecktransformierter Regressionskoeffiziente haette eine nicht-lineare Beziehung mit der </span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="co"># abhaengigen Variable.</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.6 Exportiere die Modellresultate ####</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="co"># (des besten Modells)</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">transform =</span> <span class="cn">NULL</span>, <span class="at">show.se =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in tab_model(Tages_Model_quad_Jahr_log10, transform = NULL, show.se = TRUE): object 'Tages_Model_quad_Jahr_log10' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The marginal R squared values are those associated with your fixed effects, </span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the conditional ones are those of your fixed effects plus the random effects. </span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Usually we will be interested in the marginal effects.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="aufgabe-7-modellvisualisierung" class="level1">
<h1>Aufgabe 7: Modellvisualisierung</h1>
<div class="cell" data-layout-align="left">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.7 Visualisiere Modellresultate ####</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ZUSATZ: Wir haben die Wetterparameter skaliert. </span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fuer die Plots muss das beruecksichtigt werden: wir stellen nicht die wirklichen Werte</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dar sondern die skalierten. Mit folgendem Befehl kann man die Skalierung nachvollziehen:</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co"># attributes(umwelt$tre200jx_scaled)</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Die Skalierung kann rueckgaengig gemacht werden, indem man die Skalierten werte mit</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="co"># dem scaling factor multipliziert und dann den Durchschnitt addiert:</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Bsp.: d$s.x * attr(d$s.x, 'scaled:scale') + attr(d$s.x, 'scaled:center')</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="co"># mehr dazu: https://stackoverflow.com/questions/10287545/backtransform-scale-for-plotting</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a><span class="co"># --&gt; wir bleiben aber bei den skalierten Werten, leben damit und sind uns dessen bewusst.</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Auch beim Plotten der Modellresultate gilt: </span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a><span class="co"># visualisiere nur die Parameter welche nach der Modellselektion uebig bleiben</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a><span class="co"># und signifikant sind!</span></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model / type = "pred" sagt die Werte "voraus"</span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a><span class="co"># achte auf gleiche Skalierung der y-Achse (Vergleichbarkeit)</span></span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperatur</span></span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> </span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"tre200jx_scaled [all]"</span>, <span class="co"># [all] = Model contains polynomial or cubic / </span></span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>                <span class="co">#quadratic terms. Consider using `terms="tre200jx_scaled [all]"` </span></span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a>                <span class="co"># to get smooth plots. See also package-vignette </span></span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 'Marginal Effects at Specific Values'.</span></span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">""</span>, <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Tagesmaximaltemperatur [°C]"</span>, </span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Fussgaenger:innen pro Tag [log]"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in insight::model_info(model): object 'Tages_Model_quad_Jahr_log10' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fuege die Achsenbeschriftung hinzu. Hier wird auf die unskalierten Werte zugegriffen.</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">floor</span>(<span class="fu">min</span>(umwelt<span class="sc">$</span>tre200jx)), <span class="fu">ceiling</span>(<span class="fu">max</span>(umwelt<span class="sc">$</span>tre200jx)),</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># length.out = ___ --&gt; Anpassen gemaess breaks auf dem Plot</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">length.out =</span> <span class="dv">5</span>), <span class="dv">0</span>) </span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>(Tempplot <span class="ot">&lt;-</span> t <span class="sc">+</span> </span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), </span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(labels))<span class="sc">+</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fuege die y- Achsenbeschriftung hinzu. Hier transformieren wir die Werte zurueck</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>),</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">0</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">0.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">1.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>),<span class="dv">0</span>),</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>))</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("temp.png", width=15, height=15, units="cm", dpi=1000, </span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/") </span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Regen</span></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="st">"rre150j0_scaled"</span>, </span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">""</span>, <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Halbtagessumme Niederschlag [mm]"</span>, </span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Fussgaenger:innen pro Tag [log]"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in insight::model_info(model): object 'Tages_Model_quad_Jahr_log10' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">floor</span>(<span class="fu">min</span>(umwelt<span class="sc">$</span>rre150j0)), <span class="fu">ceiling</span>(<span class="fu">max</span>(umwelt<span class="sc">$</span>rre150j0)),</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">0</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>(t <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">12</span>), <span class="at">labels =</span> <span class="fu">c</span>(labels))<span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>),</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">0</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">0.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">1.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>),<span class="dv">0</span>),</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>))</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("rain.png", width=15, height=15, units="cm", dpi=1000, </span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/") </span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Sonne</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="st">"sremaxdv_scaled"</span>, </span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">""</span>, <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Sonnenscheindauer [min]"</span>, </span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Fussgaenger:innen pro Tag [log]"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in insight::model_info(model): object 'Tages_Model_quad_Jahr_log10' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">floor</span>(<span class="fu">min</span>(umwelt<span class="sc">$</span>sremaxdv)), <span class="fu">ceiling</span>(<span class="fu">max</span>(umwelt<span class="sc">$</span>sremaxdv)),</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">length.out =</span> <span class="dv">3</span>), <span class="dv">0</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>(t <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(labels))<span class="sc">+</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>),</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">0</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">0.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">1.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>),<span class="dv">0</span>),</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>))</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("sun.png", width=15, height=15, units="cm", dpi=1000, </span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/") </span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Phase</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="st">"Phase"</span>, </span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">""</span>, <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Phase"</span>, </span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Fussgaenger:innen pro Tag [log]"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in insight::model_info(model): object 'Tages_Model_quad_Jahr_log10' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>(lockplot <span class="ot">&lt;-</span> t <span class="sc">+</span> </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>),</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">0</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">0.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">1.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>),<span class="dv">0</span>),</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>))</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("phase.png", width=15, height=15, units="cm", dpi=1000, </span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/") </span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Ferien</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="st">"Ferien"</span>, </span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">""</span>, <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Ferien"</span>, </span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Fussgaenger:innen pro Tag [log]"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in insight::model_info(model): object 'Tages_Model_quad_Jahr_log10' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>(ferienplot <span class="ot">&lt;-</span> t <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Nein"</span>, <span class="st">"Ja"</span>))<span class="sc">+</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>),</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">0</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">0.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">1.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>),<span class="dv">0</span>),</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>))</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("ferien.png", width=15, height=15, units="cm", dpi=1000, </span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/") </span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Wochentag</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="st">"Wochentag"</span>, </span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">""</span>, <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Wochentag"</span>, <span class="st">"Fussgaenger:innen pro Tag [log]"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in insight::model_info(model): object 'Tages_Model_quad_Jahr_log10' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>(wdplot <span class="ot">&lt;-</span> t <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>),</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">labels =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">0</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">0.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">1.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>),<span class="dv">0</span>),</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("wd.png", width=15, height=15, units="cm", dpi=1000, </span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/") </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../fallstudie_s/6_Desktiptive_Analysen_Loesung.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">6. Lösung</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../fallstudie_s/7_Multivariate_Statistik_Uebung.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">7. Übung</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb105" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># 7. Lösung</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>{{&lt; include /../_before-article.qmd &gt;}}</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">message =</span> <span class="cn">FALSE</span>, <span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">results =</span> <span class="st">"hide"</span>, <span class="at">fig.align=</span><span class="st">"left"</span>)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include = FALSE}</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="co">#.################################################################################################</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Einfluss von COID19 auf die Besucherzahlen im WPZ ####</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Modul Research Methods, HS21. Adrian Hochreutener ####</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="co">#.################################################################################################</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="co">#.################################################################################################</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a><span class="co"># METADATA UND DEFINITIONEN ####</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a><span class="co">#.################################################################################################</span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a><span class="co"># save and load workspace</span></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a><span class="co"># save.image(file = "fallstudien/_R_analysis/results/my_work_space.RData")</span></span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a><span class="co"># load(file = "fallstudien/_R_analysis/results/my_work_space.RData")</span></span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Datenherkunft ####</span></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Saemtliche verwendeten Zaehdaten sind Eigentum des Wildnispark Zuerich und duerfen nur im Rahmen </span></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a><span class="co"># des Moduls verwendet werden. Sie sind vertraulich zu behandeln.</span></span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Die Meteodaten sind Eigentum von MeteoSchweiz.</span></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Verwendete Meteodaten</span></span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Lufttemperatur 2 m UEber Boden; Tagmaximum (6 UTC blis 18 UTC), tre200jx [°C ]</span></span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Niederschlag; Halbtagessumme 6 UTC - 18 UTC, rre150j0 [mm]</span></span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Sonnenscheindauer; Tagessumme, sre000d0 [min]</span></span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordnerstruktur ####</span></span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Im Ordner in dem das R-Projekt abgelegt ist muessen folgende Unterordner bestehen:</span></span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a><span class="co"># - data (Rohdaten hier ablegen)</span></span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a><span class="co"># - results</span></span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a><span class="co"># - results_compare</span></span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a><span class="co"># - scripts</span></span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Benoetigte Bibliotheken ####</span></span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># Data wrangling und piping</span></span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># Arbeiten mit Datumsformaten</span></span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)<span class="co"># schnelles Dateneinlesen</span></span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)    <span class="co"># to arrange multiple plots in one graph</span></span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PerformanceAnalytics) <span class="co"># Plotte Korrelationsmatrix</span></span>
<span id="cb105-46"><a href="#cb105-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)     <span class="co"># Multi-Model Inference</span></span>
<span id="cb105-47"><a href="#cb105-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)<span class="co"># Modellaverageing</span></span>
<span id="cb105-48"><a href="#cb105-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fitdistrplus)<span class="co"># Prueft die Verteilung in Daten</span></span>
<span id="cb105-49"><a href="#cb105-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)      <span class="co"># Multivariate Modelle</span></span>
<span id="cb105-50"><a href="#cb105-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(blmeco)    <span class="co"># Bayesian data analysis using linear models</span></span>
<span id="cb105-51"><a href="#cb105-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)    <span class="co"># Plotten von Modellergebnissen (tab_model)</span></span>
<span id="cb105-52"><a href="#cb105-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)   <span class="co"># einfaches plotten von Zusammenhängen zwischen Variablen</span></span>
<span id="cb105-53"><a href="#cb105-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-54"><a href="#cb105-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Start und Ende ####</span></span>
<span id="cb105-55"><a href="#cb105-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Untersuchungszeitraum, ich waehle hier das Jahr 2019 bis und mit Sommer 2021</span></span>
<span id="cb105-56"><a href="#cb105-56" aria-hidden="true" tabindex="-1"></a>depo_start <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2019-01-01"</span>)</span>
<span id="cb105-57"><a href="#cb105-57" aria-hidden="true" tabindex="-1"></a>depo_end <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2021-7-27"</span>)</span>
<span id="cb105-58"><a href="#cb105-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-59"><a href="#cb105-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Start und Ende Lockdown</span></span>
<span id="cb105-60"><a href="#cb105-60" aria-hidden="true" tabindex="-1"></a><span class="co"># definieren, wichtig fuer die spaeteren Auswertungen</span></span>
<span id="cb105-61"><a href="#cb105-61" aria-hidden="true" tabindex="-1"></a>lock_1_start_2020 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-03-16"</span>)</span>
<span id="cb105-62"><a href="#cb105-62" aria-hidden="true" tabindex="-1"></a>lock_1_end_2020 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-05-11"</span>)</span>
<span id="cb105-63"><a href="#cb105-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-64"><a href="#cb105-64" aria-hidden="true" tabindex="-1"></a>lock_2_start_2021 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-12-22"</span>)</span>
<span id="cb105-65"><a href="#cb105-65" aria-hidden="true" tabindex="-1"></a>lock_2_end_2021 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2021-03-01"</span>)</span>
<span id="cb105-66"><a href="#cb105-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-67"><a href="#cb105-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Ebenfalls muessen die erste und letzte Kalenderwoche der Untersuchungsfrist definiert werden</span></span>
<span id="cb105-68"><a href="#cb105-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Diese werden bei Wochenweisen Analysen ebenfalls ausgeklammert da sie i.d.R. unvollstaendig sind</span></span>
<span id="cb105-69"><a href="#cb105-69" aria-hidden="true" tabindex="-1"></a>KW_start <span class="ot">&lt;-</span> <span class="fu">week</span>(depo_start)</span>
<span id="cb105-70"><a href="#cb105-70" aria-hidden="true" tabindex="-1"></a>KW_end <span class="ot">&lt;-</span> <span class="fu">week</span>(depo_end)</span>
<span id="cb105-71"><a href="#cb105-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-72"><a href="#cb105-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Erster und letzter Tag der Ferien</span></span>
<span id="cb105-73"><a href="#cb105-73" aria-hidden="true" tabindex="-1"></a><span class="co"># je nach Untersuchungsdauer muessen hier weitere oder andere Ferienzeiten ergaenzt werden</span></span>
<span id="cb105-74"><a href="#cb105-74" aria-hidden="true" tabindex="-1"></a><span class="co"># (https://www.schulferien.org/schweiz/ferien/2020/)</span></span>
<span id="cb105-75"><a href="#cb105-75" aria-hidden="true" tabindex="-1"></a>Fruehlingsferien_2019_start <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2019-04-13"</span>)</span>
<span id="cb105-76"><a href="#cb105-76" aria-hidden="true" tabindex="-1"></a>Fruehlingsferien_2019_ende <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2019-04-28"</span>)</span>
<span id="cb105-77"><a href="#cb105-77" aria-hidden="true" tabindex="-1"></a>Sommerferien_2019_start <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2019-07-6"</span>)</span>
<span id="cb105-78"><a href="#cb105-78" aria-hidden="true" tabindex="-1"></a>Sommerferien_2019_ende <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2019-08-18"</span>)</span>
<span id="cb105-79"><a href="#cb105-79" aria-hidden="true" tabindex="-1"></a>Herbstferien_2019_start <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2019-10-05"</span>)</span>
<span id="cb105-80"><a href="#cb105-80" aria-hidden="true" tabindex="-1"></a>Herbstferien_2019_ende <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2019-10-20"</span>)</span>
<span id="cb105-81"><a href="#cb105-81" aria-hidden="true" tabindex="-1"></a>Winterferien_2019_start <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2019-12-21"</span>)</span>
<span id="cb105-82"><a href="#cb105-82" aria-hidden="true" tabindex="-1"></a>Winterferien_2019_ende <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-01-02"</span>)</span>
<span id="cb105-83"><a href="#cb105-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-84"><a href="#cb105-84" aria-hidden="true" tabindex="-1"></a>Fruehlingsferien_2020_start <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-04-11"</span>)</span>
<span id="cb105-85"><a href="#cb105-85" aria-hidden="true" tabindex="-1"></a>Fruehlingsferien_2020_ende <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-04-26"</span>)</span>
<span id="cb105-86"><a href="#cb105-86" aria-hidden="true" tabindex="-1"></a>Sommerferien_2020_start <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-07-11"</span>)</span>
<span id="cb105-87"><a href="#cb105-87" aria-hidden="true" tabindex="-1"></a>Sommerferien_2020_ende <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-08-16"</span>)</span>
<span id="cb105-88"><a href="#cb105-88" aria-hidden="true" tabindex="-1"></a>Herbstferien_2020_start <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-10-03"</span>)</span>
<span id="cb105-89"><a href="#cb105-89" aria-hidden="true" tabindex="-1"></a>Herbstferien_2020_ende <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-10-18"</span>)</span>
<span id="cb105-90"><a href="#cb105-90" aria-hidden="true" tabindex="-1"></a>Winterferien_2020_start <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2020-12-19"</span>)</span>
<span id="cb105-91"><a href="#cb105-91" aria-hidden="true" tabindex="-1"></a>Winterferien_2020_ende <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2021-01-03"</span>)</span>
<span id="cb105-92"><a href="#cb105-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-93"><a href="#cb105-93" aria-hidden="true" tabindex="-1"></a>Fruehlingsferien_2021_start <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2021-04-24"</span>)</span>
<span id="cb105-94"><a href="#cb105-94" aria-hidden="true" tabindex="-1"></a>Fruehlingsferien_2021_ende <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2021-05-09"</span>)</span>
<span id="cb105-95"><a href="#cb105-95" aria-hidden="true" tabindex="-1"></a>Sommerferien_2021_start <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2021-07-17"</span>)</span>
<span id="cb105-96"><a href="#cb105-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-97"><a href="#cb105-97" aria-hidden="true" tabindex="-1"></a><span class="co">#.################################################################################################</span></span>
<span id="cb105-98"><a href="#cb105-98" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. DATENIMPORT #####</span></span>
<span id="cb105-99"><a href="#cb105-99" aria-hidden="true" tabindex="-1"></a><span class="co">#.################################################################################################</span></span>
<span id="cb105-100"><a href="#cb105-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-101"><a href="#cb105-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Beim Daten einlesen koennen sogleich die Datentypen und erste Bereinigungen vorgenommen werden</span></span>
<span id="cb105-102"><a href="#cb105-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-103"><a href="#cb105-103" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.1 Zaehldaten ####</span></span>
<span id="cb105-104"><a href="#cb105-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Die Zaehldaten des Wildnispark wurden vorgaengig bereinigt. z.B. wurden Stundenwerte </span></span>
<span id="cb105-105"><a href="#cb105-105" aria-hidden="true" tabindex="-1"></a><span class="co"># entfernt, an denen am Zaehler Wartungsarbeiten stattgefunden haben.</span></span>
<span id="cb105-106"><a href="#cb105-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-107"><a href="#cb105-107" aria-hidden="true" tabindex="-1"></a><span class="co"># lese die Daten mithilfe der Bibliothek data.table ein (alternative zu read_csv und dergleichen). </span></span>
<span id="cb105-108"><a href="#cb105-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Je nach Bedarf muss der Speicherort sowie der Dateiname angepasst werden</span></span>
<span id="cb105-109"><a href="#cb105-109" aria-hidden="true" tabindex="-1"></a>depo <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"211_sihlwaldstrasse_2017_2021.csv"</span>))</span>
<span id="cb105-110"><a href="#cb105-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-111"><a href="#cb105-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Hinweis zu den Daten:</span></span>
<span id="cb105-112"><a href="#cb105-112" aria-hidden="true" tabindex="-1"></a><span class="co"># In hourly analysis format, the data at 11:00 am corresponds to the counts saved between </span></span>
<span id="cb105-113"><a href="#cb105-113" aria-hidden="true" tabindex="-1"></a><span class="co"># 11:00 am and 12:00 am.</span></span>
<span id="cb105-114"><a href="#cb105-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-115"><a href="#cb105-115" aria-hidden="true" tabindex="-1"></a><span class="co"># Anpassen der Datentypen und erstes Sichten</span></span>
<span id="cb105-116"><a href="#cb105-116" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(depo)</span>
<span id="cb105-117"><a href="#cb105-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-118"><a href="#cb105-118" aria-hidden="true" tabindex="-1"></a>depo <span class="ot">&lt;-</span> depo <span class="sc">%&gt;%</span></span>
<span id="cb105-119"><a href="#cb105-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Datum_Uhrzeit =</span> <span class="fu">as.character</span>(DatumUhrzeit)) <span class="sc">%&gt;%</span></span>
<span id="cb105-120"><a href="#cb105-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Datum_Uhrzeit, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"Datum"</span>, <span class="st">"Zeit"</span>), <span class="at">sep =</span> <span class="st">" "</span>)<span class="sc">%&gt;%</span></span>
<span id="cb105-121"><a href="#cb105-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Datum =</span> <span class="fu">as.Date</span>(Datum, <span class="at">format =</span> <span class="st">"%d.%m.%Y"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb105-122"><a href="#cb105-122" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Schneide das df auf den gewuenschten Zeitraum zu</span></span>
<span id="cb105-123"><a href="#cb105-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Datum <span class="sc">&gt;=</span> depo_start, Datum <span class="sc">&lt;=</span>  depo_end) <span class="co"># das Komma hat die gleiche Funktion wie ein &amp;</span></span>
<span id="cb105-124"><a href="#cb105-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-125"><a href="#cb105-125" aria-hidden="true" tabindex="-1"></a><span class="co"># In dieser Auswertung werden nur Velos betrachtet!</span></span>
<span id="cb105-126"><a href="#cb105-126" aria-hidden="true" tabindex="-1"></a>depo <span class="ot">&lt;-</span> depo[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>), drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># mit diesem Befehl lassen wir Spalten "fallen", </span></span>
<span id="cb105-127"><a href="#cb105-127" aria-hidden="true" tabindex="-1"></a>                                     <span class="co"># aendern aber nichts an der Form des data.frames</span></span>
<span id="cb105-128"><a href="#cb105-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-129"><a href="#cb105-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Berechnen des Totals, da dieses in den Daten nicht vorhanden ist</span></span>
<span id="cb105-130"><a href="#cb105-130" aria-hidden="true" tabindex="-1"></a>depo <span class="ot">&lt;-</span> depo<span class="sc">%&gt;%</span></span>
<span id="cb105-131"><a href="#cb105-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Total =</span> Fuss_IN <span class="sc">+</span> Fuss_OUT)</span>
<span id="cb105-132"><a href="#cb105-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-133"><a href="#cb105-133" aria-hidden="true" tabindex="-1"></a><span class="co"># Entferne die NA's in dem df.</span></span>
<span id="cb105-134"><a href="#cb105-134" aria-hidden="true" tabindex="-1"></a>depo <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(depo)</span>
<span id="cb105-135"><a href="#cb105-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-136"><a href="#cb105-136" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.2 Meteodaten ####</span></span>
<span id="cb105-137"><a href="#cb105-137" aria-hidden="true" tabindex="-1"></a><span class="co"># Einlesen</span></span>
<span id="cb105-138"><a href="#cb105-138" aria-hidden="true" tabindex="-1"></a>meteo <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"order_97149_data.txt"</span>))</span>
<span id="cb105-139"><a href="#cb105-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-140"><a href="#cb105-140" aria-hidden="true" tabindex="-1"></a><span class="co"># Datentypen setzen</span></span>
<span id="cb105-141"><a href="#cb105-141" aria-hidden="true" tabindex="-1"></a><span class="co"># Das Datum wird als Integer erkannt. Zuerst muss es in Text umgewaldelt werden aus dem dann</span></span>
<span id="cb105-142"><a href="#cb105-142" aria-hidden="true" tabindex="-1"></a><span class="co"># das eigentliche Datum herausgelesen werden kann</span></span>
<span id="cb105-143"><a href="#cb105-143" aria-hidden="true" tabindex="-1"></a>meteo <span class="ot">&lt;-</span> <span class="fu">transform</span>(meteo, <span class="at">time =</span> <span class="fu">as.Date</span>(<span class="fu">as.character</span>(time), <span class="st">"%Y%m%d"</span>))</span>
<span id="cb105-144"><a href="#cb105-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-145"><a href="#cb105-145" aria-hidden="true" tabindex="-1"></a><span class="co"># Die eigentlichen Messwerte sind alle nummerisch</span></span>
<span id="cb105-146"><a href="#cb105-146" aria-hidden="true" tabindex="-1"></a>meteo <span class="ot">&lt;-</span> meteo<span class="sc">%&gt;%</span></span>
<span id="cb105-147"><a href="#cb105-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tre200jx =</span> <span class="fu">as.numeric</span>(tre200jx))<span class="sc">%&gt;%</span></span>
<span id="cb105-148"><a href="#cb105-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rre150j0 =</span> <span class="fu">as.numeric</span>(rre150j0))<span class="sc">%&gt;%</span></span>
<span id="cb105-149"><a href="#cb105-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sremaxdv =</span> <span class="fu">as.numeric</span>(sremaxdv)) <span class="sc">%&gt;%</span> </span>
<span id="cb105-150"><a href="#cb105-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">&gt;=</span> depo_start, time <span class="sc">&lt;=</span>  depo_end) <span class="co"># schneide dann auf Untersuchungsdauer</span></span>
<span id="cb105-151"><a href="#cb105-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-152"><a href="#cb105-152" aria-hidden="true" tabindex="-1"></a><span class="co"># Was ist eigentlich Niederschlag:</span></span>
<span id="cb105-153"><a href="#cb105-153" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.meteoschweiz.admin.ch/home/wetter/wetterbegriffe/niederschlag.html</span></span>
<span id="cb105-154"><a href="#cb105-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-155"><a href="#cb105-155" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtere Werte mit NA</span></span>
<span id="cb105-156"><a href="#cb105-156" aria-hidden="true" tabindex="-1"></a>meteo <span class="ot">&lt;-</span> meteo <span class="sc">%&gt;%</span></span>
<span id="cb105-157"><a href="#cb105-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(stn)) <span class="sc">%&gt;%</span></span>
<span id="cb105-158"><a href="#cb105-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(time))<span class="sc">%&gt;%</span></span>
<span id="cb105-159"><a href="#cb105-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(tre200jx))<span class="sc">%&gt;%</span></span>
<span id="cb105-160"><a href="#cb105-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(rre150j0))<span class="sc">%&gt;%</span></span>
<span id="cb105-161"><a href="#cb105-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sremaxdv))</span>
<span id="cb105-162"><a href="#cb105-162" aria-hidden="true" tabindex="-1"></a><span class="co"># Pruefe ob alles funktioniert hat</span></span>
<span id="cb105-163"><a href="#cb105-163" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(meteo)</span>
<span id="cb105-164"><a href="#cb105-164" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(meteo)) <span class="co"># zeigt die Anzahl NA's im data.frame an</span></span>
<span id="cb105-165"><a href="#cb105-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-166"><a href="#cb105-166" aria-hidden="true" tabindex="-1"></a><span class="co">#.################################################################################################</span></span>
<span id="cb105-167"><a href="#cb105-167" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. VORBEREITUNG DER DATEN #####</span></span>
<span id="cb105-168"><a href="#cb105-168" aria-hidden="true" tabindex="-1"></a><span class="co">#.################################################################################################</span></span>
<span id="cb105-169"><a href="#cb105-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-170"><a href="#cb105-170" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.1 Convinience Variablen ####</span></span>
<span id="cb105-171"><a href="#cb105-171" aria-hidden="true" tabindex="-1"></a><span class="co"># fuege dem Dataframe (df) die Wochentage hinzu</span></span>
<span id="cb105-172"><a href="#cb105-172" aria-hidden="true" tabindex="-1"></a>depo <span class="ot">&lt;-</span> depo <span class="sc">%&gt;%</span> </span>
<span id="cb105-173"><a href="#cb105-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Wochentag =</span> <span class="fu">weekdays</span>(Datum)) <span class="sc">%&gt;%</span> </span>
<span id="cb105-174"><a href="#cb105-174" aria-hidden="true" tabindex="-1"></a>  <span class="co"># R sortiert die Levels aplhabetisch. Da das in unserem Fall aber sehr unpraktisch ist,</span></span>
<span id="cb105-175"><a href="#cb105-175" aria-hidden="true" tabindex="-1"></a>  <span class="co"># muessen die Levels manuell manuell bestimmt werden</span></span>
<span id="cb105-176"><a href="#cb105-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Wochentag =</span> base<span class="sc">::</span><span class="fu">factor</span>(Wochentag, </span>
<span id="cb105-177"><a href="#cb105-177" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Montag"</span>, <span class="st">"Dienstag"</span>, <span class="st">"Mittwoch"</span>, </span>
<span id="cb105-178"><a href="#cb105-178" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Donnerstag"</span>, <span class="st">"Freitag"</span>, <span class="st">"Samstag"</span>, <span class="st">"Sonntag"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb105-179"><a href="#cb105-179" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Werktag oder Wochenende hinzufuegen</span></span>
<span id="cb105-180"><a href="#cb105-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Wochenende =</span> <span class="fu">if_else</span>(Wochentag <span class="sc">==</span> <span class="st">"Montag"</span> <span class="sc">|</span> Wochentag <span class="sc">==</span> <span class="st">"Dienstag"</span> <span class="sc">|</span> </span>
<span id="cb105-181"><a href="#cb105-181" aria-hidden="true" tabindex="-1"></a>                           Wochentag <span class="sc">==</span> <span class="st">"Mittwoch"</span> <span class="sc">|</span> Wochentag <span class="sc">==</span> <span class="st">"Donnerstag"</span> <span class="sc">|</span> </span>
<span id="cb105-182"><a href="#cb105-182" aria-hidden="true" tabindex="-1"></a>                           Wochentag <span class="sc">==</span> <span class="st">"Freitag"</span>, <span class="st">"Werktag"</span>, <span class="st">"Wochenende"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb105-183"><a href="#cb105-183" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Kalenderwoche hinzufuegen</span></span>
<span id="cb105-184"><a href="#cb105-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">KW=</span> <span class="fu">week</span>(Datum))<span class="sc">%&gt;%</span></span>
<span id="cb105-185"><a href="#cb105-185" aria-hidden="true" tabindex="-1"></a>  <span class="co"># monat und Jahr</span></span>
<span id="cb105-186"><a href="#cb105-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Monat =</span> <span class="fu">month</span>(Datum)) <span class="sc">%&gt;%</span> </span>
<span id="cb105-187"><a href="#cb105-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Jahr =</span> <span class="fu">year</span>(Datum))</span>
<span id="cb105-188"><a href="#cb105-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-189"><a href="#cb105-189" aria-hidden="true" tabindex="-1"></a><span class="co">#Lockdown </span></span>
<span id="cb105-190"><a href="#cb105-190" aria-hidden="true" tabindex="-1"></a><span class="co"># Hinweis: ich mache das nachgelagert, da ich die Erfahrung hatte, dass zu viele </span></span>
<span id="cb105-191"><a href="#cb105-191" aria-hidden="true" tabindex="-1"></a><span class="co"># Operationen in einem Schritt auch schon mal durcheinander erzeugen koennen.</span></span>
<span id="cb105-192"><a href="#cb105-192" aria-hidden="true" tabindex="-1"></a><span class="co"># Hinweis II: Wir packen alle Phasen (normal, die beiden Lockdowns und Covid aber ohne Lockdown)</span></span>
<span id="cb105-193"><a href="#cb105-193" aria-hidden="true" tabindex="-1"></a><span class="co"># in eine Spalte --&gt; long ist schoener als wide</span></span>
<span id="cb105-194"><a href="#cb105-194" aria-hidden="true" tabindex="-1"></a>depo <span class="ot">&lt;-</span> depo <span class="sc">%&gt;%</span></span>
<span id="cb105-195"><a href="#cb105-195" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">Phase =</span> <span class="fu">if_else</span>(Datum <span class="sc">&gt;=</span> lock_1_start_2020 <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> lock_1_end_2020,</span>
<span id="cb105-196"><a href="#cb105-196" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Lockdown_1"</span>,</span>
<span id="cb105-197"><a href="#cb105-197" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(Datum <span class="sc">&gt;=</span> lock_2_start_2021 <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> lock_2_end_2021,</span>
<span id="cb105-198"><a href="#cb105-198" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Lockdown_2"</span>,</span>
<span id="cb105-199"><a href="#cb105-199" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">if_else</span>(Datum <span class="sc">&lt;</span> lock_1_start_2020,</span>
<span id="cb105-200"><a href="#cb105-200" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Normal"</span>, <span class="st">"Covid"</span>))))</span>
<span id="cb105-201"><a href="#cb105-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-202"><a href="#cb105-202" aria-hidden="true" tabindex="-1"></a><span class="co"># hat das gepklappt?!</span></span>
<span id="cb105-203"><a href="#cb105-203" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(depo<span class="sc">$</span>Phase)</span>
<span id="cb105-204"><a href="#cb105-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-205"><a href="#cb105-205" aria-hidden="true" tabindex="-1"></a><span class="co"># aendere die Datentypen</span></span>
<span id="cb105-206"><a href="#cb105-206" aria-hidden="true" tabindex="-1"></a>depo <span class="ot">&lt;-</span> depo <span class="sc">%&gt;%</span> </span>
<span id="cb105-207"><a href="#cb105-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Wochenende =</span> <span class="fu">as.factor</span>(Wochenende)) <span class="sc">%&gt;%</span> </span>
<span id="cb105-208"><a href="#cb105-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">KW =</span> <span class="fu">factor</span>(KW)) <span class="sc">%&gt;%</span> </span>
<span id="cb105-209"><a href="#cb105-209" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mit factor() koennen die levels direkt einfach selbst definiert werden.</span></span>
<span id="cb105-210"><a href="#cb105-210" aria-hidden="true" tabindex="-1"></a>  <span class="co"># wichtig: speizfizieren, dass aus R base, ansonsten kommt es zu einem </span></span>
<span id="cb105-211"><a href="#cb105-211" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mix-up mit anderen packages</span></span>
<span id="cb105-212"><a href="#cb105-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Phase =</span> base<span class="sc">::</span><span class="fu">factor</span>(Phase, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Normal"</span>, <span class="st">"Lockdown_1"</span>, <span class="st">"Lockdown_2"</span>, <span class="st">"Covid"</span>)))</span>
<span id="cb105-213"><a href="#cb105-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-214"><a href="#cb105-214" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(depo)</span>
<span id="cb105-215"><a href="#cb105-215" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-216"><a href="#cb105-216" aria-hidden="true" tabindex="-1"></a><span class="co"># Fuer einige Auswertungen muss auf die Stunden als nummerischer Wert zurueckgegriffen werden</span></span>
<span id="cb105-217"><a href="#cb105-217" aria-hidden="true" tabindex="-1"></a>depo<span class="sc">$</span>Stunde <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">as.POSIXct</span>(depo<span class="sc">$</span>Zeit,<span class="at">format=</span><span class="st">"%H:%M"</span>),<span class="st">"%H"</span>))</span>
<span id="cb105-218"><a href="#cb105-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-219"><a href="#cb105-219" aria-hidden="true" tabindex="-1"></a><span class="co"># Die Daten wurden kalibriert. Wir runden sie fuer unserer Analysen auf Ganzzahlen</span></span>
<span id="cb105-220"><a href="#cb105-220" aria-hidden="true" tabindex="-1"></a>depo<span class="sc">$</span>Total <span class="ot">&lt;-</span> <span class="fu">round</span>(depo<span class="sc">$</span>Total, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb105-221"><a href="#cb105-221" aria-hidden="true" tabindex="-1"></a>depo<span class="sc">$</span>Fuss_IN <span class="ot">&lt;-</span> <span class="fu">round</span>(depo<span class="sc">$</span>Fuss_IN, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb105-222"><a href="#cb105-222" aria-hidden="true" tabindex="-1"></a>depo<span class="sc">$</span>Fuss_OUT <span class="ot">&lt;-</span> <span class="fu">round</span>(depo<span class="sc">$</span>Fuss_OUT, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb105-223"><a href="#cb105-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-224"><a href="#cb105-224" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.2 Pruefen auf Ausreisser (OPTIONAL) ####</span></span>
<span id="cb105-225"><a href="#cb105-225" aria-hidden="true" tabindex="-1"></a><span class="co"># Grundsaetzlich ist es schwierig Ausreisser in einem df zu finden. Gerade die Extremwerte </span></span>
<span id="cb105-226"><a href="#cb105-226" aria-hidden="true" tabindex="-1"></a><span class="co"># koennen entweder falsche Werte, oder aber die wichtigsten Werte im ganzen df sein.</span></span>
<span id="cb105-227"><a href="#cb105-227" aria-hidden="true" tabindex="-1"></a><span class="co"># Ausreisser koennen in einem ersten Schritt optisch relativ einfach gefunden werden.</span></span>
<span id="cb105-228"><a href="#cb105-228" aria-hidden="true" tabindex="-1"></a><span class="co"># Dazu werden die Zaehlmengen auf der y-Achse und die einzelne Datenpunkte auf der x-Achse</span></span>
<span id="cb105-229"><a href="#cb105-229" aria-hidden="true" tabindex="-1"></a><span class="co"># geplottet. Wenn einzelne Werte nun die umliegenden bei weiten ueberragen, sollten diese</span></span>
<span id="cb105-230"><a href="#cb105-230" aria-hidden="true" tabindex="-1"></a><span class="co"># genauer angeschaut werden. Sind sie an einem Wochenende? Ist die Tageszeit realisitsch?</span></span>
<span id="cb105-231"><a href="#cb105-231" aria-hidden="true" tabindex="-1"></a><span class="co"># Wie mit Ausreissern umgegangen wird, muss von Fall zu Fall individuell entschieden werden.</span></span>
<span id="cb105-232"><a href="#cb105-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-233"><a href="#cb105-233" aria-hidden="true" tabindex="-1"></a><span class="co"># Verteilung mittels Histogram pruefen</span></span>
<span id="cb105-234"><a href="#cb105-234" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(depo<span class="sc">$</span>Total[<span class="sc">!</span>depo<span class="sc">$</span>Total<span class="sc">==</span><span class="dv">0</span>] , <span class="at">breaks =</span> <span class="dv">100</span>) </span>
<span id="cb105-235"><a href="#cb105-235" aria-hidden="true" tabindex="-1"></a><span class="co"># hier schliesse ich die Nuller aus der Visualisierung aus</span></span>
<span id="cb105-236"><a href="#cb105-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-237"><a href="#cb105-237" aria-hidden="true" tabindex="-1"></a><span class="co"># Verteilung mittels Scatterplot pruefen</span></span>
<span id="cb105-238"><a href="#cb105-238" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>depo<span class="sc">$</span>Datum, <span class="at">y=</span>depo<span class="sc">$</span>Total)</span>
<span id="cb105-239"><a href="#cb105-239" aria-hidden="true" tabindex="-1"></a><span class="co"># Dem Scatterplot kann nun eine horizontale Linie hinzugefuegt werden, die bei 95 % der</span></span>
<span id="cb105-240"><a href="#cb105-240" aria-hidden="true" tabindex="-1"></a><span class="co"># Werte liegt. Berchnet wird die Linie mittels dem 95 % Quartil</span></span>
<span id="cb105-241"><a href="#cb105-241" aria-hidden="true" tabindex="-1"></a>qts <span class="ot">&lt;-</span> <span class="fu">quantile</span>(depo<span class="sc">$</span>Total,<span class="at">probs=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">95</span>))</span>
<span id="cb105-242"><a href="#cb105-242" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>qts[<span class="dv">2</span>], <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb105-243"><a href="#cb105-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-244"><a href="#cb105-244" aria-hidden="true" tabindex="-1"></a><span class="co"># Werte ueber 95 % auflisten</span></span>
<span id="cb105-245"><a href="#cb105-245" aria-hidden="true" tabindex="-1"></a><span class="co"># Nun koennen diese optisch identifizierten Werte aufgelistet werden. Jeder einzele Wert</span></span>
<span id="cb105-246"><a href="#cb105-246" aria-hidden="true" tabindex="-1"></a><span class="co"># sollte nun auf die Plausibilitaet geprueft werden. Dies sowohl bei Total als auch in</span></span>
<span id="cb105-247"><a href="#cb105-247" aria-hidden="true" tabindex="-1"></a><span class="co"># den einzelnen Richtungen (IN, OUT)</span></span>
<span id="cb105-248"><a href="#cb105-248" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb105-249"><a href="#cb105-249" aria-hidden="true" tabindex="-1"></a>  Ausreisser <span class="ot">&lt;-</span> depo <span class="sc">%&gt;%</span></span>
<span id="cb105-250"><a href="#cb105-250" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Total <span class="sc">&gt;</span> qts[<span class="dv">2</span>])<span class="sc">%&gt;%</span> </span>
<span id="cb105-251"><a href="#cb105-251" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(Total))</span>
<span id="cb105-252"><a href="#cb105-252" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb105-253"><a href="#cb105-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-254"><a href="#cb105-254" aria-hidden="true" tabindex="-1"></a><span class="co"># Werte ausschliessen; Aufgrund manueller Inspektion</span></span>
<span id="cb105-255"><a href="#cb105-255" aria-hidden="true" tabindex="-1"></a><span class="co"># Die Werte, welche als Ausreisser identifiziert wurden, werden nun aufgrund der Zeilennummer </span></span>
<span id="cb105-256"><a href="#cb105-256" aria-hidden="true" tabindex="-1"></a><span class="co"># ausgeschlossen. Das muss individuell angepasst werden.</span></span>
<span id="cb105-257"><a href="#cb105-257" aria-hidden="true" tabindex="-1"></a><span class="co"># depo &lt;- depo[-c(Zeilennummer),] # ersetze "Zeilennummer" mit Zahlen, Kommagetrennt</span></span>
<span id="cb105-258"><a href="#cb105-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-259"><a href="#cb105-259" aria-hidden="true" tabindex="-1"></a><span class="co"># Da der WPZ die Daten aber bereits bereinigte, koennen wir uns diesen Schritt eigentlich sparen... ;)</span></span>
<span id="cb105-260"><a href="#cb105-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-261"><a href="#cb105-261" aria-hidden="true" tabindex="-1"></a><span class="co"># pruefe das df</span></span>
<span id="cb105-262"><a href="#cb105-262" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(depo)</span>
<span id="cb105-263"><a href="#cb105-263" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(depo)</span>
<span id="cb105-264"><a href="#cb105-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-265"><a href="#cb105-265" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.3 Aggregierung der Stundendaten zu ganzen Tagen ####</span></span>
<span id="cb105-266"><a href="#cb105-266" aria-hidden="true" tabindex="-1"></a><span class="co"># Zur Berechnung von Kennwerten ist es hilfreich, wenn neben den Stundendaten auch auf Ganztagesdaten</span></span>
<span id="cb105-267"><a href="#cb105-267" aria-hidden="true" tabindex="-1"></a><span class="co"># zurueckgegriffen werden kann</span></span>
<span id="cb105-268"><a href="#cb105-268" aria-hidden="true" tabindex="-1"></a><span class="co"># hier werden also pro Nutzergruppe und Richtung die Stundenwerte pro Tag aufsummiert</span></span>
<span id="cb105-269"><a href="#cb105-269" aria-hidden="true" tabindex="-1"></a>depo_d <span class="ot">&lt;-</span> depo <span class="sc">%&gt;%</span> </span>
<span id="cb105-270"><a href="#cb105-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Datum, Wochentag, Wochenende, KW, Monat, Jahr, Phase) <span class="sc">%&gt;%</span> </span>
<span id="cb105-271"><a href="#cb105-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total =</span> <span class="fu">sum</span>(Fuss_IN <span class="sc">+</span> Fuss_OUT), </span>
<span id="cb105-272"><a href="#cb105-272" aria-hidden="true" tabindex="-1"></a>            <span class="at">Fuss_IN =</span> <span class="fu">sum</span>(Fuss_IN),</span>
<span id="cb105-273"><a href="#cb105-273" aria-hidden="true" tabindex="-1"></a>            <span class="at">Fuss_OUT =</span> <span class="fu">sum</span>(Fuss_OUT)) </span>
<span id="cb105-274"><a href="#cb105-274" aria-hidden="true" tabindex="-1"></a><span class="co"># Wenn man die Convinience Variablen als grouping variable einspeisst, dann werden sie in </span></span>
<span id="cb105-275"><a href="#cb105-275" aria-hidden="true" tabindex="-1"></a><span class="co"># das neue df uebernommen und muessen nicht nochmals hinzugefuegt werden</span></span>
<span id="cb105-276"><a href="#cb105-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-277"><a href="#cb105-277" aria-hidden="true" tabindex="-1"></a><span class="co"># pruefe das df</span></span>
<span id="cb105-278"><a href="#cb105-278" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(depo_d)</span>
<span id="cb105-279"><a href="#cb105-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-280"><a href="#cb105-280" aria-hidden="true" tabindex="-1"></a><span class="co"># Gruppiere die Werte nach Monat</span></span>
<span id="cb105-281"><a href="#cb105-281" aria-hidden="true" tabindex="-1"></a>depo_m <span class="ot">&lt;-</span> depo <span class="sc">%&gt;%</span> </span>
<span id="cb105-282"><a href="#cb105-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Jahr, Monat) <span class="sc">%&gt;%</span> </span>
<span id="cb105-283"><a href="#cb105-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total =</span> <span class="fu">sum</span>(Total)) </span>
<span id="cb105-284"><a href="#cb105-284" aria-hidden="true" tabindex="-1"></a><span class="co"># sortiere das df aufsteigend (nur das es sicher stimmt)</span></span>
<span id="cb105-285"><a href="#cb105-285" aria-hidden="true" tabindex="-1"></a>depo_m <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(depo_m)</span>
<span id="cb105-286"><a href="#cb105-286" aria-hidden="true" tabindex="-1"></a>depo_m[</span>
<span id="cb105-287"><a href="#cb105-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(depo_m, <span class="fu">order</span>(Jahr, Monat)),]</span>
<span id="cb105-288"><a href="#cb105-288" aria-hidden="true" tabindex="-1"></a><span class="co"># mache dann aus Jahr und Monat faktoren</span></span>
<span id="cb105-289"><a href="#cb105-289" aria-hidden="true" tabindex="-1"></a>depo_m <span class="ot">&lt;-</span> depo_m <span class="sc">%&gt;%</span> </span>
<span id="cb105-290"><a href="#cb105-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Jahr =</span> <span class="fu">as.factor</span>(Jahr)) <span class="sc">%&gt;%</span> </span>
<span id="cb105-291"><a href="#cb105-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Monat =</span> <span class="fu">as.factor</span>(Monat)) <span class="sc">%&gt;%</span> </span>
<span id="cb105-292"><a href="#cb105-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ym =</span> <span class="fu">paste</span>(Jahr, Monat)) <span class="sc">%&gt;%</span> <span class="co"># und mache eine neue Spalte, in der Jahr und</span></span>
<span id="cb105-293"><a href="#cb105-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ym=</span> <span class="fu">factor</span>(Ym, <span class="at">levels=</span><span class="fu">unique</span>(Ym))) <span class="co"># Monat in zusammen sind</span></span>
<span id="cb105-294"><a href="#cb105-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-295"><a href="#cb105-295" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.4 Explorative Darstellung Meteodaten ####</span></span>
<span id="cb105-296"><a href="#cb105-296" aria-hidden="true" tabindex="-1"></a><span class="co"># ausschliesslich zur optischen validierung, kein wichtiges Resultat!</span></span>
<span id="cb105-297"><a href="#cb105-297" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperaturmaximum</span></span>
<span id="cb105-298"><a href="#cb105-298" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(data=meteo, mapping=aes(x=time, y=tre200jx))+</span></span>
<span id="cb105-299"><a href="#cb105-299" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point()+</span></span>
<span id="cb105-300"><a href="#cb105-300" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_smooth(col="red")</span></span>
<span id="cb105-301"><a href="#cb105-301" aria-hidden="true" tabindex="-1"></a><span class="co"># # Niederschlagsumme</span></span>
<span id="cb105-302"><a href="#cb105-302" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(data=meteo, mapping=aes(x=time, y=rre150j0))+</span></span>
<span id="cb105-303"><a href="#cb105-303" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point()+</span></span>
<span id="cb105-304"><a href="#cb105-304" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_smooth(col="blue")</span></span>
<span id="cb105-305"><a href="#cb105-305" aria-hidden="true" tabindex="-1"></a><span class="co"># # Sonnenminuten</span></span>
<span id="cb105-306"><a href="#cb105-306" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(data=meteo, mapping=aes(x=time, y=sremaxdv))+</span></span>
<span id="cb105-307"><a href="#cb105-307" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point()+</span></span>
<span id="cb105-308"><a href="#cb105-308" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_smooth(col="yellow")</span></span>
<span id="cb105-309"><a href="#cb105-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-310"><a href="#cb105-310" aria-hidden="true" tabindex="-1"></a><span class="co"># Pruefe das df</span></span>
<span id="cb105-311"><a href="#cb105-311" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(meteo)</span>
<span id="cb105-312"><a href="#cb105-312" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(meteo)</span>
<span id="cb105-313"><a href="#cb105-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-314"><a href="#cb105-314" aria-hidden="true" tabindex="-1"></a><span class="co">#.################################################################################################</span></span>
<span id="cb105-315"><a href="#cb105-315" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. DESKRIPTIVE ANALYSE UND VISUALISIERUNG #####</span></span>
<span id="cb105-316"><a href="#cb105-316" aria-hidden="true" tabindex="-1"></a><span class="co">#.################################################################################################</span></span>
<span id="cb105-317"><a href="#cb105-317" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-318"><a href="#cb105-318" aria-hidden="true" tabindex="-1"></a><span class="co"># # 3.1 Verlauf der Besuchszahlen / m ####</span></span>
<span id="cb105-319"><a href="#cb105-319" aria-hidden="true" tabindex="-1"></a><span class="co"># # Monatliche Summen am Standort</span></span>
<span id="cb105-320"><a href="#cb105-320" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-321"><a href="#cb105-321" aria-hidden="true" tabindex="-1"></a><span class="co"># # wann beginnt die Datenreihe schon wieder?</span></span>
<span id="cb105-322"><a href="#cb105-322" aria-hidden="true" tabindex="-1"></a><span class="co"># first(depo_m$Ym)</span></span>
<span id="cb105-323"><a href="#cb105-323" aria-hidden="true" tabindex="-1"></a><span class="co"># # und wann ist die fertig?</span></span>
<span id="cb105-324"><a href="#cb105-324" aria-hidden="true" tabindex="-1"></a><span class="co"># last(depo_m$Ym)</span></span>
<span id="cb105-325"><a href="#cb105-325" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-326"><a href="#cb105-326" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plotte</span></span>
<span id="cb105-327"><a href="#cb105-327" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(depo_m, mapping = aes(Ym, Total, group = 1))+ # group = 1 braucht R, dass aus den Einzelpunkten ein Zusammenhang hergestellt wird</span></span>
<span id="cb105-328"><a href="#cb105-328" aria-hidden="true" tabindex="-1"></a><span class="co">#   #zeichne Lockdown 1</span></span>
<span id="cb105-329"><a href="#cb105-329" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_rect(mapping = aes(xmin="2020 3", xmax="2020 5",</span></span>
<span id="cb105-330"><a href="#cb105-330" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ymin =0, ymax=max(Total+(Total/100*10))),</span></span>
<span id="cb105-331"><a href="#cb105-331" aria-hidden="true" tabindex="-1"></a><span class="co">#             fill = "lightskyblue", alpha = 0.4, colour = NA)+</span></span>
<span id="cb105-332"><a href="#cb105-332" aria-hidden="true" tabindex="-1"></a><span class="co">#   #zeichne Lockdown 2</span></span>
<span id="cb105-333"><a href="#cb105-333" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_rect(mapping = aes(xmin="2020 12", xmax="2021 3", </span></span>
<span id="cb105-334"><a href="#cb105-334" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ymin =0, ymax=max(Total+(Total/100*10))), </span></span>
<span id="cb105-335"><a href="#cb105-335" aria-hidden="true" tabindex="-1"></a><span class="co">#             fill = "lightskyblue", alpha = 0.4, colour = NA)+</span></span>
<span id="cb105-336"><a href="#cb105-336" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line(alpha = 0.6, size = 1.5)+</span></span>
<span id="cb105-337"><a href="#cb105-337" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_discrete(breaks = c("2019 1", "2019 7","2019 1","2020 1","2020 7","2021 1","2021 7"),</span></span>
<span id="cb105-338"><a href="#cb105-338" aria-hidden="true" tabindex="-1"></a><span class="co">#                    labels = c("2019 1", "2019 7","2019 1","2020 1","2020 7","2021 1","2021 7"))+</span></span>
<span id="cb105-339"><a href="#cb105-339" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title= "", y="Fussgänger:innen pro Monat", x = "Jahr")+</span></span>
<span id="cb105-340"><a href="#cb105-340" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_linedraw(base_size = 15)+</span></span>
<span id="cb105-341"><a href="#cb105-341" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))</span></span>
<span id="cb105-342"><a href="#cb105-342" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-343"><a href="#cb105-343" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("Entwicklung_Zaehlstelle.png", width=20, height=10, units="cm", dpi=1000, </span></span>
<span id="cb105-344"><a href="#cb105-344" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/") </span></span>
<span id="cb105-345"><a href="#cb105-345" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-346"><a href="#cb105-346" aria-hidden="true" tabindex="-1"></a><span class="co"># # 3.2 Wochengang ####</span></span>
<span id="cb105-347"><a href="#cb105-347" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-348"><a href="#cb105-348" aria-hidden="true" tabindex="-1"></a><span class="co"># # mean / d / phase</span></span>
<span id="cb105-349"><a href="#cb105-349" aria-hidden="true" tabindex="-1"></a><span class="co"># mean_phase_wd &lt;- depo_d %&gt;% </span></span>
<span id="cb105-350"><a href="#cb105-350" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Wochentag, Phase) %&gt;% </span></span>
<span id="cb105-351"><a href="#cb105-351" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(Total = mean(Total))</span></span>
<span id="cb105-352"><a href="#cb105-352" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-353"><a href="#cb105-353" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(mean_phase_wd, "fallstudien/_R_analysis/results/mean_phase_wd.csv")</span></span>
<span id="cb105-354"><a href="#cb105-354" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-355"><a href="#cb105-355" aria-hidden="true" tabindex="-1"></a><span class="co"># #plot</span></span>
<span id="cb105-356"><a href="#cb105-356" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(data = depo_d)+</span></span>
<span id="cb105-357"><a href="#cb105-357" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_boxplot(mapping = aes(x= Wochentag, y = Total, fill = Phase))+</span></span>
<span id="cb105-358"><a href="#cb105-358" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title="", y= "Fussgänger:innen pro Tag")+</span></span>
<span id="cb105-359"><a href="#cb105-359" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_manual(values = c("royalblue", "red4", "orangered", "gold2"))+</span></span>
<span id="cb105-360"><a href="#cb105-360" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_classic(base_size = 15)+</span></span>
<span id="cb105-361"><a href="#cb105-361" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),</span></span>
<span id="cb105-362"><a href="#cb105-362" aria-hidden="true" tabindex="-1"></a><span class="co">#         legend.title = element_blank())</span></span>
<span id="cb105-363"><a href="#cb105-363" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-364"><a href="#cb105-364" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("Wochengang_Lockdown.png", width=15, height=15, units="cm", dpi=1000, </span></span>
<span id="cb105-365"><a href="#cb105-365" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/")</span></span>
<span id="cb105-366"><a href="#cb105-366" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-367"><a href="#cb105-367" aria-hidden="true" tabindex="-1"></a><span class="co"># # Statistik: Unterschied WE und WO während Lockdown 1</span></span>
<span id="cb105-368"><a href="#cb105-368" aria-hidden="true" tabindex="-1"></a><span class="co"># t.test(depo_d$Total [depo_d$Phase == "Lockdown_1" &amp; depo_d$Wochenende=="Werktag"], </span></span>
<span id="cb105-369"><a href="#cb105-369" aria-hidden="true" tabindex="-1"></a><span class="co">#        depo_d$Total [depo_d$Phase == "Lockdown_1" &amp; depo_d$Wochenende=="Wochenende"])</span></span>
<span id="cb105-370"><a href="#cb105-370" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-371"><a href="#cb105-371" aria-hidden="true" tabindex="-1"></a><span class="co"># # 3.3 Tagesgang ####</span></span>
<span id="cb105-372"><a href="#cb105-372" aria-hidden="true" tabindex="-1"></a><span class="co"># # Bei diesen Berechnungen wird jeweils der Mittelwert pro Stunde berechnet. </span></span>
<span id="cb105-373"><a href="#cb105-373" aria-hidden="true" tabindex="-1"></a><span class="co"># # wiederum nutzen wir dafuer "pipes"</span></span>
<span id="cb105-374"><a href="#cb105-374" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean_h &lt;- depo %&gt;% </span></span>
<span id="cb105-375"><a href="#cb105-375" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Wochentag, Stunde, Phase) %&gt;% </span></span>
<span id="cb105-376"><a href="#cb105-376" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(Total = mean(Total)) </span></span>
<span id="cb105-377"><a href="#cb105-377" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-378"><a href="#cb105-378" aria-hidden="true" tabindex="-1"></a><span class="co"># # transformiere fuer Plotting</span></span>
<span id="cb105-379"><a href="#cb105-379" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean_h_long&lt;- reshape2::melt(Mean_h,measure.vars = c("Total"),</span></span>
<span id="cb105-380"><a href="#cb105-380" aria-hidden="true" tabindex="-1"></a><span class="co">#                              value.name = "Durchschnitt",variable.name = "Gruppe")</span></span>
<span id="cb105-381"><a href="#cb105-381" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-382"><a href="#cb105-382" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plotte den Tagesgang, unterteilt nach Wochentagen</span></span>
<span id="cb105-383"><a href="#cb105-383" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-384"><a href="#cb105-384" aria-hidden="true" tabindex="-1"></a><span class="co"># # Normal</span></span>
<span id="cb105-385"><a href="#cb105-385" aria-hidden="true" tabindex="-1"></a><span class="co"># tag_norm &lt;- ggplot(subset(Mean_h_long, Phase %in% c("Normal")), </span></span>
<span id="cb105-386"><a href="#cb105-386" aria-hidden="true" tabindex="-1"></a><span class="co">#                      mapping=aes(x = Stunde, y = Durchschnitt, colour = Wochentag, linetype = Wochentag))+</span></span>
<span id="cb105-387"><a href="#cb105-387" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line(size = 2)+</span></span>
<span id="cb105-388"><a href="#cb105-388" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_viridis_d()+</span></span>
<span id="cb105-389"><a href="#cb105-389" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_linetype_manual(values = c(rep("solid", 5),  "twodash", "twodash"))+</span></span>
<span id="cb105-390"><a href="#cb105-390" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(breaks = c(seq(0, 23, by = 2)), labels = c(seq(0, 23, by = 2)))+</span></span>
<span id="cb105-391"><a href="#cb105-391" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x="Uhrzeit [h]", y= "∅ Fussganger_Innen / h", title = "")+</span></span>
<span id="cb105-392"><a href="#cb105-392" aria-hidden="true" tabindex="-1"></a><span class="co">#   lims(y = c(0,25))+</span></span>
<span id="cb105-393"><a href="#cb105-393" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_linedraw(base_size = 15)+</span></span>
<span id="cb105-394"><a href="#cb105-394" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.position = "right")</span></span>
<span id="cb105-395"><a href="#cb105-395" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-396"><a href="#cb105-396" aria-hidden="true" tabindex="-1"></a><span class="co"># # Lockdown 1</span></span>
<span id="cb105-397"><a href="#cb105-397" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-398"><a href="#cb105-398" aria-hidden="true" tabindex="-1"></a><span class="co"># tag_lock_1 &lt;- ggplot(subset(Mean_h_long, Phase %in% c("Lockdown_1")), </span></span>
<span id="cb105-399"><a href="#cb105-399" aria-hidden="true" tabindex="-1"></a><span class="co">#                      mapping=aes(x = Stunde, y = Durchschnitt, colour = Wochentag, linetype = Wochentag))+</span></span>
<span id="cb105-400"><a href="#cb105-400" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line(size = 2)+</span></span>
<span id="cb105-401"><a href="#cb105-401" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_viridis_d()+</span></span>
<span id="cb105-402"><a href="#cb105-402" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_linetype_manual(values = c(rep("solid", 5), "twodash", "twodash"))+</span></span>
<span id="cb105-403"><a href="#cb105-403" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(breaks = c(seq(0, 23, by = 2)), labels = c(seq(0, 23, by = 2)))+</span></span>
<span id="cb105-404"><a href="#cb105-404" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x="Uhrzeit [h]", y= "∅ Fussganger_Innen / h", title = "")+</span></span>
<span id="cb105-405"><a href="#cb105-405" aria-hidden="true" tabindex="-1"></a><span class="co">#   lims(y = c(0,25))+</span></span>
<span id="cb105-406"><a href="#cb105-406" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_linedraw(base_size = 15)+</span></span>
<span id="cb105-407"><a href="#cb105-407" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.position = "right")</span></span>
<span id="cb105-408"><a href="#cb105-408" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-409"><a href="#cb105-409" aria-hidden="true" tabindex="-1"></a><span class="co"># # Lockdown 2</span></span>
<span id="cb105-410"><a href="#cb105-410" aria-hidden="true" tabindex="-1"></a><span class="co"># tag_lock_2 &lt;- ggplot(subset(Mean_h_long, Phase %in% c("Lockdown_2")), </span></span>
<span id="cb105-411"><a href="#cb105-411" aria-hidden="true" tabindex="-1"></a><span class="co">#                      mapping=aes(x = Stunde, y = Durchschnitt, colour = Wochentag, linetype = Wochentag))+</span></span>
<span id="cb105-412"><a href="#cb105-412" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line(size = 2)+</span></span>
<span id="cb105-413"><a href="#cb105-413" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_viridis_d()+</span></span>
<span id="cb105-414"><a href="#cb105-414" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_linetype_manual(values = c(rep("solid", 5), "twodash", "twodash"))+</span></span>
<span id="cb105-415"><a href="#cb105-415" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(breaks = c(seq(0, 23, by = 2)), labels = c(seq(0, 23, by = 2)))+</span></span>
<span id="cb105-416"><a href="#cb105-416" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x="Uhrzeit [h]", y= "∅ Fussganger_Innen / h", title = "")+</span></span>
<span id="cb105-417"><a href="#cb105-417" aria-hidden="true" tabindex="-1"></a><span class="co">#   lims(y = c(0,25))+</span></span>
<span id="cb105-418"><a href="#cb105-418" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_linedraw(base_size = 15)+</span></span>
<span id="cb105-419"><a href="#cb105-419" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.position = "right")</span></span>
<span id="cb105-420"><a href="#cb105-420" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-421"><a href="#cb105-421" aria-hidden="true" tabindex="-1"></a><span class="co"># # Covid</span></span>
<span id="cb105-422"><a href="#cb105-422" aria-hidden="true" tabindex="-1"></a><span class="co"># tag_covid &lt;- ggplot(subset(Mean_h_long, Phase %in% c("Covid")), </span></span>
<span id="cb105-423"><a href="#cb105-423" aria-hidden="true" tabindex="-1"></a><span class="co">#                      mapping=aes(x = Stunde, y = Durchschnitt, colour = Wochentag, linetype = Wochentag))+</span></span>
<span id="cb105-424"><a href="#cb105-424" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line(size = 2)+</span></span>
<span id="cb105-425"><a href="#cb105-425" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_colour_viridis_d()+</span></span>
<span id="cb105-426"><a href="#cb105-426" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_linetype_manual(values = c(rep("solid", 5), "twodash", "twodash"))+</span></span>
<span id="cb105-427"><a href="#cb105-427" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_continuous(breaks = c(seq(0, 23, by = 2)), labels = c(seq(0, 23, by = 2)))+</span></span>
<span id="cb105-428"><a href="#cb105-428" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(x="Uhrzeit [h]", y= "∅ Fussganger_Innen / h", title = "")+</span></span>
<span id="cb105-429"><a href="#cb105-429" aria-hidden="true" tabindex="-1"></a><span class="co">#   lims(y = c(0,25))+</span></span>
<span id="cb105-430"><a href="#cb105-430" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_linedraw(base_size = 15)+</span></span>
<span id="cb105-431"><a href="#cb105-431" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.position = "right")</span></span>
<span id="cb105-432"><a href="#cb105-432" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-433"><a href="#cb105-433" aria-hidden="true" tabindex="-1"></a><span class="co"># # Arrange und Export Tagesgang</span></span>
<span id="cb105-434"><a href="#cb105-434" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(tag_lock_1+            # plot 1 aufrufen</span></span>
<span id="cb105-435"><a href="#cb105-435" aria-hidden="true" tabindex="-1"></a><span class="co">#             rremove("x.text")+   # plot 1 braucht es nicht alle Achsenbeschriftungen</span></span>
<span id="cb105-436"><a href="#cb105-436" aria-hidden="true" tabindex="-1"></a><span class="co">#             rremove("x.title"),            </span></span>
<span id="cb105-437"><a href="#cb105-437" aria-hidden="true" tabindex="-1"></a><span class="co">#           tag_lock_2+            # plot 2 aufrufen</span></span>
<span id="cb105-438"><a href="#cb105-438" aria-hidden="true" tabindex="-1"></a><span class="co">#             rremove("y.text")+   # bei plot 2 brauchen wir keine Achsenbeschriftung</span></span>
<span id="cb105-439"><a href="#cb105-439" aria-hidden="true" tabindex="-1"></a><span class="co">#             rremove("y.title")+</span></span>
<span id="cb105-440"><a href="#cb105-440" aria-hidden="true" tabindex="-1"></a><span class="co">#             rremove("x.text")+</span></span>
<span id="cb105-441"><a href="#cb105-441" aria-hidden="true" tabindex="-1"></a><span class="co">#             rremove("x.title"),</span></span>
<span id="cb105-442"><a href="#cb105-442" aria-hidden="true" tabindex="-1"></a><span class="co">#           tag_norm,</span></span>
<span id="cb105-443"><a href="#cb105-443" aria-hidden="true" tabindex="-1"></a><span class="co">#           tag_covid+</span></span>
<span id="cb105-444"><a href="#cb105-444" aria-hidden="true" tabindex="-1"></a><span class="co">#             rremove("y.text")+   </span></span>
<span id="cb105-445"><a href="#cb105-445" aria-hidden="true" tabindex="-1"></a><span class="co">#             rremove("y.title"),</span></span>
<span id="cb105-446"><a href="#cb105-446" aria-hidden="true" tabindex="-1"></a><span class="co">#           ncol = 2, nrow = 2,    # definieren, wie die plots angeordnet werden</span></span>
<span id="cb105-447"><a href="#cb105-447" aria-hidden="true" tabindex="-1"></a><span class="co">#           heights = c(0.9, 1),  # beide plots sind wegen der fehlenden Beschriftung nicht gleich hoch</span></span>
<span id="cb105-448"><a href="#cb105-448" aria-hidden="true" tabindex="-1"></a><span class="co">#           widths = c(1,0.9),    </span></span>
<span id="cb105-449"><a href="#cb105-449" aria-hidden="true" tabindex="-1"></a><span class="co">#           labels = c("a) Lockdown 1", "b) Lockdown 2", "c) Normal", "d) Covid"),</span></span>
<span id="cb105-450"><a href="#cb105-450" aria-hidden="true" tabindex="-1"></a><span class="co">#           label.x = 0.1,        # wo stehen die Plottitel</span></span>
<span id="cb105-451"><a href="#cb105-451" aria-hidden="true" tabindex="-1"></a><span class="co">#           label.y = 0.99,</span></span>
<span id="cb105-452"><a href="#cb105-452" aria-hidden="true" tabindex="-1"></a><span class="co">#           common.legend = TRUE, legend = "bottom") # wir brauchen nur eine Legende, unten</span></span>
<span id="cb105-453"><a href="#cb105-453" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-454"><a href="#cb105-454" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("Tagesgang.png", width=25, height=25, units="cm", dpi=1000,</span></span>
<span id="cb105-455"><a href="#cb105-455" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/")</span></span>
<span id="cb105-456"><a href="#cb105-456" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-457"><a href="#cb105-457" aria-hidden="true" tabindex="-1"></a><span class="co"># # 3.4 Kennzahlen ####</span></span>
<span id="cb105-458"><a href="#cb105-458" aria-hidden="true" tabindex="-1"></a><span class="co"># total_phase &lt;- depo_d %&gt;% </span></span>
<span id="cb105-459"><a href="#cb105-459" aria-hidden="true" tabindex="-1"></a><span class="co">#   # gruppiere nach Phasen inkl. Normal. Diese Levels haben wir bereits definiert</span></span>
<span id="cb105-460"><a href="#cb105-460" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Phase) %&gt;% </span></span>
<span id="cb105-461"><a href="#cb105-461" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(Total = sum(Total),</span></span>
<span id="cb105-462"><a href="#cb105-462" aria-hidden="true" tabindex="-1"></a><span class="co">#             IN = sum(Fuss_IN),</span></span>
<span id="cb105-463"><a href="#cb105-463" aria-hidden="true" tabindex="-1"></a><span class="co">#             OUT = sum(Fuss_OUT))</span></span>
<span id="cb105-464"><a href="#cb105-464" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-465"><a href="#cb105-465" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(total_phase, "fallstudien/_R_analysis/results/total_phase.csv")</span></span>
<span id="cb105-466"><a href="#cb105-466" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-467"><a href="#cb105-467" aria-hidden="true" tabindex="-1"></a><span class="co"># # mean besser Vergleichbar, da Zeitreihen unterschiedlich lange</span></span>
<span id="cb105-468"><a href="#cb105-468" aria-hidden="true" tabindex="-1"></a><span class="co"># mean_phase_d &lt;- depo_d %&gt;% </span></span>
<span id="cb105-469"><a href="#cb105-469" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Phase) %&gt;% </span></span>
<span id="cb105-470"><a href="#cb105-470" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(Total = mean(Total),</span></span>
<span id="cb105-471"><a href="#cb105-471" aria-hidden="true" tabindex="-1"></a><span class="co">#             IN = mean(Fuss_IN),</span></span>
<span id="cb105-472"><a href="#cb105-472" aria-hidden="true" tabindex="-1"></a><span class="co">#             OUT = mean(Fuss_OUT))</span></span>
<span id="cb105-473"><a href="#cb105-473" aria-hidden="true" tabindex="-1"></a><span class="co"># # berechne prozentuale Richtungsverteilung</span></span>
<span id="cb105-474"><a href="#cb105-474" aria-hidden="true" tabindex="-1"></a><span class="co"># mean_phase_d &lt;- mean_phase_d %&gt;% </span></span>
<span id="cb105-475"><a href="#cb105-475" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(Proz_IN = round(100/Total*IN, 1)) %&gt;% # berechnen und auf eine Nachkommastelle runden</span></span>
<span id="cb105-476"><a href="#cb105-476" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(Proz_OUT = round(100/Total*OUT,1))</span></span>
<span id="cb105-477"><a href="#cb105-477" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-478"><a href="#cb105-478" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(mean_phase_d, "fallstudien/_R_analysis/results/mean_phase_d.csv")</span></span>
<span id="cb105-479"><a href="#cb105-479" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-480"><a href="#cb105-480" aria-hidden="true" tabindex="-1"></a><span class="co"># # selektiere absolute Zahlen</span></span>
<span id="cb105-481"><a href="#cb105-481" aria-hidden="true" tabindex="-1"></a><span class="co"># # behalte rel. Spalten (nur die relativen Prozentangaben)</span></span>
<span id="cb105-482"><a href="#cb105-482" aria-hidden="true" tabindex="-1"></a><span class="co"># mean_phase_d_abs &lt;- mean_phase_d[,-c(2,5,6), drop=FALSE]</span></span>
<span id="cb105-483"><a href="#cb105-483" aria-hidden="true" tabindex="-1"></a><span class="co"># # transformiere fuer Plotting</span></span>
<span id="cb105-484"><a href="#cb105-484" aria-hidden="true" tabindex="-1"></a><span class="co"># mean_phase_d_abs &lt;- reshape2::melt(mean_phase_d_abs, </span></span>
<span id="cb105-485"><a href="#cb105-485" aria-hidden="true" tabindex="-1"></a><span class="co">#                                      measure.vars = c("IN","OUT"),</span></span>
<span id="cb105-486"><a href="#cb105-486" aria-hidden="true" tabindex="-1"></a><span class="co">#                                      value.name = "Durchschnitt",variable.name = "Gruppe")</span></span>
<span id="cb105-487"><a href="#cb105-487" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-488"><a href="#cb105-488" aria-hidden="true" tabindex="-1"></a><span class="co"># # selektiere relative Zahlen</span></span>
<span id="cb105-489"><a href="#cb105-489" aria-hidden="true" tabindex="-1"></a><span class="co"># # behalte rel. Spalten (nur die relativen Prozentangaben)</span></span>
<span id="cb105-490"><a href="#cb105-490" aria-hidden="true" tabindex="-1"></a><span class="co"># mean_phase_d_proz &lt;- mean_phase_d[,-c(2:4), drop=FALSE]</span></span>
<span id="cb105-491"><a href="#cb105-491" aria-hidden="true" tabindex="-1"></a><span class="co"># # transformiere fuer Plotting</span></span>
<span id="cb105-492"><a href="#cb105-492" aria-hidden="true" tabindex="-1"></a><span class="co"># mean_phase_d_proz &lt;- reshape2::melt(mean_phase_d_proz, </span></span>
<span id="cb105-493"><a href="#cb105-493" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  measure.vars = c("Proz_IN","Proz_OUT"),</span></span>
<span id="cb105-494"><a href="#cb105-494" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  value.name = "Durchschnitt",variable.name = "Gruppe")</span></span>
<span id="cb105-495"><a href="#cb105-495" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-496"><a href="#cb105-496" aria-hidden="true" tabindex="-1"></a><span class="co"># # Visualisierung abs</span></span>
<span id="cb105-497"><a href="#cb105-497" aria-hidden="true" tabindex="-1"></a><span class="co"># abs &lt;- ggplot(data = mean_phase_d_abs, mapping = aes(x = Gruppe, y = Durchschnitt, fill = Phase))+</span></span>
<span id="cb105-498"><a href="#cb105-498" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_col(position = "dodge", width = 0.8)+</span></span>
<span id="cb105-499"><a href="#cb105-499" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_manual(values = c("royalblue", "red4", "orangered", "gold2"), name = "Phase")+</span></span>
<span id="cb105-500"><a href="#cb105-500" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_discrete(labels = c("IN", "OUT"))+</span></span>
<span id="cb105-501"><a href="#cb105-501" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(y = "Durchschnitt [mean]", x= "Bewegungsrichtung")+</span></span>
<span id="cb105-502"><a href="#cb105-502" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_classic(base_size = 15)+</span></span>
<span id="cb105-503"><a href="#cb105-503" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.position = "bottom")</span></span>
<span id="cb105-504"><a href="#cb105-504" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-505"><a href="#cb105-505" aria-hidden="true" tabindex="-1"></a><span class="co"># # Visualisierung %</span></span>
<span id="cb105-506"><a href="#cb105-506" aria-hidden="true" tabindex="-1"></a><span class="co"># proz &lt;- ggplot(data = mean_phase_d_proz, mapping = aes(x = Gruppe, y = Durchschnitt, fill = Phase))+</span></span>
<span id="cb105-507"><a href="#cb105-507" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_col(position = "dodge", width = 0.8)+</span></span>
<span id="cb105-508"><a href="#cb105-508" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_fill_manual(values = c("royalblue", "red4", "orangered", "gold2"), name = "Phase")+</span></span>
<span id="cb105-509"><a href="#cb105-509" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_discrete(labels = c("IN", "OUT"))+</span></span>
<span id="cb105-510"><a href="#cb105-510" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(y = "Durchschnitt [%]", x= "Bewegungsrichtung")+</span></span>
<span id="cb105-511"><a href="#cb105-511" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_classic(base_size = 15)+</span></span>
<span id="cb105-512"><a href="#cb105-512" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.position = "bottom")</span></span>
<span id="cb105-513"><a href="#cb105-513" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-514"><a href="#cb105-514" aria-hidden="true" tabindex="-1"></a><span class="co"># # Arrange und Export Verteilung</span></span>
<span id="cb105-515"><a href="#cb105-515" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(abs,            # plot 1 aufrufen</span></span>
<span id="cb105-516"><a href="#cb105-516" aria-hidden="true" tabindex="-1"></a><span class="co">#           proz,            # plot 2 aufrufen</span></span>
<span id="cb105-517"><a href="#cb105-517" aria-hidden="true" tabindex="-1"></a><span class="co">#           ncol = 2, nrow = 1,    # definieren, wie die plots angeordnet werden</span></span>
<span id="cb105-518"><a href="#cb105-518" aria-hidden="true" tabindex="-1"></a><span class="co">#           heights = c(1),        # beide sind bleich hoch</span></span>
<span id="cb105-519"><a href="#cb105-519" aria-hidden="true" tabindex="-1"></a><span class="co">#           widths = c(1,0.95),    # plot 2 ist aufgrund der fehlenden y-achsenbesch. etwas schmaler</span></span>
<span id="cb105-520"><a href="#cb105-520" aria-hidden="true" tabindex="-1"></a><span class="co">#           labels = c("a) Absolute Verteilung", "b) Relative Verteilung"),</span></span>
<span id="cb105-521"><a href="#cb105-521" aria-hidden="true" tabindex="-1"></a><span class="co">#           label.x = 0,        # wo stehen die labels</span></span>
<span id="cb105-522"><a href="#cb105-522" aria-hidden="true" tabindex="-1"></a><span class="co">#           label.y = 1.0,</span></span>
<span id="cb105-523"><a href="#cb105-523" aria-hidden="true" tabindex="-1"></a><span class="co">#           common.legend = TRUE, legend = "bottom") # wir brauchen nur eine Legende, unten</span></span>
<span id="cb105-524"><a href="#cb105-524" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-525"><a href="#cb105-525" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("Verteilung.png", width=20, height=15, units="cm", dpi=1000,</span></span>
<span id="cb105-526"><a href="#cb105-526" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/")</span></span>
<span id="cb105-527"><a href="#cb105-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-528"><a href="#cb105-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-529"><a href="#cb105-529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb105-530"><a href="#cb105-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-531"><a href="#cb105-531" aria-hidden="true" tabindex="-1"></a><span class="fu"># Aufgabe 1: Verbinden von Daten (Join)</span></span>
<span id="cb105-534"><a href="#cb105-534" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb105-535"><a href="#cb105-535" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.1 Einflussfaktoren Besucherzahl ####</span></span>
<span id="cb105-536"><a href="#cb105-536" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstelle ein df indem die taeglichen Zaehldaten und Meteodaten vereint sind</span></span>
<span id="cb105-537"><a href="#cb105-537" aria-hidden="true" tabindex="-1"></a>umwelt <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(depo_d, meteo, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Datum"</span> <span class="ot">=</span> <span class="st">"time"</span>))</span>
<span id="cb105-538"><a href="#cb105-538" aria-hidden="true" tabindex="-1"></a><span class="co"># Das zusammenfuehren folgt evtl. in NA-Werten bei gewissen Tagen</span></span>
<span id="cb105-539"><a href="#cb105-539" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(umwelt))</span>
<span id="cb105-540"><a href="#cb105-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-541"><a href="#cb105-541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb105-542"><a href="#cb105-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-543"><a href="#cb105-543" aria-hidden="true" tabindex="-1"></a><span class="fu"># Aufgabe 2: Convinience Variablen, Faktoren, Skalieren</span></span>
<span id="cb105-546"><a href="#cb105-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb105-547"><a href="#cb105-547" aria-hidden="true" tabindex="-1"></a><span class="co"># nochmals einige Convinience Variablen</span></span>
<span id="cb105-548"><a href="#cb105-548" aria-hidden="true" tabindex="-1"></a>umwelt <span class="ot">&lt;-</span> umwelt<span class="sc">%&gt;%</span></span>
<span id="cb105-549"><a href="#cb105-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ferien =</span> <span class="fu">if_else</span>(  </span>
<span id="cb105-550"><a href="#cb105-550" aria-hidden="true" tabindex="-1"></a>    Datum <span class="sc">&gt;=</span> Fruehlingsferien_2019_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Fruehlingsferien_2019_ende <span class="sc">|</span></span>
<span id="cb105-551"><a href="#cb105-551" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Sommerferien_2019_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Sommerferien_2019_ende <span class="sc">|</span></span>
<span id="cb105-552"><a href="#cb105-552" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Herbstferien_2019_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Herbstferien_2019_ende <span class="sc">|</span></span>
<span id="cb105-553"><a href="#cb105-553" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Winterferien_2019_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Winterferien_2019_ende <span class="sc">|</span></span>
<span id="cb105-554"><a href="#cb105-554" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Fruehlingsferien_2020_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Fruehlingsferien_2020_ende <span class="sc">|</span></span>
<span id="cb105-555"><a href="#cb105-555" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Sommerferien_2020_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Sommerferien_2020_ende <span class="sc">|</span></span>
<span id="cb105-556"><a href="#cb105-556" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Herbstferien_2020_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Herbstferien_2020_ende <span class="sc">|</span></span>
<span id="cb105-557"><a href="#cb105-557" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Winterferien_2020_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Winterferien_2020_ende <span class="sc">|</span></span>
<span id="cb105-558"><a href="#cb105-558" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Fruehlingsferien_2021_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> Fruehlingsferien_2021_ende <span class="sc">|</span></span>
<span id="cb105-559"><a href="#cb105-559" aria-hidden="true" tabindex="-1"></a>      Datum <span class="sc">&gt;=</span> Sommerferien_2021_start <span class="sc">&amp;</span> Datum <span class="sc">&lt;=</span> <span class="fu">max</span>(depo<span class="sc">$</span>Datum),</span>
<span id="cb105-560"><a href="#cb105-560" aria-hidden="true" tabindex="-1"></a>        <span class="st">"1"</span>, <span class="st">"0"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb105-561"><a href="#cb105-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ferien =</span> <span class="fu">factor</span>(Ferien))</span>
<span id="cb105-562"><a href="#cb105-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-563"><a href="#cb105-563" aria-hidden="true" tabindex="-1"></a><span class="co"># Faktor und integer</span></span>
<span id="cb105-564"><a href="#cb105-564" aria-hidden="true" tabindex="-1"></a><span class="co"># Im GLMM wird die Kalenderwoche und das Jahr als random factor definiert. Dazu muss sie als</span></span>
<span id="cb105-565"><a href="#cb105-565" aria-hidden="true" tabindex="-1"></a><span class="co"># Faktor vorliegen.</span></span>
<span id="cb105-566"><a href="#cb105-566" aria-hidden="true" tabindex="-1"></a>umwelt <span class="ot">&lt;-</span> umwelt <span class="sc">%&gt;%</span> </span>
<span id="cb105-567"><a href="#cb105-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Jahr =</span> <span class="fu">as.factor</span>(Jahr)) <span class="sc">%&gt;%</span> </span>
<span id="cb105-568"><a href="#cb105-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">KW =</span> <span class="fu">as.factor</span>(KW))</span>
<span id="cb105-569"><a href="#cb105-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-570"><a href="#cb105-570" aria-hidden="true" tabindex="-1"></a><span class="co"># Unser Modell kann nur mit ganzen Zahlen umgehen. Zum Glueck habe wir die Zaehldaten</span></span>
<span id="cb105-571"><a href="#cb105-571" aria-hidden="true" tabindex="-1"></a><span class="co"># bereits gerundet.</span></span>
<span id="cb105-572"><a href="#cb105-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-573"><a href="#cb105-573" aria-hidden="true" tabindex="-1"></a><span class="co"># pruefe str des df</span></span>
<span id="cb105-574"><a href="#cb105-574" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(umwelt)</span>
<span id="cb105-575"><a href="#cb105-575" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(umwelt)</span>
<span id="cb105-576"><a href="#cb105-576" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(umwelt))</span>
<span id="cb105-577"><a href="#cb105-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-578"><a href="#cb105-578" aria-hidden="true" tabindex="-1"></a><span class="co"># unser Datensatz muss ein df sein, damit scale funktioniert</span></span>
<span id="cb105-579"><a href="#cb105-579" aria-hidden="true" tabindex="-1"></a>umwelt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(umwelt)</span>
<span id="cb105-580"><a href="#cb105-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-581"><a href="#cb105-581" aria-hidden="true" tabindex="-1"></a><span class="co">#  Variablen skalieren</span></span>
<span id="cb105-582"><a href="#cb105-582" aria-hidden="true" tabindex="-1"></a><span class="co"># Skalieren der Variablen, damit ihr Einfluss vergleichbar wird </span></span>
<span id="cb105-583"><a href="#cb105-583" aria-hidden="true" tabindex="-1"></a><span class="co"># (Problem verschiedene Skalen der Variablen (bspw. Temperatur in Grad Celsius, </span></span>
<span id="cb105-584"><a href="#cb105-584" aria-hidden="true" tabindex="-1"></a><span class="co"># Niederschlag in Millimeter und Sonnenscheindauer in Minuten)</span></span>
<span id="cb105-585"><a href="#cb105-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-586"><a href="#cb105-586" aria-hidden="true" tabindex="-1"></a>umwelt <span class="ot">&lt;-</span> umwelt <span class="sc">%&gt;%</span> </span>
<span id="cb105-587"><a href="#cb105-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tre200jx_scaled =</span> <span class="fu">scale</span>(tre200jx), </span>
<span id="cb105-588"><a href="#cb105-588" aria-hidden="true" tabindex="-1"></a>         <span class="at">rre150j0_scaled =</span> <span class="fu">scale</span>(rre150j0), </span>
<span id="cb105-589"><a href="#cb105-589" aria-hidden="true" tabindex="-1"></a>         <span class="at">sremaxdv_scaled =</span> <span class="fu">scale</span>(sremaxdv))</span>
<span id="cb105-590"><a href="#cb105-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb105-591"><a href="#cb105-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-592"><a href="#cb105-592" aria-hidden="true" tabindex="-1"></a><span class="fu"># Aufgabe 3: Korrelationen und Variablenselektion</span></span>
<span id="cb105-595"><a href="#cb105-595" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb105-596"><a href="#cb105-596" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.2 Variablenselektion ####</span></span>
<span id="cb105-597"><a href="#cb105-597" aria-hidden="true" tabindex="-1"></a><span class="co"># Korrelierende Variablen koennen das Modelergebnis verfaelschen. Daher muss vor der</span></span>
<span id="cb105-598"><a href="#cb105-598" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelldefinition auf Korrelation getestet werden.</span></span>
<span id="cb105-599"><a href="#cb105-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-600"><a href="#cb105-600" aria-hidden="true" tabindex="-1"></a><span class="co"># Erklaerende Variablen definieren</span></span>
<span id="cb105-601"><a href="#cb105-601" aria-hidden="true" tabindex="-1"></a><span class="co"># Hier wird die Korrelation zwischen den (nummerischen) erklaerenden Variablen berechnet</span></span>
<span id="cb105-602"><a href="#cb105-602" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span>  <span class="fu">cor</span>(umwelt[,<span class="dv">16</span><span class="sc">:</span>(<span class="fu">ncol</span>(umwelt))]) <span class="co"># in den [] waehle ich die skalierten Spalten.</span></span>
<span id="cb105-603"><a href="#cb105-603" aria-hidden="true" tabindex="-1"></a><span class="co"># Mit dem folgenden Code kann eine simple Korrelationsmatrix aufgebaut werden</span></span>
<span id="cb105-604"><a href="#cb105-604" aria-hidden="true" tabindex="-1"></a><span class="co"># hier kann auch die Schwelle für die Korrelation gesetzt werden, </span></span>
<span id="cb105-605"><a href="#cb105-605" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.7 ist liberal / 0.5 konservativ</span></span>
<span id="cb105-606"><a href="#cb105-606" aria-hidden="true" tabindex="-1"></a><span class="co"># https://researchbasics.education.uconn.edu/r_critical_value_table/</span></span>
<span id="cb105-607"><a href="#cb105-607" aria-hidden="true" tabindex="-1"></a>cor[<span class="fu">abs</span>(cor)<span class="sc">&lt;</span><span class="fl">0.7</span>] <span class="ot">&lt;-</span>  <span class="dv">0</span> <span class="co">#Setzt alle Werte kleiner 0.7 auf 0 (diese sind dann ok, alles groesser ist problematisch!)</span></span>
<span id="cb105-608"><a href="#cb105-608" aria-hidden="true" tabindex="-1"></a>cor</span>
<span id="cb105-609"><a href="#cb105-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-610"><a href="#cb105-610" aria-hidden="true" tabindex="-1"></a><span class="co"># Korrelationsmatrix erstellen</span></span>
<span id="cb105-611"><a href="#cb105-611" aria-hidden="true" tabindex="-1"></a><span class="co"># Zur Visualisierung kann ein einfacher Plot erstellt werden:</span></span>
<span id="cb105-612"><a href="#cb105-612" aria-hidden="true" tabindex="-1"></a><span class="fu">chart.Correlation</span>(umwelt[,<span class="dv">16</span><span class="sc">:</span>(<span class="fu">ncol</span>(umwelt))], <span class="at">histogram=</span><span class="cn">TRUE</span>, <span class="at">pch=</span><span class="dv">19</span>)</span>
<span id="cb105-613"><a href="#cb105-613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb105-614"><a href="#cb105-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-615"><a href="#cb105-615" aria-hidden="true" tabindex="-1"></a><span class="fu"># Aufgabe 4 (OPTIONAL): Automatische Variablenselektion</span></span>
<span id="cb105-618"><a href="#cb105-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb105-619"><a href="#cb105-619" aria-hidden="true" tabindex="-1"></a><span class="co"># # Automatisierte Variablenselektion </span></span>
<span id="cb105-620"><a href="#cb105-620" aria-hidden="true" tabindex="-1"></a><span class="co"># # fuehre die dredge-Funktion und ein Modelaveraging durch</span></span>
<span id="cb105-621"><a href="#cb105-621" aria-hidden="true" tabindex="-1"></a><span class="co"># # Hier wird die Formel für die dredge-Funktion vorbereitet</span></span>
<span id="cb105-622"><a href="#cb105-622" aria-hidden="true" tabindex="-1"></a><span class="co"># f &lt;- Total ~ Wochentag + Ferien + Phase +</span></span>
<span id="cb105-623"><a href="#cb105-623" aria-hidden="true" tabindex="-1"></a><span class="co">#   tre200jx_scaled + rre150j0_scaled + sremaxdv_scaled</span></span>
<span id="cb105-624"><a href="#cb105-624" aria-hidden="true" tabindex="-1"></a><span class="co"># # Jetzt kommt der Random-Factor hinzu und es wird eine Formel daraus gemacht</span></span>
<span id="cb105-625"><a href="#cb105-625" aria-hidden="true" tabindex="-1"></a><span class="co"># f_dredge &lt;- paste(c(f, "+ (1|KW)", "+ (1|Jahr)"), collapse = " ") %&gt;% </span></span>
<span id="cb105-626"><a href="#cb105-626" aria-hidden="true" tabindex="-1"></a><span class="co">#   as.formula()</span></span>
<span id="cb105-627"><a href="#cb105-627" aria-hidden="true" tabindex="-1"></a><span class="co"># # Das Modell mit dieser Formel ausführen</span></span>
<span id="cb105-628"><a href="#cb105-628" aria-hidden="true" tabindex="-1"></a><span class="co"># m &lt;- glmer(f_dredge, data = umwelt, family = poisson, na.action = "na.fail")</span></span>
<span id="cb105-629"><a href="#cb105-629" aria-hidden="true" tabindex="-1"></a><span class="co"># # Das Modell in die dredge-Funktion einfügen (siehe auch ?dredge)</span></span>
<span id="cb105-630"><a href="#cb105-630" aria-hidden="true" tabindex="-1"></a><span class="co"># all_m &lt;- dredge(m)</span></span>
<span id="cb105-631"><a href="#cb105-631" aria-hidden="true" tabindex="-1"></a><span class="co"># # suche das beste Modell</span></span>
<span id="cb105-632"><a href="#cb105-632" aria-hidden="true" tabindex="-1"></a><span class="co"># print(all_m)</span></span>
<span id="cb105-633"><a href="#cb105-633" aria-hidden="true" tabindex="-1"></a><span class="co"># # Importance values der Variablen </span></span>
<span id="cb105-634"><a href="#cb105-634" aria-hidden="true" tabindex="-1"></a><span class="co"># # hier wird die wichtigkeit der Variablen in den verschiedenen Modellen abgelesen</span></span>
<span id="cb105-635"><a href="#cb105-635" aria-hidden="true" tabindex="-1"></a><span class="co"># MuMIn::importance(all_m) </span></span>
<span id="cb105-636"><a href="#cb105-636" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-637"><a href="#cb105-637" aria-hidden="true" tabindex="-1"></a><span class="co"># # Schliesslich wird ein Modelaverage durchgeführt </span></span>
<span id="cb105-638"><a href="#cb105-638" aria-hidden="true" tabindex="-1"></a><span class="co"># # Schwellenwert für das delta-AIC = 2</span></span>
<span id="cb105-639"><a href="#cb105-639" aria-hidden="true" tabindex="-1"></a><span class="co"># avgmodel &lt;- model.avg(all_m, rank = "AICc", subset = delta &lt; 500) </span></span>
<span id="cb105-640"><a href="#cb105-640" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(avgmodel)</span></span>
<span id="cb105-641"><a href="#cb105-641" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb105-642"><a href="#cb105-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-643"><a href="#cb105-643" aria-hidden="true" tabindex="-1"></a><span class="fu"># Aufgabe 5: Verteilung der abhängigen Variabel pruefen</span></span>
<span id="cb105-646"><a href="#cb105-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb105-647"><a href="#cb105-647" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.3 Pruefe Verteilung ####</span></span>
<span id="cb105-648"><a href="#cb105-648" aria-hidden="true" tabindex="-1"></a><span class="co"># pruefe zuerst nochmals, ob wir NA im df haben:</span></span>
<span id="cb105-649"><a href="#cb105-649" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(umwelt<span class="sc">$</span>Total))</span>
<span id="cb105-650"><a href="#cb105-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-651"><a href="#cb105-651" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="fu">fitdist</span>(umwelt<span class="sc">$</span>Total,<span class="st">"norm"</span>)  <span class="co"># Normalverteilung</span></span>
<span id="cb105-652"><a href="#cb105-652" aria-hidden="true" tabindex="-1"></a><span class="co"># f1_1&lt;-fitdist((umwelt$Total + 1),"lnorm")  # log-Normalvert (beachte, dass ich +1 rechne. </span></span>
<span id="cb105-653"><a href="#cb105-653" aria-hidden="true" tabindex="-1"></a><span class="co"># log muss positiv sein; allerdings kann man die</span></span>
<span id="cb105-654"><a href="#cb105-654" aria-hidden="true" tabindex="-1"></a><span class="co"># Verteilungen dann nicht mehr miteinander vergleichen). </span></span>
<span id="cb105-655"><a href="#cb105-655" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="fu">fitdist</span>(umwelt<span class="sc">$</span>Total,<span class="st">"pois"</span>)  <span class="co"># Poisson</span></span>
<span id="cb105-656"><a href="#cb105-656" aria-hidden="true" tabindex="-1"></a>f3<span class="ot">&lt;-</span><span class="fu">fitdist</span>(umwelt<span class="sc">$</span>Total,<span class="st">"nbinom"</span>)  <span class="co"># negativ binomial</span></span>
<span id="cb105-657"><a href="#cb105-657" aria-hidden="true" tabindex="-1"></a>f4<span class="ot">&lt;-</span><span class="fu">fitdist</span>(umwelt<span class="sc">$</span>Total,<span class="st">"exp"</span>)  <span class="co"># exponentiell</span></span>
<span id="cb105-658"><a href="#cb105-658" aria-hidden="true" tabindex="-1"></a><span class="co"># f5&lt;-fitdist(umwelt$Total,"gamma")  # gamma (berechnung mit meinen Daten nicht möglich)</span></span>
<span id="cb105-659"><a href="#cb105-659" aria-hidden="true" tabindex="-1"></a>f6<span class="ot">&lt;-</span><span class="fu">fitdist</span>(umwelt<span class="sc">$</span>Total,<span class="st">"logis"</span>)  <span class="co"># logistisch</span></span>
<span id="cb105-660"><a href="#cb105-660" aria-hidden="true" tabindex="-1"></a>f7<span class="ot">&lt;-</span><span class="fu">fitdist</span>(umwelt<span class="sc">$</span>Total,<span class="st">"geom"</span>)  <span class="co"># geometrisch</span></span>
<span id="cb105-661"><a href="#cb105-661" aria-hidden="true" tabindex="-1"></a><span class="co"># f8&lt;-fitdist(umwelt$Total,"weibull")  # Weibull (berechnung mit meinen Daten nicht möglich)</span></span>
<span id="cb105-662"><a href="#cb105-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-663"><a href="#cb105-663" aria-hidden="true" tabindex="-1"></a><span class="fu">gofstat</span>(<span class="fu">list</span>(f1,f2,f3,f4,f6,f7), </span>
<span id="cb105-664"><a href="#cb105-664" aria-hidden="true" tabindex="-1"></a>        <span class="at">fitnames =</span> <span class="fu">c</span>(<span class="st">"Normalverteilung"</span>, <span class="st">"Poisson"</span>,</span>
<span id="cb105-665"><a href="#cb105-665" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"negativ binomial"</span>,<span class="st">"exponentiell"</span>, <span class="st">"logistisch"</span>,</span>
<span id="cb105-666"><a href="#cb105-666" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"geometrisch"</span>))</span>
<span id="cb105-667"><a href="#cb105-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-668"><a href="#cb105-668" aria-hidden="true" tabindex="-1"></a><span class="co"># die 2 besten (gemaess Akaike's Information Criterion) als Plot + normalverteilt, </span></span>
<span id="cb105-669"><a href="#cb105-669" aria-hidden="true" tabindex="-1"></a>plot.legend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Normalverteilung"</span>, <span class="st">"exponentiell"</span>, <span class="st">"negativ binomial"</span>)</span>
<span id="cb105-670"><a href="#cb105-670" aria-hidden="true" tabindex="-1"></a><span class="co"># vergleicht mehrere theoretische Verteilungen mit den empirischen Daten</span></span>
<span id="cb105-671"><a href="#cb105-671" aria-hidden="true" tabindex="-1"></a><span class="fu">cdfcomp</span>(<span class="fu">list</span>(f1, f4, f3), <span class="at">legendtext =</span> plot.legend)</span>
<span id="cb105-672"><a href="#cb105-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-673"><a href="#cb105-673" aria-hidden="true" tabindex="-1"></a><span class="co"># --&gt; Verteilung ist gemäss AICc negativ binomial. --&gt; ich entscheide </span></span>
<span id="cb105-674"><a href="#cb105-674" aria-hidden="true" tabindex="-1"></a><span class="co"># mich für letztere.</span></span>
<span id="cb105-675"><a href="#cb105-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb105-676"><a href="#cb105-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-677"><a href="#cb105-677" aria-hidden="true" tabindex="-1"></a><span class="fu"># Aufgabe 6: Multivariates Modell berechnen</span></span>
<span id="cb105-680"><a href="#cb105-680" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb105-681"><a href="#cb105-681" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.4 Berechne verschiedene Modelle ####</span></span>
<span id="cb105-682"><a href="#cb105-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-683"><a href="#cb105-683" aria-hidden="true" tabindex="-1"></a><span class="co"># Hinweise zu GLMM: https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html</span></span>
<span id="cb105-684"><a href="#cb105-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-685"><a href="#cb105-685" aria-hidden="true" tabindex="-1"></a><span class="co"># Ich verwende hier die Funktion glmer aus der Bibliothek lme4. glmer sei neuer, </span></span>
<span id="cb105-686"><a href="#cb105-686" aria-hidden="true" tabindex="-1"></a><span class="co"># schneller und zuverlaessiger als vergleichbare Funktionen.</span></span>
<span id="cb105-687"><a href="#cb105-687" aria-hidden="true" tabindex="-1"></a><span class="co"># Die Totale Besucheranzahl soll durch verschiedene Parameter erklaert werden. </span></span>
<span id="cb105-688"><a href="#cb105-688" aria-hidden="true" tabindex="-1"></a><span class="co"># Die saisonalitaet (KW, Jahr) soll hierbei nicht beachtet werden, </span></span>
<span id="cb105-689"><a href="#cb105-689" aria-hidden="true" tabindex="-1"></a><span class="co"># sie wird als random Faktor bestimmt --&gt; Saisonbereinigung.</span></span>
<span id="cb105-690"><a href="#cb105-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-691"><a href="#cb105-691" aria-hidden="true" tabindex="-1"></a><span class="co"># Einfacher Start</span></span>
<span id="cb105-692"><a href="#cb105-692" aria-hidden="true" tabindex="-1"></a><span class="co"># Auch wenn wir gerade herausgefunden haben, dass die Verteilung negativ binomial ist,</span></span>
<span id="cb105-693"><a href="#cb105-693" aria-hidden="true" tabindex="-1"></a><span class="co"># berechne ich für den Vergleich zuerst ein einfaches Modell der Familie poisson.</span></span>
<span id="cb105-694"><a href="#cb105-694" aria-hidden="true" tabindex="-1"></a>Tages_Model <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Total <span class="sc">~</span> Wochentag <span class="sc">+</span> Ferien <span class="sc">+</span> Phase <span class="sc">+</span></span>
<span id="cb105-695"><a href="#cb105-695" aria-hidden="true" tabindex="-1"></a>                       tre200jx_scaled <span class="sc">+</span> rre150j0_scaled <span class="sc">+</span> sremaxdv_scaled <span class="sc">+</span></span>
<span id="cb105-696"><a href="#cb105-696" aria-hidden="true" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">|</span>KW) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Jahr), <span class="at">family =</span> poisson, <span class="at">data =</span> umwelt)</span>
<span id="cb105-697"><a href="#cb105-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-698"><a href="#cb105-698" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Tages_Model)</span>
<span id="cb105-699"><a href="#cb105-699" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspektionsplots</span></span>
<span id="cb105-700"><a href="#cb105-700" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Tages_Model, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"smooth"</span>))</span>
<span id="cb105-701"><a href="#cb105-701" aria-hidden="true" tabindex="-1"></a><span class="fu">qqmath</span>(Tages_Model)</span>
<span id="cb105-702"><a href="#cb105-702" aria-hidden="true" tabindex="-1"></a><span class="co"># pruefe auf Overdispersion</span></span>
<span id="cb105-703"><a href="#cb105-703" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersion_glmer</span>(Tages_Model) <span class="co">#it shouldn't be over 1.4</span></span>
<span id="cb105-704"><a href="#cb105-704" aria-hidden="true" tabindex="-1"></a><span class="co"># wir gut erklaert das Modell?</span></span>
<span id="cb105-705"><a href="#cb105-705" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(Tages_Model) </span>
<span id="cb105-706"><a href="#cb105-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-707"><a href="#cb105-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-708"><a href="#cb105-708" aria-hidden="true" tabindex="-1"></a><span class="co"># Berechne ein negativ binomiales Modell</span></span>
<span id="cb105-709"><a href="#cb105-709" aria-hidden="true" tabindex="-1"></a><span class="co"># gemäss AICc die beste Verteilung</span></span>
<span id="cb105-710"><a href="#cb105-710" aria-hidden="true" tabindex="-1"></a>Tages_Model_nb <span class="ot">&lt;-</span> <span class="fu">glmer.nb</span>(Total <span class="sc">~</span> Wochentag <span class="sc">+</span> Ferien <span class="sc">+</span> Phase <span class="sc">+</span></span>
<span id="cb105-711"><a href="#cb105-711" aria-hidden="true" tabindex="-1"></a>                             tre200jx_scaled <span class="sc">+</span> rre150j0_scaled <span class="sc">+</span> sremaxdv_scaled <span class="sc">+</span></span>
<span id="cb105-712"><a href="#cb105-712" aria-hidden="true" tabindex="-1"></a>                             (<span class="dv">1</span><span class="sc">|</span>KW) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Jahr), <span class="at">data =</span> umwelt)</span>
<span id="cb105-713"><a href="#cb105-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-714"><a href="#cb105-714" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Tages_Model_nb)</span>
<span id="cb105-715"><a href="#cb105-715" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Tages_Model_nb, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"smooth"</span>))</span>
<span id="cb105-716"><a href="#cb105-716" aria-hidden="true" tabindex="-1"></a><span class="fu">qqmath</span>(Tages_Model_nb)</span>
<span id="cb105-717"><a href="#cb105-717" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersion_glmer</span>(Tages_Model_nb)</span>
<span id="cb105-718"><a href="#cb105-718" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(Tages_Model_nb) </span>
<span id="cb105-719"><a href="#cb105-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-720"><a href="#cb105-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-721"><a href="#cb105-721" aria-hidden="true" tabindex="-1"></a><span class="co"># auf quadratischen Term testen ("es gehen weniger Leute in den Wald, wenn es zu heiss ist")</span></span>
<span id="cb105-722"><a href="#cb105-722" aria-hidden="true" tabindex="-1"></a>Tages_Model_nb_quad <span class="ot">&lt;-</span> <span class="fu">glmer.nb</span>(Total <span class="sc">~</span> Wochentag <span class="sc">+</span> Ferien <span class="sc">+</span> Phase <span class="sc">+</span></span>
<span id="cb105-723"><a href="#cb105-723" aria-hidden="true" tabindex="-1"></a>                                  tre200jx_scaled <span class="sc">+</span> <span class="fu">I</span>(tre200jx_scaled<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb105-724"><a href="#cb105-724" aria-hidden="true" tabindex="-1"></a>                                  rre150j0_scaled <span class="sc">+</span> sremaxdv_scaled <span class="sc">+</span></span>
<span id="cb105-725"><a href="#cb105-725" aria-hidden="true" tabindex="-1"></a>                                  (<span class="dv">1</span><span class="sc">|</span>KW) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Jahr), <span class="at">data =</span> umwelt)</span>
<span id="cb105-726"><a href="#cb105-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-727"><a href="#cb105-727" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Tages_Model_nb_quad)</span>
<span id="cb105-728"><a href="#cb105-728" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Tages_Model_nb_quad, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"smooth"</span>))</span>
<span id="cb105-729"><a href="#cb105-729" aria-hidden="true" tabindex="-1"></a><span class="fu">qqmath</span>(Tages_Model_nb_quad)</span>
<span id="cb105-730"><a href="#cb105-730" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersion_glmer</span>(Tages_Model_nb_quad)</span>
<span id="cb105-731"><a href="#cb105-731" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(Tages_Model_nb_quad) </span>
<span id="cb105-732"><a href="#cb105-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-733"><a href="#cb105-733" aria-hidden="true" tabindex="-1"></a><span class="co"># Interaktion testen, da Ferien und / oder Wochentage einen Einfluss auf</span></span>
<span id="cb105-734"><a href="#cb105-734" aria-hidden="true" tabindex="-1"></a><span class="co"># die Besuchszahlen waehrend des Lockown haben koennen!</span></span>
<span id="cb105-735"><a href="#cb105-735" aria-hidden="true" tabindex="-1"></a><span class="co"># (Achtung: Rechenintensiv!)</span></span>
<span id="cb105-736"><a href="#cb105-736" aria-hidden="true" tabindex="-1"></a><span class="co"># Tages_Model_nb_int &lt;- glmer.nb(Anzahl_Total ~  Wochentag  * Ferien + Phase +</span></span>
<span id="cb105-737"><a href="#cb105-737" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  tre200jx_scaled + I(tre200jx_scaled^2) * </span></span>
<span id="cb105-738"><a href="#cb105-738" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  rre150j0_scaled + sremaxdv_scaled +</span></span>
<span id="cb105-739"><a href="#cb105-739" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  (1|KW) + (1|Jahr), data = umwelt)</span></span>
<span id="cb105-740"><a href="#cb105-740" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-741"><a href="#cb105-741" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(Tages_Model_nb_int)</span></span>
<span id="cb105-742"><a href="#cb105-742" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(Tages_Model_nb_int, type = c("p", "smooth"))</span></span>
<span id="cb105-743"><a href="#cb105-743" aria-hidden="true" tabindex="-1"></a><span class="co"># qqmath(Tages_Model_nb_int)</span></span>
<span id="cb105-744"><a href="#cb105-744" aria-hidden="true" tabindex="-1"></a><span class="co"># dispersion_glmer(Tages_Model_nb_int)</span></span>
<span id="cb105-745"><a href="#cb105-745" aria-hidden="true" tabindex="-1"></a><span class="co"># r.squaredGLMM(Tages_Model_nb_int) </span></span>
<span id="cb105-746"><a href="#cb105-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-747"><a href="#cb105-747" aria-hidden="true" tabindex="-1"></a><span class="co"># Vergleich der Modellguete mittels AICc</span></span>
<span id="cb105-748"><a href="#cb105-748" aria-hidden="true" tabindex="-1"></a>cand.models<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb105-749"><a href="#cb105-749" aria-hidden="true" tabindex="-1"></a>cand.models[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> Tages_Model</span>
<span id="cb105-750"><a href="#cb105-750" aria-hidden="true" tabindex="-1"></a>cand.models[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> Tages_Model_nb</span>
<span id="cb105-751"><a href="#cb105-751" aria-hidden="true" tabindex="-1"></a>cand.models[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> Tages_Model_nb_quad</span>
<span id="cb105-752"><a href="#cb105-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-753"><a href="#cb105-753" aria-hidden="true" tabindex="-1"></a>Modnames<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Tages_Model"</span>,<span class="st">"Tages_Model_nb"</span>, </span>
<span id="cb105-754"><a href="#cb105-754" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Tages_Model_nb_quad"</span>)</span>
<span id="cb105-755"><a href="#cb105-755" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(<span class="at">cand.set=</span>cand.models,<span class="at">modnames=</span>Modnames)</span>
<span id="cb105-756"><a href="#cb105-756" aria-hidden="true" tabindex="-1"></a><span class="co">#K = Anzahl geschaetzter Parameter (2 Funktionsparameter und die Varianz)</span></span>
<span id="cb105-757"><a href="#cb105-757" aria-hidden="true" tabindex="-1"></a><span class="co">#Delta_AICc &lt;2 = Statistisch gleichwertig</span></span>
<span id="cb105-758"><a href="#cb105-758" aria-hidden="true" tabindex="-1"></a><span class="co">#AICcWt =  Akaike weight in %</span></span>
<span id="cb105-759"><a href="#cb105-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-760"><a href="#cb105-760" aria-hidden="true" tabindex="-1"></a><span class="co"># --&gt; Ich entscheide mich bei diesen drei Modellen für das Tages_Model_nb_quad</span></span>
<span id="cb105-761"><a href="#cb105-761" aria-hidden="true" tabindex="-1"></a><span class="co"># Warum: statistisch gleichwertig und ich denke die Quadratur macht Sinn!</span></span>
<span id="cb105-762"><a href="#cb105-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-763"><a href="#cb105-763" aria-hidden="true" tabindex="-1"></a><span class="co"># Berechne ein Modell mit exponentieller Verteilung:</span></span>
<span id="cb105-764"><a href="#cb105-764" aria-hidden="true" tabindex="-1"></a><span class="co"># gemäss AICc der Verteilung die zweitbeste</span></span>
<span id="cb105-765"><a href="#cb105-765" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.stackexchange.com/questions/240455/fitting-exponential-regression-model-by-mle</span></span>
<span id="cb105-766"><a href="#cb105-766" aria-hidden="true" tabindex="-1"></a>Tages_Model_exp <span class="ot">&lt;-</span> <span class="fu">glmer</span>((Total<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span> Wochentag <span class="sc">+</span> Ferien <span class="sc">+</span> Phase <span class="sc">+</span></span>
<span id="cb105-767"><a href="#cb105-767" aria-hidden="true" tabindex="-1"></a>                           tre200jx_scaled <span class="sc">+</span> rre150j0_scaled <span class="sc">+</span> sremaxdv_scaled <span class="sc">+</span></span>
<span id="cb105-768"><a href="#cb105-768" aria-hidden="true" tabindex="-1"></a>                           (<span class="dv">1</span><span class="sc">|</span>KW) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Jahr), <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link=</span><span class="st">"log"</span>), <span class="at">data =</span> umwelt)</span>
<span id="cb105-769"><a href="#cb105-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-770"><a href="#cb105-770" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Tages_Model_exp, <span class="at">dispersion=</span><span class="dv">1</span>)</span>
<span id="cb105-771"><a href="#cb105-771" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspektionsplots</span></span>
<span id="cb105-772"><a href="#cb105-772" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Tages_Model_exp, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"smooth"</span>))</span>
<span id="cb105-773"><a href="#cb105-773" aria-hidden="true" tabindex="-1"></a><span class="fu">qqmath</span>(Tages_Model_exp)</span>
<span id="cb105-774"><a href="#cb105-774" aria-hidden="true" tabindex="-1"></a><span class="co"># pruefe auf Overdispersion</span></span>
<span id="cb105-775"><a href="#cb105-775" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersion_glmer</span>(Tages_Model_exp) <span class="co">#it shouldn't be over 1.4</span></span>
<span id="cb105-776"><a href="#cb105-776" aria-hidden="true" tabindex="-1"></a><span class="co"># wir gut erklaert das Modell?</span></span>
<span id="cb105-777"><a href="#cb105-777" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(Tages_Model_exp) </span>
<span id="cb105-778"><a href="#cb105-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-779"><a href="#cb105-779" aria-hidden="true" tabindex="-1"></a><span class="co"># --&gt; Die zweitbeste Verteilung (exp) führt auch nicht dazu, dass die Modellvoraussetzungen besser</span></span>
<span id="cb105-780"><a href="#cb105-780" aria-hidden="true" tabindex="-1"></a><span class="co"># erfüllt werden</span></span>
<span id="cb105-781"><a href="#cb105-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-782"><a href="#cb105-782" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.5 Transformationen ####</span></span>
<span id="cb105-783"><a href="#cb105-783" aria-hidden="true" tabindex="-1"></a><span class="co"># Die Modellvoraussetzungen waren überall mehr oder weniger verletzt.</span></span>
<span id="cb105-784"><a href="#cb105-784" aria-hidden="true" tabindex="-1"></a><span class="co"># Das ist ein Problem, allerdings auch nicht ein so grosses.</span></span>
<span id="cb105-785"><a href="#cb105-785" aria-hidden="true" tabindex="-1"></a><span class="co"># (man sollte es aber trotzdem ernst nehmen)</span></span>
<span id="cb105-786"><a href="#cb105-786" aria-hidden="true" tabindex="-1"></a><span class="co"># Schielzeth et al. Robustness of linear mixed‐effects models to violations of distributional assumptions</span></span>
<span id="cb105-787"><a href="#cb105-787" aria-hidden="true" tabindex="-1"></a><span class="co"># https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.13434</span></span>
<span id="cb105-788"><a href="#cb105-788" aria-hidden="true" tabindex="-1"></a><span class="co"># Lo and Andrews, To transform or not to transform: using generalized linear mixed models to analyse reaction time data</span></span>
<span id="cb105-789"><a href="#cb105-789" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.frontiersin.org/articles/10.3389/fpsyg.2015.01171/full</span></span>
<span id="cb105-790"><a href="#cb105-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-791"><a href="#cb105-791" aria-hidden="true" tabindex="-1"></a><span class="co"># die Lösung ist nun, die Daten zu transformieren:</span></span>
<span id="cb105-792"><a href="#cb105-792" aria-hidden="true" tabindex="-1"></a><span class="co"># mehr unter: https://www.datanovia.com/en/lessons/transform-data-to-normal-distribution-in-r/</span></span>
<span id="cb105-793"><a href="#cb105-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-794"><a href="#cb105-794" aria-hidden="true" tabindex="-1"></a><span class="co"># berechne skewness coefficient </span></span>
<span id="cb105-795"><a href="#cb105-795" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb105-796"><a href="#cb105-796" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(umwelt<span class="sc">$</span>Total)</span>
<span id="cb105-797"><a href="#cb105-797" aria-hidden="true" tabindex="-1"></a><span class="co"># A positive value means the distribution is positively skewed (rechtsschief).</span></span>
<span id="cb105-798"><a href="#cb105-798" aria-hidden="true" tabindex="-1"></a><span class="co"># The most frequent values are low; tail is toward the high values (on the right-hand side)</span></span>
<span id="cb105-799"><a href="#cb105-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-800"><a href="#cb105-800" aria-hidden="true" tabindex="-1"></a><span class="co"># log 10, da stark rechtsschief</span></span>
<span id="cb105-801"><a href="#cb105-801" aria-hidden="true" tabindex="-1"></a>Tages_Model_quad_Jahr_log10 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log10</span>(Total<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span> Wochentag <span class="sc">+</span> Ferien <span class="sc">+</span> Phase <span class="sc">+</span></span>
<span id="cb105-802"><a href="#cb105-802" aria-hidden="true" tabindex="-1"></a>                                             tre200jx_scaled <span class="sc">+</span> <span class="fu">I</span>(tre200jx_scaled<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb105-803"><a href="#cb105-803" aria-hidden="true" tabindex="-1"></a>                                             rre150j0_scaled <span class="sc">+</span> sremaxdv_scaled <span class="sc">+</span></span>
<span id="cb105-804"><a href="#cb105-804" aria-hidden="true" tabindex="-1"></a>                                             (<span class="dv">1</span><span class="sc">|</span>KW) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Jahr), <span class="at">data =</span> umwelt)</span>
<span id="cb105-805"><a href="#cb105-805" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Tages_Model_quad_Jahr_log10)</span>
<span id="cb105-806"><a href="#cb105-806" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Tages_Model_quad_Jahr_log10, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"smooth"</span>))</span>
<span id="cb105-807"><a href="#cb105-807" aria-hidden="true" tabindex="-1"></a><span class="fu">qqmath</span>(Tages_Model_quad_Jahr_log10)</span>
<span id="cb105-808"><a href="#cb105-808" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersion_glmer</span>(Tages_Model_quad_Jahr_log10)</span>
<span id="cb105-809"><a href="#cb105-809" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(Tages_Model_quad_Jahr_log10) </span>
<span id="cb105-810"><a href="#cb105-810" aria-hidden="true" tabindex="-1"></a><span class="co"># lmer zeigt keine p-Werte, da diese schwer zu berechnen sind. Alternative Packages berechnen diese</span></span>
<span id="cb105-811"><a href="#cb105-811" aria-hidden="true" tabindex="-1"></a><span class="co"># anhand der Teststatistik. Achtung: die Werte sind wahrscheinlich nicht präzise!</span></span>
<span id="cb105-812"><a href="#cb105-812" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stat.ethz.ch/pipermail/r-sig-mixed-models/2008q2/000904.html</span></span>
<span id="cb105-813"><a href="#cb105-813" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">transform =</span> <span class="cn">NULL</span>, <span class="at">show.se =</span> <span class="cn">TRUE</span>)</span>
<span id="cb105-814"><a href="#cb105-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-815"><a href="#cb105-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-816"><a href="#cb105-816" aria-hidden="true" tabindex="-1"></a><span class="co"># natural log, da stark rechtsschief</span></span>
<span id="cb105-817"><a href="#cb105-817" aria-hidden="true" tabindex="-1"></a>Tages_Model_quad_Jahr_ln <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">log</span>(Total<span class="sc">+</span><span class="dv">1</span>) <span class="sc">~</span> Wochentag <span class="sc">+</span> Ferien <span class="sc">+</span> Phase <span class="sc">+</span></span>
<span id="cb105-818"><a href="#cb105-818" aria-hidden="true" tabindex="-1"></a>                                          tre200jx_scaled <span class="sc">+</span> <span class="fu">I</span>(tre200jx_scaled<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb105-819"><a href="#cb105-819" aria-hidden="true" tabindex="-1"></a>                                          rre150j0_scaled <span class="sc">+</span> sremaxdv_scaled <span class="sc">+</span></span>
<span id="cb105-820"><a href="#cb105-820" aria-hidden="true" tabindex="-1"></a>                                          (<span class="dv">1</span><span class="sc">|</span>KW) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Jahr), <span class="at">data =</span> umwelt)</span>
<span id="cb105-821"><a href="#cb105-821" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Tages_Model_quad_Jahr_ln)</span>
<span id="cb105-822"><a href="#cb105-822" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Tages_Model_quad_Jahr_ln, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>, <span class="st">"smooth"</span>))</span>
<span id="cb105-823"><a href="#cb105-823" aria-hidden="true" tabindex="-1"></a><span class="fu">qqmath</span>(Tages_Model_quad_Jahr_ln)</span>
<span id="cb105-824"><a href="#cb105-824" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersion_glmer</span>(Tages_Model_quad_Jahr_ln)</span>
<span id="cb105-825"><a href="#cb105-825" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(Tages_Model_quad_Jahr_ln) </span>
<span id="cb105-826"><a href="#cb105-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-827"><a href="#cb105-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-828"><a href="#cb105-828" aria-hidden="true" tabindex="-1"></a><span class="co"># --&gt; Die Modellvoraussetzungen sind deutlich besser erfüllt jetzt wo wir Transformationen </span></span>
<span id="cb105-829"><a href="#cb105-829" aria-hidden="true" tabindex="-1"></a><span class="co"># benutzt haben. log10 und ln performen beide gleich gut. Da log10 in meinem Bsp</span></span>
<span id="cb105-830"><a href="#cb105-830" aria-hidden="true" tabindex="-1"></a><span class="co"># aber deutlich mehr der Varianz erklärt, entscheide ich mich schliesslich für dieses Modell.</span></span>
<span id="cb105-831"><a href="#cb105-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-832"><a href="#cb105-832" aria-hidden="true" tabindex="-1"></a><span class="co"># Zusatz: ACHTUNG - Ruecktransformierte Regressionskoeffizienten zu erlangen (fuer die Interpretation, das Plotten), </span></span>
<span id="cb105-833"><a href="#cb105-833" aria-hidden="true" tabindex="-1"></a><span class="co"># ist zudem nicht moeglich (Regressionskoeffizienten sind nur im transformierten Raum linear). </span></span>
<span id="cb105-834"><a href="#cb105-834" aria-hidden="true" tabindex="-1"></a><span class="co"># Ein ruecktransformierter Regressionskoeffiziente haette eine nicht-lineare Beziehung mit der </span></span>
<span id="cb105-835"><a href="#cb105-835" aria-hidden="true" tabindex="-1"></a><span class="co"># abhaengigen Variable.</span></span>
<span id="cb105-836"><a href="#cb105-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-837"><a href="#cb105-837" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.6 Exportiere die Modellresultate ####</span></span>
<span id="cb105-838"><a href="#cb105-838" aria-hidden="true" tabindex="-1"></a><span class="co"># (des besten Modells)</span></span>
<span id="cb105-839"><a href="#cb105-839" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">transform =</span> <span class="cn">NULL</span>, <span class="at">show.se =</span> <span class="cn">TRUE</span>)</span>
<span id="cb105-840"><a href="#cb105-840" aria-hidden="true" tabindex="-1"></a><span class="co"># The marginal R squared values are those associated with your fixed effects, </span></span>
<span id="cb105-841"><a href="#cb105-841" aria-hidden="true" tabindex="-1"></a><span class="co"># the conditional ones are those of your fixed effects plus the random effects. </span></span>
<span id="cb105-842"><a href="#cb105-842" aria-hidden="true" tabindex="-1"></a><span class="co"># Usually we will be interested in the marginal effects.</span></span>
<span id="cb105-843"><a href="#cb105-843" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb105-844"><a href="#cb105-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-845"><a href="#cb105-845" aria-hidden="true" tabindex="-1"></a><span class="fu"># Aufgabe 7: Modellvisualisierung</span></span>
<span id="cb105-848"><a href="#cb105-848" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb105-849"><a href="#cb105-849" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.7 Visualisiere Modellresultate ####</span></span>
<span id="cb105-850"><a href="#cb105-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-851"><a href="#cb105-851" aria-hidden="true" tabindex="-1"></a><span class="co"># ZUSATZ: Wir haben die Wetterparameter skaliert. </span></span>
<span id="cb105-852"><a href="#cb105-852" aria-hidden="true" tabindex="-1"></a><span class="co"># Fuer die Plots muss das beruecksichtigt werden: wir stellen nicht die wirklichen Werte</span></span>
<span id="cb105-853"><a href="#cb105-853" aria-hidden="true" tabindex="-1"></a><span class="co"># dar sondern die skalierten. Mit folgendem Befehl kann man die Skalierung nachvollziehen:</span></span>
<span id="cb105-854"><a href="#cb105-854" aria-hidden="true" tabindex="-1"></a><span class="co"># attributes(umwelt$tre200jx_scaled)</span></span>
<span id="cb105-855"><a href="#cb105-855" aria-hidden="true" tabindex="-1"></a><span class="co"># Die Skalierung kann rueckgaengig gemacht werden, indem man die Skalierten werte mit</span></span>
<span id="cb105-856"><a href="#cb105-856" aria-hidden="true" tabindex="-1"></a><span class="co"># dem scaling factor multipliziert und dann den Durchschnitt addiert:</span></span>
<span id="cb105-857"><a href="#cb105-857" aria-hidden="true" tabindex="-1"></a><span class="co"># Bsp.: d$s.x * attr(d$s.x, 'scaled:scale') + attr(d$s.x, 'scaled:center')</span></span>
<span id="cb105-858"><a href="#cb105-858" aria-hidden="true" tabindex="-1"></a><span class="co"># mehr dazu: https://stackoverflow.com/questions/10287545/backtransform-scale-for-plotting</span></span>
<span id="cb105-859"><a href="#cb105-859" aria-hidden="true" tabindex="-1"></a><span class="co"># --&gt; wir bleiben aber bei den skalierten Werten, leben damit und sind uns dessen bewusst.</span></span>
<span id="cb105-860"><a href="#cb105-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-861"><a href="#cb105-861" aria-hidden="true" tabindex="-1"></a><span class="co"># Auch beim Plotten der Modellresultate gilt: </span></span>
<span id="cb105-862"><a href="#cb105-862" aria-hidden="true" tabindex="-1"></a><span class="co"># visualisiere nur die Parameter welche nach der Modellselektion uebig bleiben</span></span>
<span id="cb105-863"><a href="#cb105-863" aria-hidden="true" tabindex="-1"></a><span class="co"># und signifikant sind!</span></span>
<span id="cb105-864"><a href="#cb105-864" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_model / type = "pred" sagt die Werte "voraus"</span></span>
<span id="cb105-865"><a href="#cb105-865" aria-hidden="true" tabindex="-1"></a><span class="co"># achte auf gleiche Skalierung der y-Achse (Vergleichbarkeit)</span></span>
<span id="cb105-866"><a href="#cb105-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-867"><a href="#cb105-867" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperatur</span></span>
<span id="cb105-868"><a href="#cb105-868" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> </span>
<span id="cb105-869"><a href="#cb105-869" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"tre200jx_scaled [all]"</span>, <span class="co"># [all] = Model contains polynomial or cubic / </span></span>
<span id="cb105-870"><a href="#cb105-870" aria-hidden="true" tabindex="-1"></a>                <span class="co">#quadratic terms. Consider using `terms="tre200jx_scaled [all]"` </span></span>
<span id="cb105-871"><a href="#cb105-871" aria-hidden="true" tabindex="-1"></a>                <span class="co"># to get smooth plots. See also package-vignette </span></span>
<span id="cb105-872"><a href="#cb105-872" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 'Marginal Effects at Specific Values'.</span></span>
<span id="cb105-873"><a href="#cb105-873" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">""</span>, <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Tagesmaximaltemperatur [°C]"</span>, </span>
<span id="cb105-874"><a href="#cb105-874" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Fussgaenger:innen pro Tag [log]"</span>))</span>
<span id="cb105-875"><a href="#cb105-875" aria-hidden="true" tabindex="-1"></a><span class="co"># fuege die Achsenbeschriftung hinzu. Hier wird auf die unskalierten Werte zugegriffen.</span></span>
<span id="cb105-876"><a href="#cb105-876" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">floor</span>(<span class="fu">min</span>(umwelt<span class="sc">$</span>tre200jx)), <span class="fu">ceiling</span>(<span class="fu">max</span>(umwelt<span class="sc">$</span>tre200jx)),</span>
<span id="cb105-877"><a href="#cb105-877" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># length.out = ___ --&gt; Anpassen gemaess breaks auf dem Plot</span></span>
<span id="cb105-878"><a href="#cb105-878" aria-hidden="true" tabindex="-1"></a>                    <span class="at">length.out =</span> <span class="dv">5</span>), <span class="dv">0</span>) </span>
<span id="cb105-879"><a href="#cb105-879" aria-hidden="true" tabindex="-1"></a>(Tempplot <span class="ot">&lt;-</span> t <span class="sc">+</span> </span>
<span id="cb105-880"><a href="#cb105-880" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), </span>
<span id="cb105-881"><a href="#cb105-881" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(labels))<span class="sc">+</span></span>
<span id="cb105-882"><a href="#cb105-882" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fuege die y- Achsenbeschriftung hinzu. Hier transformieren wir die Werte zurueck</span></span>
<span id="cb105-883"><a href="#cb105-883" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>),</span>
<span id="cb105-884"><a href="#cb105-884" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">0</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">0.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">1.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>),<span class="dv">0</span>),</span>
<span id="cb105-885"><a href="#cb105-885" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb105-886"><a href="#cb105-886" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>))</span>
<span id="cb105-887"><a href="#cb105-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-888"><a href="#cb105-888" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("temp.png", width=15, height=15, units="cm", dpi=1000, </span></span>
<span id="cb105-889"><a href="#cb105-889" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/") </span></span>
<span id="cb105-890"><a href="#cb105-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-891"><a href="#cb105-891" aria-hidden="true" tabindex="-1"></a><span class="co"># Regen</span></span>
<span id="cb105-892"><a href="#cb105-892" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="st">"rre150j0_scaled"</span>, </span>
<span id="cb105-893"><a href="#cb105-893" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">""</span>, <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Halbtagessumme Niederschlag [mm]"</span>, </span>
<span id="cb105-894"><a href="#cb105-894" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Fussgaenger:innen pro Tag [log]"</span>))</span>
<span id="cb105-895"><a href="#cb105-895" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">floor</span>(<span class="fu">min</span>(umwelt<span class="sc">$</span>rre150j0)), <span class="fu">ceiling</span>(<span class="fu">max</span>(umwelt<span class="sc">$</span>rre150j0)),</span>
<span id="cb105-896"><a href="#cb105-896" aria-hidden="true" tabindex="-1"></a>                    <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">0</span>)</span>
<span id="cb105-897"><a href="#cb105-897" aria-hidden="true" tabindex="-1"></a>(t <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">12</span>), <span class="at">labels =</span> <span class="fu">c</span>(labels))<span class="sc">+</span></span>
<span id="cb105-898"><a href="#cb105-898" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>),</span>
<span id="cb105-899"><a href="#cb105-899" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">0</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">0.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">1.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>),<span class="dv">0</span>),</span>
<span id="cb105-900"><a href="#cb105-900" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb105-901"><a href="#cb105-901" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>))</span>
<span id="cb105-902"><a href="#cb105-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-903"><a href="#cb105-903" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("rain.png", width=15, height=15, units="cm", dpi=1000, </span></span>
<span id="cb105-904"><a href="#cb105-904" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/") </span></span>
<span id="cb105-905"><a href="#cb105-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-906"><a href="#cb105-906" aria-hidden="true" tabindex="-1"></a><span class="co"># Sonne</span></span>
<span id="cb105-907"><a href="#cb105-907" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="st">"sremaxdv_scaled"</span>, </span>
<span id="cb105-908"><a href="#cb105-908" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">""</span>, <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Sonnenscheindauer [min]"</span>, </span>
<span id="cb105-909"><a href="#cb105-909" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Fussgaenger:innen pro Tag [log]"</span>))</span>
<span id="cb105-910"><a href="#cb105-910" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="fu">floor</span>(<span class="fu">min</span>(umwelt<span class="sc">$</span>sremaxdv)), <span class="fu">ceiling</span>(<span class="fu">max</span>(umwelt<span class="sc">$</span>sremaxdv)),</span>
<span id="cb105-911"><a href="#cb105-911" aria-hidden="true" tabindex="-1"></a>                    <span class="at">length.out =</span> <span class="dv">3</span>), <span class="dv">0</span>)</span>
<span id="cb105-912"><a href="#cb105-912" aria-hidden="true" tabindex="-1"></a>(t <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(labels))<span class="sc">+</span></span>
<span id="cb105-913"><a href="#cb105-913" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>),</span>
<span id="cb105-914"><a href="#cb105-914" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">0</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">0.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">1.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>),<span class="dv">0</span>),</span>
<span id="cb105-915"><a href="#cb105-915" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb105-916"><a href="#cb105-916" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>))</span>
<span id="cb105-917"><a href="#cb105-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-918"><a href="#cb105-918" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("sun.png", width=15, height=15, units="cm", dpi=1000, </span></span>
<span id="cb105-919"><a href="#cb105-919" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/") </span></span>
<span id="cb105-920"><a href="#cb105-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-921"><a href="#cb105-921" aria-hidden="true" tabindex="-1"></a><span class="co"># Phase</span></span>
<span id="cb105-922"><a href="#cb105-922" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="st">"Phase"</span>, </span>
<span id="cb105-923"><a href="#cb105-923" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">""</span>, <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Phase"</span>, </span>
<span id="cb105-924"><a href="#cb105-924" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Fussgaenger:innen pro Tag [log]"</span>))</span>
<span id="cb105-925"><a href="#cb105-925" aria-hidden="true" tabindex="-1"></a>(lockplot <span class="ot">&lt;-</span> t <span class="sc">+</span> </span>
<span id="cb105-926"><a href="#cb105-926" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>),</span>
<span id="cb105-927"><a href="#cb105-927" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">0</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">0.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">1.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>),<span class="dv">0</span>),</span>
<span id="cb105-928"><a href="#cb105-928" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb105-929"><a href="#cb105-929" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>))</span>
<span id="cb105-930"><a href="#cb105-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-931"><a href="#cb105-931" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("phase.png", width=15, height=15, units="cm", dpi=1000, </span></span>
<span id="cb105-932"><a href="#cb105-932" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/") </span></span>
<span id="cb105-933"><a href="#cb105-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-934"><a href="#cb105-934" aria-hidden="true" tabindex="-1"></a><span class="co"># Ferien</span></span>
<span id="cb105-935"><a href="#cb105-935" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="st">"Ferien"</span>, </span>
<span id="cb105-936"><a href="#cb105-936" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">""</span>, <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Ferien"</span>, </span>
<span id="cb105-937"><a href="#cb105-937" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Fussgaenger:innen pro Tag [log]"</span>))</span>
<span id="cb105-938"><a href="#cb105-938" aria-hidden="true" tabindex="-1"></a>(ferienplot <span class="ot">&lt;-</span> t <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Nein"</span>, <span class="st">"Ja"</span>))<span class="sc">+</span></span>
<span id="cb105-939"><a href="#cb105-939" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>),</span>
<span id="cb105-940"><a href="#cb105-940" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">0</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">0.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">1.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>),<span class="dv">0</span>),</span>
<span id="cb105-941"><a href="#cb105-941" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb105-942"><a href="#cb105-942" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>))</span>
<span id="cb105-943"><a href="#cb105-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-944"><a href="#cb105-944" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("ferien.png", width=15, height=15, units="cm", dpi=1000, </span></span>
<span id="cb105-945"><a href="#cb105-945" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/") </span></span>
<span id="cb105-946"><a href="#cb105-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-947"><a href="#cb105-947" aria-hidden="true" tabindex="-1"></a><span class="co"># Wochentag</span></span>
<span id="cb105-948"><a href="#cb105-948" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(Tages_Model_quad_Jahr_log10, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="st">"Wochentag"</span>, </span>
<span id="cb105-949"><a href="#cb105-949" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">""</span>, <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">"Wochentag"</span>, <span class="st">"Fussgaenger:innen pro Tag [log]"</span>))</span>
<span id="cb105-950"><a href="#cb105-950" aria-hidden="true" tabindex="-1"></a>(wdplot <span class="ot">&lt;-</span> t <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>),</span>
<span id="cb105-951"><a href="#cb105-951" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">labels =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">0</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">0.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">1</span>, <span class="dv">10</span><span class="sc">^</span><span class="fl">1.5</span>, <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span>),<span class="dv">0</span>),</span>
<span id="cb105-952"><a href="#cb105-952" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb105-953"><a href="#cb105-953" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb105-954"><a href="#cb105-954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb105-955"><a href="#cb105-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-956"><a href="#cb105-956" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("wd.png", width=15, height=15, units="cm", dpi=1000, </span></span>
<span id="cb105-957"><a href="#cb105-957" aria-hidden="true" tabindex="-1"></a><span class="co">#        path = "fallstudien/_R_analysis/results/") </span></span>
<span id="cb105-958"><a href="#cb105-958" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>